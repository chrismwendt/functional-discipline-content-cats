\chapter{Assorted Structure in~$\W{cpsu}$}
\begin{parsec}{920}%
\begin{point}{10}%
In the previous two chapters
we have travelled through
charted territory
when developing the theory of $C^*$-algebras
and von Neumann algebras
adding some new landmarks and shortcuts
of our own along the way.
In this chapter
we properly break new ground
by revealing
two entirely new features
of the category~$\W{cpsu}$
of von Neumann algebras
and the normal completely positive sub-unital
linear maps between them,
namely, 
\begin{enumerate}
\item 
that the binary operation~$\ast$
on the effects of a von Neumann algebra~$\scrA$
given by~$p\ast q = \sqrt{p}q\sqrt{p}$
(representing measurement of~$p$)
can be axiomatised,
and 
\item 
	that the category~$\W{cpsu}$
has all the bits and pieces
needed to be a model of Selinger and Valiron's quantum lambda calculus.
\end{enumerate}
We'll deal with the first matter directly after this introduction
in Section~\ref{S:measurement}.
The second matter is treated in Section~\ref{S:model},
but only after
we have given the tensor product of von Neumann 
algebras a complete overhaul
in Section~\ref{S:tensor}.
Finally, as an offshoot of our model
of the quantum lambda calculus
we'll study all
 von Neumann algebras
that admit a `duplicator'
in Section~\ref{S:duplicable}
---
surprisingly, they're
all of the form $\ell^\infty(X)$.
\end{point}
\end{parsec}

\section{Measurement}
\label{S:measurement}
\begin{parsec}{930}%
\begin{point}{10}%
The maps on a von Neumann algebra~$\scrA$
of the form
$a\mapsto \sqrt{p}a\sqrt{p}\colon\,\scrA\to\scrA$,
where~$p$ is an effect of~$\scrA$,
represent measurement of~$p$,
and are called \emph{assert maps} in~\cite{newdirections}.
The importance of these maps 
to any logical description of
quantum computation is not easily overstated.
On the effects of~$\scrA$
these maps are also  studied 
in the guise
of the binary operation
$p\ast q=\sqrt{p} q \sqrt{p}$
called the \emph{sequential product}
(see e.g.~\cite{gudder2002sequential}).
We'll axiomatise this operation
in this section
in terms of the properties 
of the underlying assert maps.

Our first observation
to this end
is that any assert map factors as
\begin{equation*}
\xymatrix@C=10em{
\scrA
\ar[r]^-{\pi\colon a\mapsto \ceil{p}a\ceil{p}}
&
\ceil{p}\!\scrA\!\ceil{p}
\ar[r]^-{c\colon a\mapsto \sqrt{p}a\sqrt{p}}
&
\scrA
},
\end{equation*}
where both~$\pi$ and~$c$ obey a universal property:
$c$ is a \emph{filter} of~$p$, see~\sref{filter},
and~$\pi$ is a \emph{corner} of~$\ceil{p}$, see~\sref{corner}.
Such maps
that are the composition of a filter and a corner
will be called \emph{pure}, see~\sref{pure},
Since not only assert maps turn out to be pure, but also maps of the form
$b^*(\,\cdot\,)b\colon \scrA\to\scrA$ for an arbitrary element~$b$
of~$\scrA$,
we need another property of assert maps, namely
that
\begin{equation*}
	\sqrt{p}\,e_1\,\sqrt{p}\ \leq\  e_2^\perp 
	\qquad\iff\qquad
	\sqrt{p}\,e_2 \,\sqrt{p}\ \leq\  e_1^\perp
\end{equation*}
for all projections~$e_1$ and~$e_2$ of~$\scrA$---which we'll
describe by saying that 
	\begin{equation*} \sqrt{p}(\,\cdot\,)\sqrt{p}\colon \scrA\to\scrA
	\end{equation*}
is \emph{$\diamond$-self-adjoint}.
Judging only by the name
it may not surprise you that the map $b(\,\cdot\,)b\colon \scrA\to\scrA$
where~$b\in \scrA$ is self-adjoint (but not necessarily positive)
turns out to be $\diamond$-self-adjoint too,
so that as a final touch we introduce the notion
of \emph{$\diamond$-positive} maps $f\colon \scrA\to\scrA$
that are simply maps of the form~$f\equiv gg$ for some $\diamond$-self-adjoint~$g$.

The main technical result, then, of this section
is that any $\diamond$-positive map $f\colon\scrA\to\scrA$
is of the form~$f=\sqrt{p}(\,\cdot\,)\sqrt{p}$
where~$p=f(1)$;
and, accordingly, our axioms 
(in~\sref{uniqueness-sequential-product})
that uniquely
determine the sequential product~$\ast$
on the effects of a von Neumann algebra~$\scrA$ are:
for every effect~$p$ of~$\scrA$,
\begin{enumerate}
\item
$p\ast 1=p$,
\item
$p\ast q = f(q)$
for all~$q\in [0,1]_\scrA$
for some pure map~$f\colon \scrA\to\scrA$,
\item
$p=q\ast q$ for some $q$ from~$[0,1]_\scrA$,
\item
$p \ast (p \ast q) = (p\ast p)\ast q$
for all~$q\in[0,1]_\scrA$,
\item
$p \ast e_1 \leq e_2^\perp\iff
p \ast e_2 \leq e_1^\perp$
for all projections $e_1,e_2$ of~$\scrA$.
\end{enumerate}%
While I would certainly not like
to undersell the results mentioned above,
I suspect that the notion of purity exposed along the way
might turn out to be of far greater significance
for the following reason.
Our notion of purity can be described in
wildly different terms:
a map~$f\colon \scrA\to\scrB$ is pure when given its
\emph{Paschke dilation}
$\xymatrix{\scrA
	\ar[r]|-\varrho
&
	\scrP\ar[r]|-c
&
\scrB}$
the map $\varrho$ is surjective
(see~\sref{paschke-pure} and~\cite{wwpaschke}).
Because of my faith in our notion of purity I've allowed myself
to address some theoretical questions concerning it
here that are not required for the main results of this thesis,
but suppose a general interest in purity:
I'll show that every pure map~$f\colon\scrA\to\scrB$
is extreme among the ncp-maps~$g\colon \scrA\to\scrB$ with~$f(1)=g(1)$,
and, in fact, enjoys the possibly stronger property 
of being~\emph{rigid} (see~\sref{rigid} and~\sref{pure-is-rigid}).
\end{point}
\end{parsec}
\subsection{Corner and Filter}
\begin{parsec}{940}%
\begin{point}{10}{Definition}%
Given a projection~$e$ of a von Neumann algebra~$\scrA$,
the \Define{corner}%
	\index{corner (von Neumann algebra)}
of~$e$
is the subset~$e\scrA e$%
\index{*eAe@$e\scrA e$, corner}
of~$\scrA$ 
(consisting of the elements of~$\scrA$
of the form~$eae$ with~$a\in\scrA$).
In this context,
the obvious map~$e\scrA e\to\scrA$
is called the \Define{inclusion}%
\index{inclusion!of a corner}
and the map $a\mapsto eae,\ \scrA\to e\scrA e$
is called the \Define{projection}.%
\index{projection!onto a corner}
\end{point}
\begin{point}{20}[corner-vna-basic]{Exercise}%
Let~$e$ be a projection from a von Neumann algebra~$\scrA$.
\begin{enumerate}
\item
Show that~$a\in\scrA$ 
is an element of~$e\scrA e$ iff~$eae=a$
iff $\ceilr{a}\cup\ceill{a} \leq e$.
\item
Show that the corner~$e\scrA e$
is closed under addition, (scalar) multiplication,
and involution.
\item
Show that~$e$ is a unit for~$e\scrA e$,
that is, $ea=ae=a$ for all~$a\in e\scrA e$.
\item
Show that~$e\scrA e$ is norm and ultraweakly closed.\\
(Hint: use the fact that $e(\,\cdot\,)e\colon \scrA\to\scrA$
is normal and bounded.)
\item
Show that~$e\scrA e$ --- 
endowed with the addition, (scalar) multiplication,
involution and norm from~$\scrA$,
and with~$e$ as its unit ---  is a $C^*$-algebra.
\item
Show that the supremum of a bounded directed
set~$D$ of self-adjoint elements of~$e\scrA e$
computed in~$\scrA$
is itself in~$e\scrA e$,
and, in fact, the supremum of~$D$ in~$e\scrA e$.
\item
Show that the inclusion $e\scrA e\to\scrA$
is an ncpsu-map.
\item
Deduce from this that the restriction of an np-map
$\omega\colon \scrA\to\C$ to
a map $e\scrA e\to\C$
is an np-map.

Conclude that~$e\scrA e$ is a von Neumann algebra.
\item
Show that the projection $a\mapsto eae,\ \scrA\to e\scrA e$
is an ncpu-map.
\item
Show that every np-map $\omega\colon e\scrA e\to\C$
is the restriction
of the np-map $\omega(e(\,\cdot\,)e)\colon \scrA\to\C$.
Deduce from this that the ultraweak topology of~$e\scrA e$
coincides (on $e\scrA e$) with the ultraweak topology on~$\scrA$.
Show that the ultrastrong topologies on~$e\scrA e$ and~$\scrA$
coincide in a similar fashion.
\end{enumerate}
\spacingfix
\end{point}%
\begin{point}{30}[ad-ncp]{Exercise}%
Let~$a$ be an element of a von Neumann algebra~$\scrA$,
and let~$p$ and~$q$ be projections
of~$\scrA$ with $a^*pa\leq q$.
\begin{enumerate}
\item
Show that $a^*ba\in q\scrA q$
for every~$b\in p\scrA p$.
\item
Show that~$a^*(\,\cdot\,)a$
gives an ncp-map $p\scrA p\to q\scrA q$.
\end{enumerate}
\spacingfix%
\end{point}%
\end{parsec}%
\begin{parsec}{950}%
\begin{point}{10}[corner]{Definition}%
Let~$p$ be an effect of a von Neumann algebra~$\scrA$.
A \Define{corner}%
	\index{corner (map)}
of~$p$ is an
ncp-map $\pi\colon \scrA\to\scrC$
to a von Neumann algebra~$\scrC$
with~$\pi(p^\perp)=0$,
which is initial among such maps 
in the sense
that every ncp-map $f\colon \scrA\to\scrB$
with~$f(p^\perp)=0$
factors as $f=g\circ\pi$
for some unique ncp-map $g\colon \scrC\to\scrB$.

While most corners
that we'll deal with are unital,
there are also corners which are not unital
(because there are non-unital
ncp-isomorphisms).
When we write ``corner'' we shall
always mean a ``unital corner''%
\index{corner (map)!unital}
unless explicitly stated otherwise.
\end{point}
\begin{point}{20}[prop-corner]{Proposition}%
Given an effect~$p$ of a von Neumann algebra~$\scrA$,
and a partial isometry~$u$ of~$\scrA$
with $\floor{p}=uu^*$,
the map $\pi\colon \scrA\to u^*u \scrA u^*u$
given by~$\pi(a)=u^*au$ is a corner of~$p$.
\begin{point}{30}{Proof}%
By~\sref{ad-ncp}, $\pi$ is an ncp-map.
To see that~$\pi(p^\perp)\equiv u^*p^\perp u =0$,
note that since~$u^*u=u^*\,u u^*\,u$,
we have $0=u^*(uu^*)^\perp u =u^*\smash{\floor{p}}^\perp u
= u^*\ceil{\smash{p^\perp}} u$,
and so
$0 = \ceil{u^* \ceil{\smash{p^\perp}} u }
=\ceil{u^* p^\perp u}$
by~\sref{ceil-fundamental},
giving~$u^*p^\perp u=0$
by~\sref{ceil-basic}.


Let~$\scrB$ be a von Neumann algebra,
and let~$f\colon \scrA\to\scrB$ be an ncp-map
with $f(p^\perp)=0$.
To show that~$\pi$ is a corner,
we must show that there is a unique ncp-map
$g\colon u^*u \scrA u^*u\to\scrB$
with $f=g\circ \pi$.
Uniqueness follows
from surjectivity of~$\pi$.
Concerning existence,
define~$g:= f\circ \zeta$,
where $\zeta\colon  u^*u\scrA u^*u\to \scrA$
is the ncp-map given by~$\zeta(a)=uau^*$
for~$a\in\scrA$ (see~\sref{ad-ncp}),
so that it is immediately clear that~$g$ is an ncp-map.
It remains to be shown~$f=g\circ \pi$,
that is,
$f(a)=f(uu^*\,a\,uu^*)$ for all~$a\in\scrA$.
This follows from~\sref{cp-comprehension}
because~$f(\smash{(uu^*)^\perp})=0$,
since~$\ceil{\smash{f(\,\smash{(uu^*)^\perp}\,)}}
=\ceil{\smash{f(\smash{\floor{p}}^\perp)}}
=\ceil{\smash{f(\ceil{\smash{p^\perp}})}}
= \ceil{\smash{f(p^\perp)}}=\ceil{0}=0$.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}{960}%
\begin{point}{10}[filter]{Definition}%
A \Define{filter}%
\index{filter}
is an ncp-map $c\colon \scrC\to\scrA$
between von Neumann algebras
such that every ncp-map $f\colon \scrB\to\scrA$
with~$f(1)\leq c(1)$
factors as $f=c\circ g$
for some unique ncp-map $g \colon \scrB\to\scrC$.
We'll say that~$c$ is a \Define{filter for}~$c(1)$.
\index{filter!for~$p$}
\begin{point}{11}{Remark}%
In the abstract setting of effectus theory,
it makes sense to call these filters
``quotients'', as we do in~\cite{cho2015quotient};
but since in the concrete setting of von Neumann algebras
``quotient'' has a pre-existing and unrelated meaning,
we chose to use the word ``filter'' instead (as in ``polarising filter''),
an idea borrowed from~\cite{wilce2016royal}.
\end{point}
\end{point}
\begin{point}{20}%
To show that there is a filter
for every positive element of a von Neumann algebra
we need the following result
concerning ultraweak limits of ncp-maps.
\end{point}
\begin{point}{30}[ncp-uwlim]{Lemma}%
Given von Neumann algebras~$\scrA$
and~$\scrB$
the pointwise ultraweak limit
$f\colon \scrA\to\scrB$
of a net of  positive linear maps $f_\alpha\colon \scrA\to\scrB$
is positive, and, 
\begin{enumerate}
\item
$f$ is completely positive provided
that the $f_\alpha$ are completely positive, and
\item
$f$ is normal provided that the $f_\alpha$ are normal
and the ultraweak convergence of the~$f_\alpha$ to~$f$
is uniform on~$[0,1]_\scrA$.
\end{enumerate}
\spacingfix%
\begin{point}{40}{Proof}%
Since given~$a\in \scrA$ the element~$f(a)$
is the ultraweak limit of the positive elements~$f_\alpha(a)$,
and therefore positive (by~\sref{vn-positive-basic}),
we see that~$f$ is positive.

Suppose that each~$f_\alpha$ is completely positive.
To show that~$f$ is completely positive,
we must prove, given~$a_1,\dotsc,a_n\in\scrA$
and~$b_1,\dotsc,b_n\in\scrB$,
that 
the element $\sum_{i,j} b_i^* f(a_i^*a_j)b_j$
of~$\scrB$
is positive.
And indeed it is,
being the ultraweak limit of
the positive elements $\sum_{i,j} b_i^* f_\alpha (a_i^* a_j)b_j$,
because  $f_\alpha(a_i^* a_j)$
converges ultraweakly to~$f(a_i^* a_j)$,
and~$b_i^*(\,\cdot\,)b_j\colon \scrB\to\scrB$
is ultraweakly continuous
(\sref{mult-uws-cont})
for any~$i$ and~$j$.

If the~$f_\alpha$ 
are normal,
and converge uniformly on~$[0,1]_\scrA$ ultraweakly
to~$f$,
then~$f$ is ultraweakly continuous
on~$[0,1]_\scrA$
(because the uniform limit of continuous functions is continuous),
and thus normal (by~\sref{p-uwcont}).\qed
\end{point}
\end{point}
\begin{point}{50}[canonical-filter]{Proposition}%
Given an element~$d$ of a von Neumann algebra~$\scrA$,
the map $c\colon \ceilr{d}\!\scrA\!\ceilr{d}\to\scrA$
given by~$c(a)=d^*ad$
is a filter.
\begin{point}{60}{Proof}%
Note that~$c$ is an ncp-map by~\sref{ad-ncp}.
Let~$\scrB$ be a von Neumann algebra,
and let~$f\colon \scrB\to\scrA$ be an ncp-map
with $f(1)\leq c(1)$.
To show that~$c$ is a filter,
we must show that there is a unique ncp-map
$g\colon \scrB\to
\ceilr{d}\!\scrA\!\ceilr{d}$
with~$f=c\circ g$.
Uniqueness of~$g$ follows from the observation
that~$c$ is injective by~\sref{mult-cancellation}.

To establish the existence of such~$g$,
note that~$f(b)$ is an element of~$d^*\scrA d$,
when~$b$ is positive
by~\sref{sequential-douglas}
because~$0\leq f(b)\leq \|b\|f(1)\leq \|b\| c(1)=\|b\|d^*d$,
and thus for arbitrary~$b\in\scrB$ too
(being a linear combination
of positive elements).
We can thus define $g\colon \scrB\to \ceilr{d}\!\scrA\!\ceilr{d}$
by~$g(b)=d^*\backslash f(b)/d$
for all~$b\in\scrB$.
It is clear that~$g$ is linear and positive,
and~$c\circ g=f$.

To see that~$g$ is normal,
note that
$d^*\backslash\,\cdot\,/d\colon
d^*(\scrA)_1 d\to\scrA$
is ultrastrongly continuous by~\sref{div-usc},
as is~$f$ by~\sref{cp-uscont}
(also) as map from~$(\scrB)_1$ to~$d^*(\scrA)_1 d$,
so that~$g$ is ultrastrongly continuous on~$(\scrB)_1$,
and therefore normal by~\sref{p-uwcont}.

Finally, $g$ is completely positive
by~\sref{ncp-uwlim},
because it is by~\sref{div-approx}
the uniform ultrastrong limit
of the by~\sref{ad-ncp} completely positive maps
$(\sum_{n=1}^Nt_n)^* \,f(\,\cdot\,)\,(\sum_{n=1}^N t_n)$,
where~$t_1,t_2,\dotsc$
is an approximate pseudoinverse of~$d$.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}{970}
\begin{point}{10}
Before exploring their more technical aspects,
we'll explain how
corners and filters can be made to appear at opposite ends
of a chain of adjunctions:
\begin{equation*} 
\xymatrix@R=5em{ 
	\Cat{Eff}\ar[d]
	\ar@/_3ex/@{{}{ }{}}[d]|\dashv
	\ar@/^3ex/@{{}{ }{}}[d]|\dashv
	\ar@/_11.5ex/@{{}{ }{}}[d]|\dashv
	\ar@/^11.5ex/@{{}{ }{}}[d]|\dashv
	\ar@/_15ex/[d]_{\text{Filter}}
	\ar@/^15ex/[d]^{\text{Corner}}
	\\ 
	\op{(\W{cpsu})}\ar@/^8ex/[u]_{\mathbf{0}}\ar@/_8ex/[u]^{\mathbf{1}} 
}  
\end{equation*} 
The category $\Define{\Cat{Eff}}$%
\index{Eff@$\Cat{Eff}$}%
\index{quotient--comprehension chain}
has as objects pairs $(\scrA, p)$,
where~$\scrA$ is a von Neumann algebra, and~$p\in[0,1]_\scrA$
is an effect from~$\scrA$.
A morphism  $(\scrA,p)\longrightarrow (\scrB,q)$
in~$\Cat{Eff}$
is an ncpsu-map $f\colon \scrB\to \scrA$ with $p\leq f(q)+f(1)^\perp$
--- that is,
\begin{equation*}
	\omega(p)\ \leq\ \omega(f(q))\,+\,\omega(f(1))^\perp
	\qquad\text{for every normal state } \omega\colon \scrA\to \C.
\end{equation*}
The functor $\Cat{Eff}\longrightarrow \op{(\W{cpsu})}$
in the middle of the diagram above 
	maps a morphism $f\colon (\scrA,p)\to(\scrB,q)$
to the underlying map $f\colon \scrB\to\scrA$.
The functors~$\mathbf{0}$ and~$\mathbf{1}$
on its sides map a von Neumann algebra~$\scrA$ to
$(\scrA,0)$ and~$(\scrA,1)$, respectively,
and send an ncpsu-map $f\colon \scrA\to\scrB$ to itself; 
this is possible since
\begin{equation*}
0\,\leq\,  f(0) + f(1)^\perp
	\qquad\text{and}\qquad
1\,\leq\, f(1)+f(1)^\perp.
\end{equation*}
That~$\mathbf{1}$
is right adjoint to the functor $\Cat{Eff}\longrightarrow \op{(\W{cpsu})}$
follows from the observation that
an ncpsu-map $f\colon \scrB\to\scrA$
is always a morphism $(\scrA,p)\to(\scrB,1)$,
whatever $p\in[0,1]_\scrA$ may be,
because  $p \leq f(1)+f(1)^\perp$.
For a similar reason  $\mathbf{0}$ is left adjoint to
$\Cat{Eff}\longrightarrow \op{(\W{cpsu})}$.

On the other hand,
a morphism $(\scrA,1)\to(\scrB,q)$ where $q\in[0,1]_\scrB$
is not just any ncpsu-map $f\colon \scrB\to\scrA$,
but one
with $1\leq f(q)+f(1)^\perp$,
that is, $f(q^\perp)=0$.
It's no surprise then that
a corner $\pi\colon \scrB\to \scrC$ for~$q\in[0,1]_\scrB$
considered as morphism $(\scrC,1)\to(\scrB,q)$
is a universal arrow from~$\mathbf{1}$ to~$(\scrB,q)$.

On the other side there's a twist:
a morphism $(\scrA,p)\to(\scrB,0)$ where~$p\in[0,1]_\scrA$
is an ncpsu-map $f\colon \scrA\to\scrB$
with $p\leq f(0)+f(1)^\perp$,
that is, $f(1)\leq p^\perp$.
It follows that any filter $c\colon \scrC\to \scrA$ for~$p^\perp$,
when considered as morphism $(\scrA,p)\to (\scrC,0)$,
is a universal arrow from~$(\scrA,p)$ to~$\mathbf{0}$.

This chain of adjunctions not only exposes
a hidden symmetry between filters and corners,
but such chains appear
in many other categories as well, see~\cite{cho2015quotient}.
\end{point}
\end{parsec}
\begin{parsec}{980}%
\begin{point}{10}[dfn-standard-corner-and-filter]{Definition}%
Let~$\scrA$ be a von Neumann algebra.
\begin{enumerate}
\item
Given a positive element~$p$
of~$\scrA$
we denote
by $\Define{c_p}\colon \ceil{p}\!\scrA\!\ceil{p}\to\scrA$%
\index{cp@$c_p$, standard filter for~$p$}
the \Define{standard filter}%
\index{filter!standard}
for~$p$
given by~$c_p(a)=\sqrt{p}a\sqrt{p}$
for all~$a\in\ceil{p}\!\scrA\!\ceil{p}$.
\item
Given an effect~$p$ of~$\scrA$
we denote
by $\Define{\pi_p}\colon \scrA\to\floor{p}\!\scrA\!\floor{p}$%
		\index{pip@$\pi_p$, standard corner of~$p$}
the \Define{standard corner}%
\index{corner (map)!standard}
		of~$p$
given by~$\pi_p(a)=\floor{p}\!a\!\floor{p}$.
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{20}[filter-basic]{Exercise}%
Let~$c\colon \scrC\to\scrA$ be a filter,
where~$\scrC$ and~$\scrA$ are von Neumann algebras.
\begin{enumerate}
\item
Show that, writing~$p:=c(1)$,
there is a unique
ncp-map $\alpha \colon \scrC\to \ceil{p}\!\scrA\!\ceil{p}$
with $c = c_p \circ \alpha$;
and that this~$\alpha$ is a unital ncp-isomorphism.
\item
Show that~$c$ is injective
(by proving first that~$c_p$ is injective
using~\sref{mult-cancellation}).

Conclude that~$c$
is faithful (so $\ceil{f}=1$), and that~$c$ is mono in~$\W{CP}$.
\item
Show that~$c$ is bipositive
(by proving first that~$c_p$
is bipositive using~\sref{sequential-douglas}).
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{30}[filters-composition]{Exercise}%
Show that the composition~$d\circ c$
of filters~$c\colon\scrC\to\scrD$
and~$d\colon \scrD\to\scrA$ 
between von Neumann algebras
is again a filter.
\end{point}
\begin{point}{40}[corner-basic]{Exercise}%
Let~$p$ be an effect of a von Neumann algebra~$\scrA$,
and let~$\pi\colon \scrA\to\scrC$ be a corner of~$p$.
\begin{enumerate}
\item
Show that there is a unique ncp-map
$\beta \colon \floor{p}\!\scrA\!\floor{p}\to\scrC$
with~$\pi = \beta\circ \pi_p$;
and that this~$\beta$ is unital and an ncp-isomorphism.
\item
Show that~$\pi$ is surjective, and that~$\pi$ is epi in~$\W{cp}$.
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{50}[corners-floor]{Exercise}%
Show that an ncpu-map $\pi\colon \scrA\to\scrB$
between von Neumann algebras
is a corner for an effect~$p$ of~$\scrA$
iff~$\pi$ is a corner for~$\floor{p}$;
in which case~$\ceil{\pi}=\floor{p}$.

Thus a corner~$\pi$ is a corner for~$\ceil{\pi}$.
\end{point}
\begin{point}{60}[corners-composition]{Exercise}%
Show that the composition~$\tau\circ \pi$
of corners~$\pi\colon \scrA\to\scrB$
and~$\tau\colon \scrB\to\scrC$
between von Neumann algebras
is again a corner.\\
(Hint:
prove
and use the inequality
$\ceil{\tau}\leq \ceil{\smash{\pi(\ceil{\tau\circ \pi}^\perp)}}^\perp$.)
\end{point}
\begin{point}{70}[filter-corner]{Theorem}%
Given an ncp-map $f\colon\scrA\to\scrB$
between von Neumann algebras,
a projection~$e$ of~$\scrA$
with~$\ceil{f}\leq e$,
and a positive element~$p$
of~$\scrB$ with~$f(1) \leq p$,
there is a unique ncp-map
$g \colon e\scrA e
\to \ceil{p}\!\scrB\!\ceil{p}$
such that
\begin{equation*}
\xymatrix@C=4em{
\scrA
\ar[r]^-f
\ar[d]_{\pi_e}
&
\scrB
\\
e\scrA e
\ar[r]_-g
& 
\ceil{p}\!\scrB\!\ceil{p}
\ar[u]_{c_p}
}
\end{equation*}
commutes,
and it is given by
$g(a)=\sqrt{p}\backslash f(a)/\!\sqrt{p}$
for all~$a\in e\scrA e$.
\begin{point}{80}{Proof}%
Uniqueness of~$g$ follows from the facts
that~$\pi_e$ is epi and~$c_p$ is mono
in~$\W{cp}$,
see~\sref{corner-basic} and~\sref{filter-basic}.

Concerning existence, 
since~$\pi_e$ is a corner of~$e$,~\sref{corner},
and~$\ceil{f}\leq e$,
or in other words, $f(e^\perp)=0$,
there is a unique ncp-map $h\colon e\scrA e\to \scrB$
with $h \circ \pi_e = f$.
Note that~$h(a)=f(a)$ for all~$a$ from~$e\scrA e$.

As~$h(1)=h(\pi_e(1))=f(1)\leq p=c_p(1)$,
and~$c_p$ is a filter,~\sref{filter},
there is a unique ncp-map
$g\colon e\scrA e \to p \scrB p$
with $c_p\circ g = h$,
which is (by the proof of \sref{canonical-filter}) given by
$g(a)=\sqrt{p}\backslash h(a)/\sqrt{p}
\equiv \sqrt{p}\backslash f(a)/\sqrt{p}$
for all~$a$ from~$e\scrA e$.
Then~$c_p\circ g\circ \pi_e = h\circ \pi_e = f$.\qed
\end{point}
\end{point}
\begin{point}{90}[square-f]{Corollary}%
Given an ncp-map $f\colon \scrA\to\scrB$
between von Neumann algebras,
there is a unique ncp-map $\Define{[f]}\colon 
\ceil{f}\!\scrA\!\ceil{f}
\to
\ceil{f(1)}\!\scrB\!\ceil{f(1)}$%
\index{*brackets@$[\,\cdot\,]$!$[f]$, for an ncp-map}
such that 
\begin{equation*}
\xymatrix@C=4em{
\scrA
\ar[r]^-f
\ar[d]_{\pi_{\ceil{f}}}
&
\scrB
\\
\ceil{f}\!\scrA\!\ceil{f}
\ar[r]_-{[f]}
& 
\ceil{f(1)}\!\scrB\!\ceil{f(1)}
\ar[u]_{c_{f(1)}}
}
\end{equation*}
commutes;
and it is given by~$[f](a)=\sqrt{f(1)}\backslash f(a)/\!\sqrt{f(1)}$
for all~$a$ from $\ceil{f}\!\scrA\!\ceil{f}$.

Moreover, 
$[f]$ is unital and faithful.
\end{point}
\begin{point}{100}{Example}%
For any faithful unital ncp-map $f\colon \scrA\to \scrB$
we have~$[f]=f$.
Such a map need not be an isomorphism;
	as one may take $f\colon (\lambda,\mu)\mapsto \frac{1}{2}(\lambda+\mu),
\C^2\to\C$.
\end{point}
\begin{point}{110}[ad-pure]{Example}%
In the concrete case
that $f\equiv a^*(\,\cdot\,)a \colon
s\scrA s\to t\scrA t$,
where~$a$ is an element
of a von Neumann algebra,
and $s$ and~$t$ are projections of~$\scrA$
with
$\ceilr{a}\leq s$
and~$\ceill{a}\leq t$,
the map~$[f]$ 
is closely related to the
polar decomposition $a\equiv [a]\sqrt{a^*a}
= \sqrt{aa^*}[a]$ of~$a$,
where $[a]=a/\sqrt{a^*a}$
(see~\sref{polar-decomposition}).

Indeed,
since  $\ceil{f}=\ceilr{a}$,
$f(1)=a^*a$,
and~$[f]\equiv \sqrt{a^*a}\backslash a^*(\,\cdot\,)a/\sqrt{a^*a}
\equiv [a](\,\cdot\,)[a]^*$,
the picture becomes:
\begin{equation*}
\xymatrix@C=10em{
s\scrA s
\ar[r]^-{f\,=\,a^*\,(\,\cdot\,)\,a}
\ar[d]_{\pi_{\ceilr{a}}}
&
t\scrA t
\\
\ceilr{a}\!\scrA\!\ceilr{a}
\ar[r]_-{[f] \,=\,  [a]\,(\,\cdot\,)\,[a]^*}
& 
\ceill{a}\!\scrA\!\ceill{a}
\ar[u]_{c_{a^*a}}
}
\end{equation*}
Note that in this example
$[f]$ is an ncpu-isomorphism,
because~$[a]$ is a partial isometry
with initial projection~$\ceill{a}$
and final projection~$\ceilr{a}$.
Thus one can think of the diagram above
as an isomorphism theorem of sorts,
which applies only to certain  ncp-maps
that'll be called \emph{pure} in a moment (see~\sref{pure-fundamental}).
\end{point}
\end{parsec}
\subsection{Isomorphism}
\begin{parsec}{990}%
\begin{point}{10}%
In case you were wondering,
the ncpu-isomorphism
we encountered in~\sref{ad-pure}
is simply an nmiu-isomorphism 
(see~\sref{iso}), which follows
from the following characterisation of multiplicativity.
\end{point}
\begin{point}{20}[gardner]{Proposition}%
\index{multiplicative!ncpsu-map}
For an ncpu-map $f\colon \scrA\to\scrB$
between von Neumann algebras
the following are equivalent.
\begin{enumerate}
\item
\label{gardner-1}
$f$ is multiplicative.
\item
\label{gardner-2}
$f(a)f(b)=0$
for all $a,b\in\scrA$ with $ab=0$.
\item
\label{gardner-3}
$\ceil{f(p)}\ceil{f(q)}=0$
for all projections $p$ and~$q$ of~$\scrA$ with $pq=0$.
\item
\label{gardner-4}
$f$ maps projections to projections.
\item
\label{gardner-5}
$\ceil{f(a)}=f(\ceil{a})$
for all~$a\in\scrA_+$.
\end{enumerate}
\spacingfix%
\begin{point}{30}{Proof}%
(Based in part on the work of Gardner in~\cite{gardner}).
\begin{point}{40}{\sref{gardner-1}$\Longrightarrow$\sref{gardner-4}
 and \sref{gardner-5}$\Longrightarrow$\sref{gardner-4}}
	are rather obvious.
\end{point}
\begin{point}{50}{\sref{gardner-4}$\Longrightarrow$\sref{gardner-5}}%
 $\ceil{f(a)}
\smash{\overset{\sref{ncp-ceil}}{=\joinrel=\joinrel=}}
\ceil{f(\ceil{a})}
=f(\ceil{a})$
since~$f(\ceil{a})$ is a projection.
\end{point}
\begin{point}{60}{\sref{gardner-4}$\Longrightarrow$\sref{gardner-3}}%
Let~$p$ and~$q$ be projections of~$\scrA$ with~$pq=0$.
Then~$p\leq q^\perp$, and so~$f(p)\leq f(q^\perp)=f(q)^\perp$,
which implies that $\ceil{f(p)}\ceil{f(q)}
=f(p)f(q)=0$ since~$f(p)$ and~$f(q)$ are projections.
\end{point}
\begin{point}{70}{\sref{gardner-3}$\Longrightarrow$\sref{gardner-2}}%
Let~$a,b\in\scrA$ with~$ab=0$ be given.
We must show that~$f(a)f(b)=0$,
and for this it suffices to show that
$\ceill{f(a)}\ceilr{f(b)}=0$,
because $f(a)f(b)=f(a)\ceill{f(a)}\ceilr{f(b)}f(b)$.
Since~$ab=0$,
we have~$\ceill{a}\ceilr{b}=0$ by~\sref{mult-cancellation},
and so~$\ceil{f(\ceill{a})}\ceil{f(\ceilr{a})}=0$.
Now,
since $\ceil{f(\ceill{a})}\leq \ceill{f(a)}$
	and $\ceil{f(\ceilr{a}}\leq \ceilr{f(a)}$
	by~\sref{ncp-ceill},
we get $\ceill{f(a)}\ceilr{f(b)}
	= \ceill{f(a)} \ceil{f(\ceill{a})}
	\ceil{f(\ceilr{a})}
	\ceilr{f(a)}
	=0$.
\end{point}
\begin{point}{80}{\sref{gardner-2}$\Longrightarrow$\sref{gardner-1}}%
We must show that~$f(a)f(b)=f(ab)$
for all~$a,b\in \scrA$.
Since the linear span of projections is norm-dense in~$\scrA$,
it suffices to show that $f(a)f(e)=f(ae)$
for any $a\in\scrA$ and a projection~$e$ of~$\scrA$.
Given such~$a$ and~$e$,
we on the one hand have $ae^\perp\, e=0$,
so that~$f(ae^\perp)f(e)=0$,
that is, $f(a)f(e)=f(ae)f(e)$;
and on the other hand
we have $ae\,e^\perp=0$,
so that~$f(ae)f(e^\perp)=0$,
that is, $f(ae)=f(ae)f(e)$;
so that we reach~$f(ae)=f(a)f(e)$ as sum total,
and the result that~$f$ is multiplicative.\qed
\end{point}
\end{point}
\end{point}
\begin{point}{90}[iso]{Theorem}%
An ncpsu-isomorphism $f\colon \scrA\to\scrB$
between von Neumann algebras 
(so both~$f$ and~$f^{-1}$ are ncpsu-maps)
is an nmiu-isomorphism.
\begin{point}{100}{Proof}%
Since~$f^{-1}(1)\leq 1$
and so~$1=f(f^{-1}(1))\leq f(1)\leq 1$,
we see that~$f(1)=1$, so both $f$ and $f^{-1}$ are unital.
It remains to be shown that~$f$ and~$f^{-1}$ are multiplicative.
Since by~\sref{projection-order-sharp} an effect~$a$ of~$\scrA$
is a projection iff~$0$ is the infimum of~$a$ and~$a^\perp$,
	and~$f$ (as ncpu-isomorphism) preserves $(\,\cdot\,)^\perp$
	and order,
we see that~$f$ maps projections to projections,
and is thus multiplicative, by~\sref{gardner}.
It follows automatically that~$f^{-1}$ is multiplicative too.\qed
\end{point}
\end{point}
\begin{point}{110}{Exercise}%
Show that any filter of a projection is multiplicative.\\
(Hint: the filter is
a standard filter
up to an
ncpu-isomorphism, \sref{filter-basic},
which is an nmiu-isomorphism by~\sref{iso}.)
\end{point}
\begin{point}{120}[sharp-multiplicative]{Exercise}%
\index{multiplicative!ncp-map}
Show that for an ncp-map $f\colon \scrA\to\scrB$
between von Neumann algebras
the following are equivalent.
\begin{enumerate}
\item
$f$ is multiplicative.
\item
$f$ sends projections to projections.
\item
$\ceil{f(a)}=f(\ceil{a})$
for all~$a \in\scrA_+$.
\end{enumerate}
(Hint: factor~$f=\zeta \circ h$
where~$\zeta$ is a filter for~$f(1)$
and~$h$ is an ncp-map.)
\end{point}
\end{parsec}
\subsection{Purity}
\begin{parsec}{1000}%
\begin{point}{10}[pure]{Definition}%
Filters, corners,
and their compositions we'll call \Define{pure}.%
\index{pure map}
\end{point}
\begin{point}{20}{Exercise}%
Show that the following maps are pure.
\begin{enumerate}%
\item
An ncp-isomorphism between von Neumann algebras.
\item
The identity map~$\id\colon \scrA\to\scrA$
on a von Neumann algebra~$\scrA$.
\item
The map $a^*\,(\,\cdot\,)\,a\colon \scrA\to\scrA$
for any element~$a$ of a von Neumann algebra~$\scrA$.
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{30}[pure-fundamental]{Proposition}%
For an ncp-map $f\colon \scrA\to\scrB$ between von Neumann algebras
the following are equivalent.
\begin{enumerate}
\item 
\label{pure-fundamental-1}
	$f$ is pure, i.e., $f$ is the composition
	of (perhaps many) filters and corners.
\item
\label{pure-fundamental-2}
	$f = c\circ \pi$ for a filter $c\colon \scrC\to\scrB$
	and a corner $\pi\colon \scrA\to\scrC$.
\item
\label{pure-fundamental-3}
	$[f]$ from~\sref{square-f} is an ncpu-isomorphism.
\end{enumerate}
\spacingfix%
\begin{point}{40}{Proof}%
\ref{pure-fundamental-3}$\Longrightarrow$\ref{pure-fundamental-2}
and \ref{pure-fundamental-2}$\Longrightarrow$\ref{pure-fundamental-1}
are rather obvious.
\begin{point}{50}{\ref{pure-fundamental-1}$\Longrightarrow$%
\ref{pure-fundamental-2}}%
Calling $f$ \emph{properly pure}
when~$f\equiv c\circ \pi$
for some filter~$c$ and corner~$\pi$,
we must show that every pure map is properly pure.
For this it suffices to show that the composition of properly
pure maps is again properly pure;
which,
since filters are closed under composition
(by~\sref{filters-composition}),
and corners are closed under composition
(by~\sref{corners-composition}),
boils down to proving that the composition
$\pi\circ c$ of a corner~$\pi$ and a filter~$c$
is properly pure.
Since~$\pi\equiv \alpha\circ \pi_{\ceil{\pi}}$
and~$c\equiv c_{c(1)}\circ \beta$
for ncpu-isomorphisms~$\alpha$ and~$\beta$
(see~\sref{filter-basic}
and~\sref{corner-basic})
it suffices to show that
$f:=\pi_{s} c_{p}$ is properly pure
for a positive element~$p$ and a projection~$s$
of a von Neumann algebra~$\scrA$.
Since such~$f$ is of the form $f=s\sqrt{p}(\,\cdot\,)\sqrt{p}s
\colon \ceil{p}\!\scrA\!\ceil{p}\to s\scrA s$,
we know by~\sref{ad-pure}
that~$[f]$ is an ncpu-isomorphism,
and thus that~$f\equiv c_{f(1)}\circ [f]\circ \pi_{\ceil{f}}$ is properly pure.
\end{point}
\begin{point}{60}{\ref{pure-fundamental-2}$\Longrightarrow$%
\ref{pure-fundamental-3}}%
Recall that $[f]$
is by definition the unique ncp-map
with~$f = c_{f(1)} [f] \pi_{\ceil{f}}$,
see~\sref{square-f}.
Note that since~$f=c\circ \pi$,
	we have~$\ceil{f}=\ceil{\pi}$ (because~$\ceil{c}=1$ 
	by~\sref{filter-basic}),
and~$f(1)=c(1)$ (because~$\pi(1)=1$).
Since there are ncpu-isomorphisms~$\alpha$ and~$\beta$
with $\pi= \alpha \pi_{\ceil{\pi}}$ and  $c=c_{c(1)} \beta$,
we see that~$f=c_{c(1)} \beta\alpha \pi_{\ceil{\pi}}$,
and so~$[f]=\beta\alpha$
by definition of~$[f]$,
so~$[f]$ is an ncpu-isomorphism.\qed
\end{point}
\end{point}
\end{point}
\begin{point}{70}[special-pure-maps]{Exercise}%
Use~\sref{pure-fundamental} to show that 
\begin{enumerate}
\item
a faithful pure map is a filter,
\item
a unital pure map is a corner, and
\item
a unital and faithful pure map is an ncpu-isomorphism.
\end{enumerate}
\spacingfix
\end{point}%
\end{parsec}%
\subsection{Contraposition}
\begin{parsec}{1010}%
\begin{point}{10}{Definition}%
Given an ncp-map $f\colon \scrA\to\scrB$
between von Neumann algebras
we define
$\Define{f^\diamond}\colon \Proj(\scrA)\to \Proj(\scrB)$%
\index{*diamond@$f^\diamond$}
by~$f^\diamond(e)=\ceil{f(e)}$
for all~$e\in\Proj(\scrA)$.
\begin{point}{11}{Remark}%
The significance of the symbol~``$\diamond$''
in~$f^\diamond$
is in 
accommodating the notation~$f^\BOX(e):=f^\diamond(e^\perp)^\perp$
used
    in the next thesis, in~\sref{diamond-basics}.
\end{point}
\end{point}
\begin{point}{20}{Proposition}%
Given an ncp-map $f\colon \scrA\to\scrB$
between von Neumann algebras
and a projection~$e$ from~$\scrB$
there is a least projection~$\Define{f_\diamond(e)}$ from~$\scrA$%
\index{*diamondsub@$f_\diamond$}
with~$\ceil{f(\,f_\diamond(e)^\perp\,)}\leq e^\perp$,
namely~$f_\diamond(e) =\ceil{\,ef(\,\cdot\,)e\,}$
(being the carrier 
	of the ncp-map $ef(\,\cdot\,)e$ from~\sref{carrier});
giving a map $\Define{f_\diamond}\colon \Proj(\scrB)\to\Proj(\scrA)$.
\begin{point}{30}{Proof}%
Since by definition $\ceil{\,ef(\,\cdot\,)e\,}$
is the greatest projection~$s$ of~$\scrA$
with $ef(s^\perp)e=0$ (see~\sref{carrier});
and~$ef(s^\perp )e=0$ iff~$\ceil{f(s^\perp)}
\leq\ceil{e(\,\cdot\,)e}^\perp\equiv
e^\perp$;
the projection
$\ceil{\,ef(\,\cdot\,)e\,}$
satisfies the description of~$f_\diamond(e)$.\qed
\end{point}
\end{point}
\begin{point}{40}[diamond-suprema]{Exercise}%
Let~$f\colon \scrA\to\scrB$ be an ncp-map between von Neumann algebras.
\begin{enumerate}
\item
Show that $f^\diamond(s)\leq t^\perp$
iff $f_\diamond(t)\leq s^\perp$,
for all~$s\in\Proj(\scrA)$ and~$t\in\Proj(\scrB)$.
\item
Show that $f^\diamond(\,\bigcup E\,)
= \bigcup_{e\in E} f^\diamond(e)$
for every set of projections~$E$ from~$\scrA$.
\end{enumerate}%
\spacingfix%
\end{point}%
\begin{point}{50}{Exercise}%
Show that for ncp-maps $f,g\colon\scrA\to\scrB$
between von Neumann algebras $f^\diamond = g^\diamond$
iff $f_\diamond = g_\diamond$.
In that case we say that $f$ and~$g$ are \Define{equivalent}.%
	\index{equivalent ncp-maps}
    \begin{point}{60}[contraposed]%
Show that for ncp-maps $f\colon \scrA\to\scrB$
and~$g\colon \scrB\to\scrA$ we have
$f^\diamond=g_\diamond$ iff $f_\diamond = g^\diamond$
iff $\ceil{f(s)}\leq t^\perp\iff \ceil{g(t)}\leq s^\perp$
for all projections $s$ from~$\scrA$ and~$t$ from~$\scrB$.

In that case we say that~$f$ and~$g$ are \Define{contraposed}.%
	\index{contraposed}
\end{point}
\end{point}
\begin{point}{70}[equivalent-examples]{Examples}%
\begin{enumerate}
\item
Given an element~$a$ of a von Neumann algebra~$\scrA$,
the maps $a^*(\,\cdot\,)a$ and~$a(\,\cdot\,)a^*$
on~$\scrA$ are contraposed.

If~$p$ and~$q$ are projections of~$\scrA$
with $a^*pa\leq q$
(as in~\sref{ad-ncp}),
then the maps
$a^*(\,\cdot\,)a \colon p\scrA p\to q\scrA q$
and~$a(\,\cdot\,)a^*\colon q\scrA q \to p\scrA p$
are contraposed.

In particular,
the standard corner $\pi_s\colon \scrA\to s \scrA s$
and the standard filter $c_s\colon s\scrA s\to \scrA$
for a projection~$s$ from~$\scrA$
are contraposed.
\item
An ncp-isomorphism $f\colon \scrA\to\scrB$
between von Neumann algebras
is contraposed to its inverse~$f^{-1}\colon \scrB\to\scrA$.
\item
There may be many maps equivalent to a given ncp-map $f\colon \scrA\to\scrB$
between von Neumann algebras:
show that~$(zf)^\diamond = f^\diamond$
for every positive central element~$z$ of~$\scrB$ with~$\ceil{z}=1$.
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{80}[diamond-composition]{Exercise}%
Let $\xymatrix{
	\scrA\ar[r]|-{f}&
	\scrB\ar[r]|-{g}&
\scrC}$
be ncp-maps between von Neumann algebras~$\scrA$,
$\scrB$ and~$\scrC$.
\begin{enumerate}
\item
Show that $(g\circ f)^\diamond = g^\diamond\circ f^\diamond$
(using~\sref{ncp-ceil}),
and $(g\circ f)_\diamond = f_\diamond\circ g_\diamond$.

\item
Assuming that $f$ is equivalent 
to an ncp-map $f'\colon \scrA\to\scrB$
and~$g$ is equivalent to
an ncp-map~$g'\colon \scrB\to\scrC$,
show that~$g\circ f$ is equivalent to~$g'\circ f'$.
\item
Assuming that $f$ is contraposed to
an ncp-map $f'\colon \scrB\to\scrA$
and~$g$ is contraposed to
an ncp-map $g'\colon \scrC\to\scrB$,
show that~$g\circ f$ is contraposed to~$f'\circ g'$.
\end{enumerate}
\spacingfix
\end{point}%
\begin{point}{90}[diamond-sum]{Proposition}%
Given ncp-maps~$f,g\colon \scrA\to\scrB$
between von Neumann algebras
\begin{equation*}
(f+g)^\diamond(s) \,=\, f^\diamond(s)\, \cup\, g^\diamond(s)
\qquad
\text{and}
\qquad (f+g)_\diamond(t)\, =\, f_\diamond(t) \,\cup\, g_\diamond(t)
\end{equation*}
for all~$s\in \Proj(\scrA)$ and~$t\in \Proj(\scrB)$.
\begin{point}{100}[diamond-sum-proof]{Proof}%
Note that $(f+g)^\diamond(s)
=  \ceil{(f+g)(s)}
= \ceil{f(s)+g(s)}
= \ceil{f(s)}\cup \ceil{g(s)}
= f^\diamond(s) \cup g^\diamond(s)$
by~\sref{ceil-basic}.
Since~$(f+g)_\diamond(t)\leq s^\perp$
iff~$f^\diamond(s)\cup g^\diamond(s)\equiv (f+g)^\diamond(s)\leq t^\perp$
iff both $f^\diamond(s)\leq t^\perp$ and~$g^\diamond(s)\leq t^\perp$
iff both $f_\diamond(t)\leq s^\perp$ and~$g_\diamond(t)\leq s^\perp$
iff~$f_\diamond(t)\cup g_\diamond(t)\leq s^\perp$,
we see that $(f+g)_\diamond(t)=f_\diamond(t)\cup g_\diamond(t)$.\qed
\end{point}
\end{point}
\begin{point}{110}[carrier-f-dagger-f]{Lemma}%
Given contraposed
maps~$f\colon \scrA\to\scrB$
and~$g\colon \scrB\to\scrA$ between von Neumann algebras,
we have $\ceil{f}=\ceil{gf}$.
\begin{point}{120}{Proof}%
$\ceil{gf}=(gf)_\diamond(1)
= f_\diamond(g_\diamond(1))
= g^\diamond(\ceil{g})
= g^\diamond(1)=f_\diamond(1)=\ceil{f}$.\qed
\end{point}
\end{point}
\end{parsec}
\subsection{Rigidity}
\begin{parsec}{1020}%
\begin{point}{10}%
We now turn to  a remarkable property shared
by pure and nmiu-maps.
\end{point}
\begin{point}{20}[rigid]{Definition}%
We say that an ncp-map $f\colon \scrA\to\scrB$
between von Neumann algebras is \Define{rigid}%
\index{rigid ncp-map}
when the only ncp-map $g\colon \scrA\to\scrB$
with $g(1)=f(1)$ and $\ceil{f(p)}=\ceil{g(p)}$ for all
projections~$p$ from~$\scrA$ is~$f$ itself.
\end{point}
\begin{point}{30}[rigid-ncp-extreme]{Proposition}%
A rigid map $f\colon \scrA\to\scrB$
between von Neumann algebras
is extreme among the ncp-maps $g\colon \scrA\to\scrB$
with $g(1)=f(1)$.
\begin{point}{40}{Proof}%
Given $f\equiv \lambda g_1 + \lambda^\perp g_2$
where~$\lambda\in(0,1)$ 
and~$g_1,g_2\colon \scrA\to\scrB$
are ncp-maps with $g_i(1)=f(1)$,
we must show that~$f=g_1=g_2$.
Note that for every projection~$s$
of~$\scrA$
we have~$f^\diamond(s) = (\lambda g_1+\lambda^\perp g_2)^\diamond(s)
= g_1^\diamond(s)\cup g_2^\diamond(s)$
by~\sref{diamond-sum} and~\sref{equivalent-examples};
and in particular~$g_1^\diamond(s)\leq f^\diamond(s)$.
Then for $h:=\lambda  g_1 + \lambda^\perp f$
we have $h(1)=f(1)$
and~$h^\diamond(s) = g_1^\diamond(s)\cup f^\diamond(s)
= f^\diamond(s)$,
so that~$\lambda g_1 + \lambda^\perp f \equiv 
h=f = \lambda g_1 +\lambda^\perp g_2$ by rigidity of~$f$;
and thus~$f=g_2$.
Similarly, $f=g_1$.\qed%
\end{point}
\end{point}
\begin{point}{50}[nmiu-rigid]{Proposition}%
A nmiu-map $\varrho\colon \scrA\to\scrB$
between von Neumann algebras is rigid.
\begin{point}{60}{Proof}%
Let~$g\colon \scrA\to\scrB$
be an ncpu-map
with~$\ceil{\varrho(p)}=\ceil{g(p)}$
for every projection~$p$ of~$\scrA$.
To show that~$\varrho$ is rigid,
we must show that~$g=\varrho$,
and for this, it suffices to prove that $g(p)=\varrho(p)$
for every projection~$p$ of~$\scrA$.
To this end, we'll show that~$g$ is multiplicative,
because then~$g$ maps projections to projections,
so that $g(p)=\ceil{g(p)}=\ceil{\varrho(p)}=\varrho(p)$
for every projection~$p$ of~$\scrA$.
We'll show that $g$ is multiplicative
using~\sref{gardner}
by proving that
$\ceil{g(p)}\ceil{g(q)}=0$
for projections $p$ and~$q$ of~$\scrA$
with~$pq=0$.
Indeed,
$\ceil{g(p)}\ceil{g(q)}=\ceil{\varrho(p)}\ceil{\varrho(q)}
=\varrho(p)\varrho(q)=\varrho(pq)=\varrho(0)=0$.\qed
\end{point}
\end{point}
\begin{point}{70}[canonical-quotient-rigid]{Lemma}%
Given an element~$b$ of a von Neumann algebra~$\scrA$
the ncp-map $a\mapsto b^* a b,\ \ceilr{b}\!\scrA\!\ceilr{b}\to\scrA$
is rigid.
\begin{point}{80}{Proof}%
Let~$g\colon \ceilr{b}\!\scrA\!\ceilr{b}\to\scrA$
be an ncp-map with~$g(1)=b^*b$
and $\ceil{b^*pb}=\ceil{g(p)}$ for every projection~$p$ 
of $\ceilr{b}\!\scrA\!\ceilr{b}$.
To prove that~$c:=b^*(\,\cdot\,) b
\colon \ceilr{b}\!\scrA\!\ceilr{b}\to \scrA$ is rigid,
we must show that~$g=c$.
Since~$c$ is a filter
(by~\sref{canonical-filter})
and~$g(1)=b^*b$
there is a unique ncp-map~$h\colon \ceilr{b}\!\scrA\!\ceilr{b}
\to\ceilr{b}\!\scrA\!\ceilr{b}$
with~$g=c\circ h$.
Our task then is to show that~$h=\id$,
and for this it suffices to show that,
for all~$a\in\ceilr{b}\!\scrA\!\ceilr{b}$,
\begin{equation}
\label{filter-rigid-1}
e_n\, h(\,e_n\, a\, e_n\,)\, e_n
\ = \ e_n \, a\,  e_n
\end{equation}
for some sequence of projections $e_1,e_2,\dotsc$
of~$\ceilr{b}\!\scrA\!\ceilr{b}$
that converges ultrastrongly to~$\ceilr{b}$,
because by~\sref{mult-jus-cont} the left-hand side of the equation above 
converges ultrastrongly to~$g(a)$,
while the right-hand side converges ultrastrongly to~$a$.
We'll take $e_N := \sum_{n=1}^N \ceill{t_n}$,
where~$t_1,t_2,\dotsc$
is an approximate pseudoinverse for~$b$,
because $\ceilr{b} = \sum_n\ceill{t_n}$.

Since the identity on~$e_n \scrA e_n$ is rigid
by~\sref{nmiu-rigid},
it suffices (for~\eqref{filter-rigid-1})
to show that 
$e_n h(e_n) e_n = e_n$
and 
$\ceil{e_nh(p)e_n} = p$
for every projection $p$ from $e_n\scrA e_n$.
Writing~$s_N:=\sum_{n=1}^N t_n$,
we have $bs_n = e_n$,
and so
$
\ceil{e_n h(p) e_n}
=
\ceil{s_n^* b^* h(p) b s_n}
=
\ceil{s_n^*g(p) s_n}
=
\ceil{s_n^* \ceil{g(p)} s_n}
=
\ceil{s_n^* \ceil{b^* p b} s_n}
=
\ceil{s_n^* b^* p b s_n}
=
\ceil{e_n p e_n }
$
for every 
projection~$p$ from~$\ceilr{b}\!\scrA\!\ceilr{b}$.
In particular, $\ceil{e_n h(p)e_n} = p$
when~$p$ is from~$e_n \scrA e_n$;
and we see $\ceil{e_n h(e_n^\perp) e_n}=\ceil{e_n e_n^\perp e_n}=0$
when we take~$p=e_n^\perp$,
so that~$e_n h(e_n^\perp) e_n =0$,
which yields $e_nh(e_n)e_n = e_n$.\qed
\end{point}
\end{point}
\begin{point}{90}[pure-is-rigid]{Theorem}%
\index{pure map!is rigid}
Every pure map between von Neumann algebras is rigid.
\begin{point}{100}{Proof}%
Let~$f\colon \scrA\to\scrB$ be a pure map between von Neumann algebras,
and let~$g\colon \scrA\to\scrB$ be an ncp-map
with $f(1)=g(1)$
and $f^\diamond = g^\diamond$.
To show that~$f$
is rigid,
we must prove that~$f=g$.
We know by~\sref{square-f}
that $f$ can be written as $f\equiv c_{f(1)} \circ [f]\circ \pi_{\ceil{f}}$,
and that~$c_{f(1)}$ is rigid,
by~\sref{canonical-quotient-rigid},
which we'll use shortly.
To this end,
note that since~$f^\diamond = g^\diamond$,
we have $f_\diamond = g_\diamond$,
and so $\ceil{f}=f_\diamond(1)=g_\diamond(1)=\ceil{g}$.
As~$\pi_{\ceil{f}}$ is a corner of~$\ceil{f}=\ceil{g}$,
there is a unique ncp-map $h\colon \ceil{f}\!\scrA\!\ceil{f}\to\scrB$
with $h\circ \pi_{\ceil{f}} =g$. 
Since then
$h^\diamond \circ \pi_{\ceil{f}}^\diamond
= g^\diamond = f^\diamond 
= c_{f(1)}^\diamond
\circ [f]^\diamond \circ \pi_{\ceil{f}}^\diamond$,
 and $\pi_{\ceil{f}}^\diamond$ is clearly surjective,
we get~$h^\diamond = c_{f(1)}^\diamond\circ [f]^\diamond$,
and thus  $(h\circ [f]^{-1})^\diamond = c_{f(1)}^\diamond$,
using here that~$[f]$ is invertible,
because~$f$ is pure.
Now,
using that~$c_{f(1)}$
is rigid,
and $h([f]^{-1}(1))=h(1)=h(\pi_{\ceil{f}}(1))=g(1)=f(1)=c_{f(1)}(1)$,
we get~$h\circ [f]^{-1}=c_{f(1)}$,
which yields
$g=h\circ \pi_{\ceil{f}} 
=h\circ [f]^{-1}\circ [f]\circ \pi_{\ceil{f}}
= c_{f(1)} \circ [f] \circ \pi_{\ceil{f}} = f$,
and thus~$f$ is rigid.\qed
\end{point}
\end{point}
\end{parsec}
\subsection{\texorpdfstring{$\diamond$-P}{Diamond p}ositivity}
\begin{parsec}{1030}%
\begin{point}{10}{Definition}%
We'll call an ncp-map $f\colon \scrA\to\scrA$
between von Neumann algebras
\begin{enumerate}
\item
\Define{$\diamond$-self-adjoint}%
\index{$\diamond$-self-adjoint}
if~$f$ is pure and contraposed to itself
($f^\diamond = f_\diamond$), and
\item
\Define{$\diamond$-positive}%
\index{$\diamond$-positive}
if~$f\equiv gg$
for some $\diamond$-self-adjoint map
$g\colon \scrA\to\scrA$.
\end{enumerate}
We added ``$\diamond$-'' to ``positive''
not only to distinguish it from 
the pre-existing notion of positivity for maps between $C^*$-algebras,
but also to contrast it with
	the notion of ``$\dagger$-positivity''
	that appears in the following thesis (see~\sref{dagger-effectus}).
\end{point}
\begin{point}{20}[purely-positive-examples]{Examples}%
Let~$\scrA$ be a von Neumann algebra.
\begin{enumerate}
\item
Given~$a\in\Real{\scrA}$ the map~$a(\,\cdot\,)a\colon \scrA\to\scrA$ is 
$\diamond$-self-adjoint.
\item
Given~$a\in\scrA_+$
the map $a(\,\cdot\,)a\colon \scrA\to\scrA$
is $\diamond$-positive.
\end{enumerate}
\spacingfix
\end{point}%
\begin{point}{30}[purely-positive-basic]{Exercise}%
Let~$f\colon \scrA\to\scrA$
be an ncp-map,
where~$\scrA$ is a von Neumann algebra.
\begin{enumerate}
\item
Show that~$\ceil{f}=\ceil{f(1)}$ when~$f$
is  $\diamond$-self-adjoint.
\item
Assuming~$f$ is $\diamond$-self-adjoint,
show that~$ff$ is $\diamond$-self-adjoint,
and show that~$\ceil{ff}=\ceil{f}$ (cf.~\sref{carrier-f-dagger-f}).
\item
Show that~$f$ is $\diamond$-self-adjoint
when~$f$ is $\diamond$-positive.
\end{enumerate}
\spacingfix%
\end{point}
\end{parsec}
\begin{parsec}{1040}%
\begin{point}{10}%
We now turn 
	to the question
	roughly speaking 
to what extent a filter~$c$ is determined by
its action~$c^\diamond\colon e\mapsto \ceil{c(e)}$ on projections;
we will see (essentially in~\sref{positive-quotients-centrally-similar})
that two filters $c_1$ and~$c_2$
are equivalent, $c_1^\diamond = c_2^\diamond$,
if and only if~$c_1(1)$ and~$c_2(1)$
are equal up to some central elements,
that is, \emph{centrally similar}.
\end{point}
\begin{point}{20}{Definition}%
We say that positive elements $p$ and~$q$ of a von Neumann algebra~$\scrA$
are \Define{centrally similar}
if~$cp=dq$ for some positive central elements~$c$ and~$d$ of~$\scrA$
with~$\ceil{p}\leq \ceil{c}$
and~$\ceil{q}\leq \ceil{d}$.
\end{point}
\begin{point}{30}[centrally-similar-basic]{Exercise}%
Let~$p$ and~$q$ be positive elements
of a von Neumann algebra~$\scrA$.
\begin{enumerate}
\item
Show that when~$p$ and~$q$ are centrally similar,
every element~$a$ of~$\scrA$ that commutes
with~$p$ commutes with~$q$ too;
and in particular, $pq=qp$.
\item
Show that when~$p$ and~$q$ are centrally similar,
$\ceil{p}=\ceil{q}$.
\item[2a.]
Assuming that $p\leq Bq$ for some $B\in [0,\infty)$,
show that~$p$ and~$q$ are centrally similar iff $p/q$ is central.

Show that~$p$ is centrally similar to~$1$ iff~$p$ is central.

Show that~$p$ is centrally similar to~$p^2$ iff~$p$ is central.
\item
Show that when~$p$ and~$q$ commute,
and both $\frac{p\wedge q}{p}$ 
and~$\frac{p\wedge q}{q}$
are central,
$p$ and~$q$ are centrally similar.
\item
Show that when~$p$ and~$q$ are pseudoinvertible,
then:
$p$ and~$q$ are centrally similar iff
$pq^{\sim 1}$ is central
iff $qp^{\sim 1}$ is central
iff both $(p\wedge q)p^{\sim 1}$
and~$(p\wedge q)q^{\sim 1}$ are central.
\item
Assuming that $p$ and~$q$ commute
and $e_1 \leq e_2 \leq \dotsb$
are projections commuting with~$p$ and~$q$
with~$\bigcup_n e_n=\ceil{p}$
such that the~$e_np$ and~$e_nq$
are pseudoinvertible,
and centrally similar,
show that $p$ and~$q$ are centrally similar
on the 
grounds that both  $\frac{p\wedge q}{p}$
and~$\frac{p\wedge q}{q}$ are central.

(Hint:
$\smash{e_n \frac{p\wedge q}{p} = \frac{(e_np)\wedge(e_nq)}{e_np}}$
are central,
and
converge ultraweakly to $\frac{p\wedge q}{p}$.)
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{40}[centrally-similar-fundamental]{Lemma}%
Suppose that $\ceil{q \, \vartheta(e)\, q}\leq e$
and~$\ceil{q \,\vartheta(e^\perp)\, q} \leq e^\perp$,
where~$e$ is a projection of a von Neumann algebra~$\scrA$,
$q$ is a positive element of~$\scrA$,
and~$\vartheta\colon \scrA\to\scrA$ is an miu-map.
Then~$eq=qe$ and~$\vartheta(e)=e$.
\begin{point}{50}{Proof}%
We have $\vartheta(e)qe=\vartheta(e)q$,
because~$e\geq  \ceil{q\,\vartheta(e)\,q}
\equiv \ceill{\vartheta(e)q}$ (see~\sref{ceill-basic}).
Similarly, $\vartheta(e^\perp)qe^\perp = \vartheta(e^\perp)q$,
because $e^\perp \geq \ceil{q\,\vartheta(e^\perp)\,q}
\equiv \ceill{\vartheta(e^\perp)q}$,
and so~$\vartheta(e^\perp)qe=0$,
which implies $\vartheta(e)qe=qe$.
Thus~$qe=\vartheta(e)qe=\vartheta(e)q$,
and so $q^2e=q\vartheta(e)q$ is self-adjoint,
which gives us that $q^2e=(q^2e)^*=eq^2$.
Since~$q^2$ commutes with~$e$,
$q=\smash{\sqrt{q^2}}$ commutes
with~$e$ too (see~\sref{sqrt}).
Finally, $\vartheta(e)q=qe=eq$
and~$\ceil{q}=1$
imply that~$\vartheta(e)=e$ by~\sref{mult-cancellation}.\qed
\end{point}
\end{point}
\begin{point}{60}[centrally-similar-corollary]{Corollary}%
A positive element~$q$
of a von Neumann algebra~$\scrA$
with~$\ceil{q}=1$
is central provided
there is an miu-map~$\vartheta\colon \scrA\to\scrA$
with $\ceil{q\,\vartheta(e)\,q}\leq e$
for every projection~$e$ from~$\scrA$;
and in that case~$\vartheta=\id$.
\end{point}
\begin{point}{70}[positive-quotients-centrally-similar]{Proposition}%
Positive elements~$p$ and~$q$
of a von Neumann algebra~$\scrA$
with~$\ceil{p}=\ceil{q}=1$
are centrally similar 
when there is an miu-isomorphism
$\vartheta\colon \scrA\to\scrA$
with~$\ceil{pep}=\ceil{q\,\vartheta(e)\,q}$
for all projections~$e$ of~$\scrA$;
and in that case  $\vartheta=\id$.
\begin{point}{80}{Proof}%
Let~$e$ be a projection from~$\scrA$ with~$ep=pe$.
Since~$1=\ceil{p}=\ceil{\smash{p^2}}$
we have $e=\ceil{e\ceil{\smash{p^2}}e}
=\ceil{e\smash{p^2} e}=\ceil{pep}=\ceil{q\,\vartheta(e)\,q}$.
Since~$e^\perp$ commutes with~$p$ too,
we get~$e^\perp = \ceil{\smash{q\,\vartheta(e^\perp)\,q}}$
by the same token;
and thus~$eq=qe$ and~$\vartheta(e)=e$ 
by~\sref{centrally-similar-fundamental}.
Since~$p$ is the norm limit
of linear combinations of such projections~$e$,
we get $pq=qp$ and~$\vartheta(p)=p$.

Since~$p$ and~$q$ commute,
we can find a sequence
of projections~$e_1\leq e_2 \leq \dotsb$
that commute with~$p$ and~$q$
with~$\bigcup_n e_n =\ceil{p}$
and such that $pe_n$ and~$qe_n$
are pseudoinvertible --- one may,
for example,
take $e_N:=\sum_{n=1}^N \ceil{t_n}$
where~$t_1,t_2,\dotsc$
is an approximate pseudoinverse
of~$p\wedge q$ (see~\sref{approximate-pseudoinverse}).
Note that to prove that~$p$ and~$q$ are centrally similar,
it suffices to show that $pe_n$ and~$qe_n$ are centrally similar,
by~\sref{centrally-similar-basic}.
Further, to prove that~$\vartheta(a)=a$
for some~$a\in\scrA$,
it suffices to show that~$\vartheta( e_n a e_n  ) = e_n a e_n$,
because $e_n a e_n$ converges ultrastrongly to~$a$
	by~\sref{mult-jus-cont}.
Note that~$\vartheta(e_n)=e_n$,
because~$e_np=pe_n$,
and so~$\vartheta$ maps~$e_n\scrA e_n$ into~$e_n \scrA e_n$.

Thus, by considering~$e_n \scrA e_n$ 
instead of~$\scrA$,
and the restriction of~$\vartheta$ to~$e_n\scrA e_n$
instead of~$\vartheta$,
and~$pe_n$ and~$qe_n$
instead of~$p$ and~$q$,
we reduce the problem to the case that~$p$ and~$q$ are invertible;
and so we may assume without loss of generality that~$p$ and~$q$
are invertible to start with.
Given a projection~$e$ from~$\scrA$
we have $\ceil{p^{-1}q \,\vartheta(e)\, q p^{-1}}
= \ceil{p^{-1}\ceil{q\,\vartheta(e)\,q}p^{-1}}
= \ceil{p^{-1}\ceil{pep}p^{-1}}=e$;
so 
by~\sref{centrally-similar-corollary},
we get that
$\vartheta=\id$
and
$p^{-1}q$ is central;
and so
$p$ and~$q$ are centrally similar (by~\sref{centrally-similar-basic}).
\qed
\end{point}
\end{point}
\begin{point}{90}[faithful-positive-map-uniqueness]{Proposition}%
A faithful $\diamond$-positive map $f\colon \scrA\to\scrA$
on a von Neumann algebra~$\scrA$
is of the form~$f=\sqrt{p}(\,\cdot\,)\sqrt{p}$
where $p:=f(1)$.
\begin{point}{100}{Proof}%
Note that~$f$,
being faithful and pure,
is a filter
(by~\sref{special-pure-maps}),
and thus of the form $f\equiv \sqrt{p}\,\vartheta(\,\cdot\,)\,\sqrt{p}$
for some isomorphism~$\vartheta\colon \scrA\to\scrA$.
Our task then is to show that~$\vartheta=\id$,
and for this
it suffices, by~\sref{positive-quotients-centrally-similar},
to find some positive~$q$ in~$\scrA$ with~$\ceil{q}=1$
and~$f^\diamond(e)\equiv\ceil{\sqrt{p}\,\vartheta(e)\,\sqrt{p}}
= \ceil{qeq}$ for all projections~$e$ in~$\scrA$.

Since~$f$ is $\diamond$-positive,
we have~$f\equiv \xi \xi$ for some $\diamond$-self-adjoint
map~$\xi\colon \scrA\to\scrA$.
Since~$1=\ceil{f}=f_\diamond(1)=
\xi_\diamond(\xi_\diamond(1))\leq \xi_\diamond(1)=\ceil{\xi}$
we have~$\ceil{\xi}=1$,
and so, $\xi$, being pure and faithful,
is a filter (by~\sref{special-pure-maps}).
Furthermore,
as~$\tilde\xi:=\sqrt{\xi(1)}(\,\cdot\,)\sqrt{\xi(1)}\colon \scrA\to\scrA$
is a filter of~$\xi(1)$ too,
there is an isomorphism~$\alpha\colon \scrA\to\scrA$
with $\xi=\tilde\xi\alpha$.
Now, $ {\tilde\xi}^\diamond \alpha^\diamond
={\xi}^\diamond={\xi}_\diamond
=\alpha_\diamond\tilde \xi_\diamond
= (\alpha^\diamond)^{-1}{\tilde\xi}^\diamond$
implies~${\tilde\xi}^\diamond = \alpha^\diamond 
{\tilde \xi}^\diamond \alpha^\diamond$,
and 
$f^\diamond= (\xi\xi)^\diamond
= {\tilde \xi}^\diamond\alpha^\diamond{\tilde \xi}^\diamond\alpha^\diamond
={\tilde \xi}^\diamond{\tilde \xi}^\diamond=(\tilde \xi\tilde \xi)^\diamond$.
In other words,
$\ceil{\sqrt{p}\,\vartheta(e)\,\sqrt{p}}
=f^\diamond(e)=(\tilde\xi\tilde\xi)^\diamond(e)
= \ceil{\xi(1)\,e\,\xi(1)}$
for all projections~$e$ of~$\scrA$,
which implies that~$\vartheta=\id$
by~\sref{positive-quotients-centrally-similar},
and hence that~$f=\sqrt{p}\,(\,\cdot\,)\,\sqrt{p}$.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}{1050}%
\begin{point}{10}%
To strip 
from~\sref{faithful-positive-map-uniqueness}
the assumption 
that~$f$
be faithful 
we employ this device:
\end{point}
\begin{point}{20}[chevron-f]{Definition}%
Given an ncp-map $f\colon \scrA\to\scrB$
between von Neumann algebras
we denote by
$\Define{\left<f\right>}\colon \ceil{f}\!\scrA\!\ceil{f}
\to \ceil{f(1)}\!\scrB\!\ceil{f(1)}$%
\index{*diamondf@$\left<f\right>$}
the unique ncp-map
such that 
\begin{equation*}
\xymatrix@C=6em{
\scrA
\ar[r]^f
\ar[d]_{\pi_{\ceil{f}}}
&
\scrB
\\
\ceil{f}\!\scrA\!\ceil{f}
\ar[r]^{\left<f\right>}
&
\ceil{f(1)}\!\scrB\!\ceil{f(1)}
\ar[u]_{c_{\ceil{f(1)}}}
}
\end{equation*}
commutes.
(Compare this with the definition of~$[f]$ in~\sref{square-f}.)
\end{point}
\begin{point}{30}[chevron-f-basic]{Exercise}%
Let~$f\colon \scrA\to\scrB$ be an ncp-map.
\begin{enumerate}
\item
Show that~$\left<f\right>
= \pi_{\ceil{f(1)}}\circ f \circ c_{\ceil{f}}$
(using, perhaps, that $\pi_{\ceil{f}}\circ c_{\ceil{f}}=\id$).
\item
Show that
$\left<f\right> = \pi_{\ceil{f(1)}} \circ c_{f(1)}\circ [f]$.

(Thus $\left<f\right>\!(a) = 
\sqrt{f(1)}\ [f]\!(a)\ \sqrt{f(1)}$
for all $a$ from~$\ceil{f}\!\scrA\!\ceil{f}$.)
\item
Show that~$\left<f\right>$
is faithful,
and~$\left<f\right>\!(1)=f(1)$.
\item
Assuming that~$f$ is pure,
show that~$\left<f\right>$ is pure,
and hence a filter (by~\sref{special-pure-maps}).
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{40}[chevron-f-purely-positive]{Exercise}%
Let~$f\colon \scrA\to\scrA$
be an ncp-map, where~$\scrA$ is a von Neumann algebra.
\begin{enumerate}
\item
Suppose that~$f$ is $\diamond$-self-adjoint.

Recall that~$\ceil{f}=\ceil{f(1)}$,
and so $\left<f\right>\colon \ceil{f}\!\scrA\!\ceil{f}
\to \ceil{f}\!\scrA\!\ceil{f}$.

Prove that~$\left<f\right>$
is $\diamond$-self-adjoint.
\item
Suppose again that~$f$ is $\diamond$-self-adjoint,
and recall from~\sref{purely-positive-basic} that $f^2$
is $\diamond$-self-adjoint, and~$\ceil{f^2} = \ceil{f}$.
Show that $\left<f^2\right> = \left<f\right>^2$.
\item
Assuming that~$f$ is $\diamond$-positive,
show that~$\left<f\right>$ is $\diamond$-positive.
\end{enumerate}
\spacingfix
\end{point}%
\begin{point}{50}[positive-map-uniqueness]{Theorem}%
Given a positive element~$p$ of a von Neumann algebra~$\scrA$
there is a unique $\diamond$-positive map $f\colon \scrA\to\scrA$
with~$f(1)=p$,
namely~$f=\sqrt{p}(\,\cdot\,)\sqrt{p}$.
\begin{point}{60}{Proof}%
We've already seen in~\sref{purely-positive-examples}
that $f=\sqrt{p}(\,\cdot\,)\sqrt{p}\colon \scrA\to\scrA$
is a $\diamond$-positive map with~$f(1)=p$.
Concerning uniqueness,
(given arbitrary~$f$)
the map~$\left<f\right>\colon \ceil{p}\!\scrA\!\ceil{p}
\to \ceil{p}\!\scrA\!\ceil{p}$
from~\sref{chevron-f}
is $\diamond$-positive by~\sref{chevron-f-purely-positive},
and faithful by~\sref{chevron-f-basic},
and so of the form
$\left<f\right>=\sqrt{p}(\,\cdot\,)\sqrt{p}$
by~\sref{faithful-positive-map-uniqueness}
(since~$\left<f\right>\!(1)=f(1)=p$);
implying that
$f= c_{\ceil{p}}\circ\left<f\right>\circ \pi_{\ceil{p}}
= \sqrt{p}\ceil{p}(\,\cdot\,)\ceil{p}\sqrt{p}
= \sqrt{p}(\,\cdot\,)\sqrt{p}$.\qed
\end{point}
\end{point}
\begin{point}{70}[sqrt-axiom]{Corollary (``Square Root Axiom'')}%
\index{square root axiom}
Given a positive element~$p$ of a von Neumann algebra~$\scrA$
there is a unique $\diamond$-positive map~$g\colon \scrA\to\scrA$
with~$g(g(1))=p$, namely
$g=\sqrt[4]{p}\,(\,\cdot\,)\,\sqrt[4]{p}$.
\begin{point}{80}{Proof}%
Any $\diamond$-positive map~$g\colon \scrA\to\scrA$ with~$g(g(1))=p$
will be of the form
$g=\smash{\sqrt{g(1)}\,(\,\cdot\,)\,\sqrt{g(1)}}$
by~\sref{positive-map-uniqueness};
so that~$p=g(g(1))=g(1)^2$
implies that~$g(1)=\sqrt{p}$
by~\sref{sqrt},
thereby giving~$g=\sqrt[4]{p}\,(\,\cdot\,)\,\sqrt[4]{p}$.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}{1060}%
\begin{point}{10}[uniqueness-sequential-product]{Theorem}%
\index{sequential product}
On the effects of every von Neumann algebra~$\scrA$
there is a unique binary operation~$\ast$
such that for all~$p$ from~$[0,1]_\scrA$,
\begin{enumerate}[A.]
\item \label{ax1}
$p\ast 1 = p$,
\item
	\label{ax2}
$p\ast q = f(q)$
for all~$q$ from~$[0,1]_\scrA$
for some pure map~$f\colon \scrA\to\scrA$,
\item\label{ax3}
$p\ast (p\ast q)=(p\ast p)\ast q$
for all~$q$ from $[0,1]_\scrA$,
\item\label{ax4}
$p=q\ast q$ for some~$q$ from~$[0,1]_\scrA$,
\item\label{ax5}
$p \ast e_1 \leq e_2^\perp
\iff p\ast e_2 \leq e_1^\perp$
for all projections~$e_1,e_2$ from~$\scrA$;
\end{enumerate}
namely, the sequential product,
given by
$p\ast q = \sqrt{p}q\sqrt{p}$
for all~$p, q$ from~$[0,1]_\scrA$.
\begin{point}{20}{Proof}%
Let~$p$  from $[0,1]_\scrA$ be given.
Pick~$p'$ from~$[0,1]_\scrA$
with $p = p'\ast p'$
using~\ref{ax4},
and find a pure map~$f\colon \scrA\to\scrA$
with~$f(q)=p'\ast q$ for all~$q$ from $[0,1]_\scrA$
using~\ref{ax2}.
Then~$f$ is $\diamond$-self-adjoint by~\ref{ax5},
and so~$ff$ is $\diamond$-positive.
Since~$f(f(1))=p'\ast (p'\ast 1)
= p'\ast p'=p$ by~\ref{ax1},
$ff=\sqrt{p}(\,\cdot\,)\sqrt{p}$
by~\sref{positive-map-uniqueness},
so $p\ast q
= (p'\ast p')\ast q
= p'\ast (p' \ast q) = f(f(q))=\sqrt{p}q\sqrt{p}$
for all~$q\in [0,1]_\scrA$ by~\ref{ax3}.\qed
\end{point}
\end{point}
\begin{point}{30}{Exercise}%
None of the axioms
from~\sref{uniqueness-sequential-product}
may be omitted (except perhaps~\ref{ax4},
see~\sref{fourth-axiom}):
\begin{enumerate}
\item
Show that
$p\ast q := \ceil{p}q\ceil{p}$
satisfies all axioms of~\sref{uniqueness-sequential-product}
except~\ref{ax1}.
\item
Show that  $p\ast q := \floor{p}q\floor{p}\ +\ \smash{\sqrt{p-\floor{p}}\,q\,
\sqrt{p-\floor{p}}}$
satisfies all axioms except~\ref{ax2}.
\item
Show that if for every effect~$p$ of~$\scrA$
we pick a unitary~$u_p$ from~$\ceil{p}\!\scrA\!\ceil{p}$
then~$\ast$ given by
$p\ast q= \sqrt{p}u_p^* \,q\, u_p\sqrt{p}$
satisfies~\ref{ax1} and~\ref{ax2}.

Show that this~$\ast$ obeys~\ref{ax3} when~$u_p^2=u_{p^2}$,
and~\ref{ax4} when $pu_p=u_p p$,
and~\ref{ax5} when~$u_p^*=u_p$.

Conclude that when $u_p$ is defined by $u_p:=g(p)$,
where~$g\colon [0,1]\to\{-1,1\}$
is any Borel function with $g(\nicefrac{2}{3})=1$
and~$g(\nicefrac{4}{9})=-1$
the operation~$\ast$ (defined by~$u_p$ as above) satisfies
all conditions of~\sref{uniqueness-sequential-product} except~\ref{ax3}.
\item
Show that there is a Borel
function~$g\colon[0,1]\to S^1$
with $g(\nicefrac{1}{2})\neq 1$
and~$g(\lambda^2)=g(\lambda)^2$ for all~$\lambda\in [0,1]$,
and that~$\ast$ given by~$p\ast q = \sqrt{p} g(p)^* \,q \,g(p)\sqrt{p}$
satisfies all conditions of~\sref{uniqueness-sequential-product}
except~\ref{ax5}.
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{40}[fourth-axiom]{Problem}%
Is there a binary operation~$\ast$
on the effects~$[0,1]_\scrA$
of a von Neumann algebra~$\scrA$
that satisfies all axioms of~\sref{uniqueness-sequential-product}
except~\sref{ax4}?
\end{point}
\begin{point}{50}{Remark}%
The axioms for the sequential product
(on a single von Neumann algebra)
presented here (in~\sref{uniqueness-sequential-product})
evolved
from the following axioms for all
sequential products
on von Neumann algebras
$(\ast_\scrA)_\scrA$
we previously published in~\cite{westerbaan2016universal}.
\begin{enumerate}
\item[Ax.1]%
For every effect~$p$ of a von Neumann algebra~$\scrA$
there is a filter $c\colon \scrC\to\scrA$ of~$p$
and a corner~$\pi\colon \scrA\to\scrC$
		of~$\floor{p}$ with~$p\ast_\scrA q = c(\pi(q))$
		for all $q\in[0,1]_\scrA$.
\item[Ax.2]%
$p\ast_\scrA(p\ast_\scrA q)= (p \ast_\scrA p )\ast_\scrA q$
for all effects~$p$ and~$q$ from a von Neumann algebra~$\scrA$.
\item[Ax.3]%
$f(p\ast_\scrA q)= f(p)\ast_\scrB f(q)$
for every nmisu-map $f\colon \scrA\to\scrB$
between von Neumann algebras
and all effects~$p$ and~$q$ from~$\scrA$.
\item[Ax.4]%
$p\ast_\scrA e_1 \leq e_2^\perp
\iff p\ast_\scrA e_2 \leq e_1^\perp$
for every effect~$p$ from a von Neumann algebra~$\scrA$
and projections $e_1$ and~$e_2$ from~$\scrA$.
\end{enumerate}
Note that~Ax.2 and Ax.4 are mutatis mutandis 
the same as axioms~C and~E, respectively,
and Ax.1 is essentially the same as the combination 
of axioms~A and~B.
In other words,
we managed to get rid of~Ax.3---and with it
the need to axiomatise all sequential products simultaneously---at
the slight cost of adding axiom~D,
though that one might be superfluous as well
	(see~\sref{fourth-axiom}).

We refer to \S{}VI of~\cite{westerbaan2016universal}
for comments on the relation
of our axioms
	with those of Gudder 
	and Lat\'emoli\`ere\cite{gudder2008characterization}
and for some more pointers to the literature.
\end{point}
\end{parsec}


\section{Tensor product}
\label{S:tensor}
\begin{parsec}{1070}%
\begin{point}{10}%
The tensor
product of von Neumann algebras~$\scrA$
and~$\scrB$
represented on Hilbert spaces~$\scrH$ and~$\scrK$,
respectively,
is usually defined as the von Neumann subalgebra
of~$\scrB(\scrH\otimes\scrK)$
generated by the operators
on~$\scrH\otimes\scrK$
of the form~$A\otimes B$ where~$A\in\scrA$
and~$B\in\scrB$.
In line with the representation-avoiding
treatment of von Neumann algebras
from the previous chapter
we'll take an entirely different
approach
by defining the tensor product of von Neumann
algebras $\scrA$ and~$\scrB$ abstractly 
as an miu-bilinear map $\otimes\colon \scrA\times\scrB\to\scrA\otimes\scrB$
whose range generates~$\scrA\otimes\scrB$
and admits sufficiently many product functionals (see~\sref{tensor});
we'll only resort to the concrete representation
of the tensor product  mentioned above to show that 
such an abstract tensor product actually exists (see~\sref{special-tensor}).

Moreover, we'll show that the tensor product has a universal
property~\sref{tensor-universal-property}
yielding bifunctors on~$\W{cpsu}$
and~$\W{miu}$ (see~\sref{tensor-functor})
turning them into a monoidal categories
(see~\sref{vn-smc}).
In the next chapter,
    we'll see that~$\op{(\W{miu})}$ is even
monoidal closed (see~\sref{tensor-closed}).
This fact is one ingredient of our model for the quantum lambda calculus
from~\cite{model}
built of von Neumann algebras,
but more of that later.
\end{point}
\end{parsec}
\subsection{Definition}
\begin{parsec}{1080}%
\begin{point}{10}[bilinear-basic]{Definition}%
A bilinear map
	$\beta\colon \scrA\times \scrB\to\scrC$
between von Neumann algebras is
\begin{enumerate}
\item
\Define{\textbf{u}nital}%
\index{unital!bilinear map}
when~$\beta(1,1)=1$,
\item
\Define{\textbf{m}ultiplicative}%
\index{multiplicative!bilinear map}
if~$\beta(ab,cd)=\beta(a,c)\beta(b,d)$
for all~$a,b\in\scrA$, $c,d\in\scrB$,
\item
\Define{\textbf{i}nvolution preserving}
\index{involution preserving!bilinear map}
if~$\beta(a,b)^*=\beta(a^*,b^*)$
for all~$a\in\scrA$, $b\in\scrB$.
\item
(This list is extended in~\sref{tensor-extra}.)
\end{enumerate}
We abbreviate these properties as in~\sref{maps},
and say, for instance, that $\beta$ is \Define{miu-bilinear}%
\index{miu-bilinear}
when it is unital, multiplicative and involution preserving.

\end{point}
\begin{point}{20}[tensor]{Definition}%
A miu-bilinear map $\gamma\colon \scrA\times\scrB\to\scrT$
between von Neumann algebras
is a \Define{tensor product}%
\index{tensor product!of von Neumann algebras}
of~$\scrA$ and~$\scrB$
when it obeys the following three conditions.
\begin{enumerate}
\item
\label{tensor-1}
The range of~$\gamma$ generates~$\scrT$
(which  means in this case that the linear span
of the range of~$\gamma$ is ultraweakly dense in~$\scrT$.)

This implies
that for all $f \in \scrA_*$
and $g\in \scrB_*$
there is at most one $h\in \scrT_*$
with, for all~$a\in\scrA$ and $b\in\scrB$,
\begin{equation*}
	h(\gamma(a,b))\ =\  f(a)\,g(b),
\end{equation*}
which we'll call the \Define{product functional}%
\index{product functional}
for~$f$ and~$g$,
and denote by~$\Define{\gamma(f,g)}$%
\index{*gammafg@$\gamma(f,g)$, product functional}
(when it exists).
\item
\label{tensor-2}
For all np-functionals
$\sigma\colon \scrA\to\C$
and $\tau\colon \scrB\to\C$
the product functional $\gamma(\sigma,\tau)\colon \scrT\to\C$
exists and is positive.
\item
\label{tensor-3}
The product functionals 
$\gamma(\sigma,\tau)$
of np-functionals~$\sigma$ and~$\tau$ form a faithful collection
of np-functionals on~$\scrT$.
\end{enumerate}
(We'll see a slightly different characterisation
of the tensor
in which not all product functionals of np-functionals
are required to exist upfront 
in~\sref{tensor-characterization}.)
\end{point}
\begin{point}{30}{Remark}%
This compact definition of the tensor product
leaves four questions unanswered:
whether such a tensor product of two von Neumann algebras
always exists,
whether it has some  universal property,
whether it is unique in some way,
and whether it coincides with the usual definition.
We'll shortly address all four questions.
\end{point}
\end{parsec}
\subsection{Existence}
\begin{parsec}{1090}%
\begin{point}{10}%
We'll start with the existence
of a tensor product of von Neumann algebras
for which we'll first need the tensor product
of Hilbert spaces.
\end{point}
\begin{point}{20}{Definition}%
We'll call a bilinear map $\gamma\colon \scrH\times\scrK\to\scrT$
between Hilbert spaces
a \Define{tensor product}%
\index{tensor product!of Hilbert spaces}
when it obeys the following two conditions.
\begin{enumerate}
\item
The linear span of the range of~$\gamma$ is dense in~$\scrT$.
\item
$\left<\gamma(x,y),\gamma(x',y')\right>
= \left<x,x'\right> \left<y,y'\right>$
for all~$x,x'\in\scrH$ and~$y,y'\in\scrK$.
\end{enumerate}
\spacingfix
\end{point}%
\begin{point}{30}{Exercise}%
\index{tensor product!of Hilbert spaces!exists}
We're going to prove that every pair of Hilbert
spaces~$\scrH$ and~$\scrK$ admits
a tensor product.
\begin{enumerate}
\item
Given sets~$X$ and~$Y$
show that  $\gamma\colon\ell^2(X)\times \ell^2(Y)\to \ell^2(X\times Y)$
given by
\begin{equation*}
	\gamma(f,g)\ = \ (\,f(x)\,g(y)\,)_{x\in X,y\in Y}
\end{equation*}
is a tensor product of~$\ell^2(X)$ and~$\ell^2(Y)$.
\item
Show that a subset~$\scrE$ of a Hilbert space~$\scrH$
is an orthonormal basis (see~\sref{orthonormal}) iff
the map $T\colon \ell^2(\scrE)\to\scrH$
given by~$T(x)=\sum_{e\in\scrE} x_e e$
is an isometric isomorphism.
\item
Show that any pair~$\scrH$ and~$\scrK$
of Hilbert spaces has a tensor product
(using the fact that every Hilbert space
has an orthonormal basis).
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{40}[hilb-tensor-basic]{Proposition}%
Let~$\gamma\colon \scrH\times\scrK\to\scrT$
be a tensor product
of Hilbert spaces.
\begin{enumerate}
\item
\label{hilb-tensor-basic-1}
We have $\|\gamma(x,y)\|=\|x\|\|y\|$
for all~$x\in\scrH$ and~$y\in\scrK$.
\item
\label{hilb-tensor-basic-2}
Given orthonormal bases~$\scrE$ and~$\scrF$
of~$\scrH$ and~$\scrK$, respectively,
the set
\begin{equation*}
	\scrG\,:=\,\{\,\gamma(e,f)\colon \,e\in \scrE,\,f\in\scrF\,\}
\end{equation*}
is an orthonormal basis for~$\scrT$.%
\end{enumerate}
\spacingfix%
\begin{point}{50}{Proof}%
\ref{hilb-tensor-basic-1}\ 
We have $\|\gamma(x,y)\|^2
= \left<\gamma(x,y),\gamma(x,y)\right>
=\left<x,x\right>\left<y,y\right>
= \|x\|^2\|y\|^2$.

\ref{hilb-tensor-basic-2}\ 
Since $\left<\gamma(e,e'),\gamma(f,f')\right>
=\left<e,e'\right>\left<f,f'\right>$
where~$e,e'\in \scrE$
and~$f,f'\in\scrF$,
the set~$\scrG$ is clearly orthonormal.
To see that~$\scrG$ is maximal (and thus a basis)
it suffices
to show that the span of~$\scrG$ 
is dense in~$\scrT$,
and for this it suffices
to show that each~$\gamma(x,y)$
where~$x\in\scrH$ and~$y\in\scrK$
is in the closure of the span of~$\scrG$.
Now,
since~$y=\sum_{f\in\scrF}\left<f,y\right> f$,
by~\sref{orthonormal}
and~$\left<x,(\,\cdot\,)\right>$
is bounded by~\ref{hilb-tensor-basic-1}
we have~$\gamma(x,y)= \sum_{f\in\scrF}
\left<y,f\right>\gamma(x,f)$.
Since similarly $\gamma(x,f)=\sum_{e\in\scrE} \left<e,x\right>\gamma(e,f)$ 
for all~$f\in\scrF$,
we see that~$\gamma(x,y)$
is indeed in the closure of the span of~$\scrG$.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}{1100}%
\begin{point}{10}{Definition}%
We'll say that a bilinear map $\beta\colon\scrH\times\scrK\to\scrL$
between Hilbert spaces
is \Define{$\ell^2$-bounded}%
\index{l2-bounded@$\ell^2$-bounded bilinear map}
by~$B\in [0,\infty)$
when
\begin{equation*}
	\|\sum_{i}\beta(x_i,y_i)\|^2
\leq B^2 \sum_{i,j}\left<x_i,x_j\right>\left<y_i,y_j\right>
\end{equation*}
for all~$x_1,\dotsc,x_n\in \scrH$
and~$y_1,\dotsc,y_n\in\scrK$.
\begin{point}{20}{Remark}%
We added the prefix ``$\ell^2$-''
to clearly distinguish
it from the boundedness
of (sesquilinear) forms from~\sref{chilb-form},
which one might call ``$\ell^\infty$-boundedness.''%
\index{linfty-bounded@$\ell^\infty$-bounded bilinear map}

This distinction is needed
since for example given a Hilbert space~$\scrH$ the
bilinear map $(f,x)\mapsto f(x)\colon \scrH^*\times \scrH\to\C$
is always $\ell^\infty$-bounded in the 
sense that~$\left|f(x)\right|\leq \|f\|\|x\|$
for all~$f\in\scrH^*$ and~$x\in\scrH$,
but it is not~$\ell^2$-bounded
when~$\scrH$ is infinite dimensional
\end{point}
\end{point}
\begin{point}{30}[hilb-tensor-universal-property]{Theorem}%
\index{tensor product!of Hilbert spaces!universal property}
\index{tensor product!of Hilbert spaces!is $\ell^2$-bounded}
A tensor product $\gamma\colon \scrH\times\scrK\to\scrT$
of Hilbert spaces
is $\ell^2$-bounded,
and initial as such 
in the sense
that for any by $B\in [0,\infty)$ 
$\ell^2$-bounded bilinear map $\beta\colon \scrH\times\scrK \to\scrL$
into a Hilbert space~$\scrL$
there is a unique bounded linear map $\beta_\gamma\colon\scrT
\to\scrL$
with $\beta_\gamma(\gamma(x,y))=\beta(x,y)$
for all~$x\in\scrH$ and~$y\in\scrK$.
Moreover, $\|\beta_\gamma\|\leq B$
for such~$\beta$.
\begin{point}{40}{Proof}%
Note that $\gamma$ is $\ell^2$-bounded,
since
for all~$x_1,\dotsc,x_n\in\scrH$,
$y_1,\dotsc,y_n\in\scrK$,
we have
$\|\sum_i\gamma(x_i,y_i)\|^2
= \sum_{i,j}\left<\gamma(x_i,y_i),
\gamma(x_j,y_j)\right>
= \sum_{i,j} \left<x_i,x_j\right>\left<y_i,y_j\right>$.

Let~$\scrE$ and~$\scrF$
be orthonormal bases
for~$\scrH$ and~$\scrK$, respectively.
Then since~$\{\,\gamma(e,f)\colon\,e\in\scrE,\,f\in\scrF\,\}$
is an orthonormal basis for~$\scrT$
by~\sref{hilb-tensor-basic},
and~$\beta_\gamma$
is fixed on it by~$\beta_\gamma(\gamma(e,f))=\beta(e,f)$,
uniqueness of~$\beta_\gamma$ is clear.

Concerning existence of~$\beta_\gamma$,
note that
since $t=\sum_{e\in\scrE,f\in\scrF} \left<\gamma(e,f),t\right>\gamma(e,f)$
for all~$t\in\scrT$
by~\sref{orthonormal},
 we'd like to define~$\beta_\gamma$ by
\begin{equation}
	\label{tensor-universal-property-1}
	\beta_\gamma(t) \ =\  
	\hspace{-1em}
	\sum_{e\in\scrE,\,f\in\scrF}
	\hspace{-.5em}
	\left<\gamma(e,f),t\right>\,\gamma(e,f);
\end{equation}
but before we can do this
we must first check that this series converges.
To this end,
note that since~$\beta$ is $\ell^2$-bounded by~$B$
we have, given~$t\in \scrT$,
\begin{alignat*}{3}
	\bigl\|\hspace{-.75em}\sum_{e\in E,\,f\in F}
	\hspace{-.5em}
\left< \gamma(e,f),t\right>\beta(e,f)
\,\bigr\|^2
\ &=\  
\bigl\|\hspace{-.75em}
\sum_{e\in E,\,f\in F}
\hspace{-.5em}
\beta(e,\,\left<\gamma(e,f),t\right>f\,)
\,\bigr\|^2
\\
\ &\leq \  
B^2\hspace{-1.5em}\sum_{e'\!\!,e\in E,\ f'\!\!,f\in F}
\hspace{-1em}
\left<e',e\right>\,
\,\left<t,\gamma(e',f')\right>\,
\left<f',f\right>\,\left<\gamma(e,f),t\right>
\\
\ &=\ 
B^2\hspace{-.75em}\sum_{e\in E,\,f\in F}
\hspace{-.5em}
\left|\left<\gamma(e,f),t\right>\right|^2
\end{alignat*}
for all finite subsets $E\subseteq\scrE$
and~$F\subseteq \scrF$.
Since $\|t\|^2=\sum_{e\in \scrE,\,f\in\scrF}
\left|\left<\gamma(e,f),t\right>\right|^2$
by Parseval's identity (\sref{orthonormal}),
we see
that the series
from~\eqref{tensor-universal-property-1}
converges defining~$\beta_\gamma(t)$,
and, moreover,
that~$\|\beta_\gamma(t)\|^2\leq B^2\|t\|^2$.

The resulting map $\beta_\gamma\colon \scrT\to\scrL$
is clearly linear,
and
bounded by~$B$.
Further,
$\beta_\gamma(\gamma(e,f))=\beta(e,f)$
for all~$e\in\scrE$ and~$f\in\scrF$
implies
that $\beta_\gamma(\gamma(x,y))=\beta(x,y)$
for all~$x\in \scrH$ and~$y\in\scrK$,
and so we're done.\qed
\end{point}
\end{point}
\begin{point}{50}{Exercise}%
Show that the tensor product of Hilbert spaces~$\scrH$
and~$\scrK$ is unique in the sense
that given tensor products $\gamma\colon \scrH\times\scrK\to\scrT$
and $\gamma'\colon\scrH\times\scrK\to\scrT'$
there is a unique isometric linear isomorphism
$\varphi\colon \scrT\to\scrT'$
with $\gamma'(x,y) = \varphi(\gamma(x,y))$
for all~$x\in\scrH$
and~$y\in\scrK$.
\end{point}
\begin{point}{60}{Notation}%
Now that we've established
that the tensor product
of Hilbert spaces~$\scrH$ and~$\scrK$
exists and is unique (up to unique isomorphism)
we just pick one and denote it by $\Define{\otimes}\colon
\scrH\times\scrK\to\Define{\scrH\otimes\scrK}$.%
\index{*tensor@$\otimes$, tensor product!$\scrH\otimes \scrK$, of Hilbert spaces}
\index{*tensor@$\otimes$, tensor product!$x \otimes y$, of elements of Hilbert spaces}
\end{point}
\end{parsec}
\begin{parsec}{1110}%
\begin{point}{10}%
Essentially to turn~$\otimes$
into a functor on
the category of Hilbert spaces
in~\sref{hilb-tensor-functor},
we'll need
the following result
(known as part of \emph{Schur's product theorem}),%
\index{Schur's Product Theorem}
which will be useful several times later on.
\end{point}
\begin{point}{20}[schur]{Lemma}%
For any natural number~$N$
the entrywise product 
$(a_{nm}b_{nm})$
of positive  $N\times N$-matrices
$(a_{nm})$ and~$(b_{nm})$
over~$\C$
is positive.
\begin{point}{30}{Proof}%
Let~$z_1,\dotsc,z_N\in\C$ be given.
To show that $(a_{nm}b_{nm})$
is positive,
it suffices by~\sref{when-a-matrix-over-a-cstar-algebra-is-positive} 
to prove that
$\sum_{n,m} \overline{z}_n a_{nm} b_{nm} z_m \geq 0$
for all~$n,m$.
Since~$(a_{nm})$
is a positive element
of the $C^*$-algebra~$M_N$
it's of the form~$(a_{nm})=C^*C$
for some $N\times N$-matrix $C\equiv(c_{nm})$
over~$\C$,
so  $a_{nm} = \sum_k \overline{c}_{kn} c_{km}$
for all~$n,m$.
Similarly, there a $N\times N$-matrix
$(d_{nm})$ over~$\C$
with $b_{nm} = \sum_\ell \overline{d}_{\ell n}
d_{\ell m}$
for all~$n,m$.
Then
\begin{alignat*}{3}
	\sum_{n,m} \overline{z}_n
a_{nm} b_{nm} z_m
\ &=\  \hspace{-.5em} \sum_{n,m,k,\ell}
\overline{z}_n \,\overline{c}_{kn}
c_{km} \,\overline{d}_{\ell n} d_{\ell m} z_m\,
\\
\ &=\  \sum_{k,\ell}
\Bigl(\sum_n
\overline{z}_n\overline{c}_{kn}
\overline{d}_{\ell n} \Bigr)
\,
\Bigl(
\sum_m
z_m
c_{km} 
d_{\ell m} 
\Bigr)
\\
\ &=\  \sum_{k,\ell}\ 
\Bigl|\sum_n z_n c_{kn} d_{\ell n} \Bigr|^2 \geq 0,
\end{alignat*}
and so~$(a_{nm}b_{nm})$ is positive.
\qed
\end{point}
\end{point}
\begin{point}{40}[mult-completely-monotone]{Exercise}%
Given square matrices 
$(a_{nm})\leq (\tilde{a}_{nm})$
and $(b_{nm})\leq (\smash{\tilde{b}_{nm}})$
over~$\C$
of the same dimensions,
show that $(\,a_{nm}b_{nm}\,)\leq (\,\tilde{a}_{nm}\smash{\tilde{b}_{nm}}\,)$.
\end{point}
\begin{point}{50}[hilb-tensor-functor]{Proposition}%
Given bounded linear maps
$A\colon \scrH\to\scrH'$
and~$B\colon \scrK\to\scrK'$
between Hilbert spaces
there is a unique bounded linear
map 
\begin{equation*}
	\Define{A\otimes B}\colon \scrH\otimes\scrK\to\scrH'\otimes\scrK'
\end{equation*}%
\index{*tensor@$\otimes$, tensor product!$A\otimes B$, 
of operators between Hilbert spaces}
with $(A\otimes B)(x\otimes y)=(Ax)\otimes (By)$
for all~$x\in\scrH$
and~$y\in\scrK$.
\begin{point}{60}{Proof}%
In view of~\sref{hilb-tensor-universal-property}
the only thing we need
to prove is that the bilinear map
$\otimes\circ (A\times B)\colon \scrH\times \scrK
\to\scrH\otimes\scrK$
is $\ell^2$-bounded
(for then~$A\otimes B=(\,\otimes\circ (A\times B)\,)_\otimes$.)
So let~$x_1,\dotsc,x_n\in\scrH$
and~$y_1,\dotsc,y_n\in\scrK$
be given,
and note that
\begin{alignat*}{3}
	\|\sum_{i}(\otimes\circ(A\times B))(x_i,y_i)\,\|^2
	\ &=\ 
	\|\sum_{i} (Ax_i)\otimes (By_i)\|^2
	\\
	\ &=\ 
	\sum_{i,j} 
	\left<Ax_i,Ax_j\right>
	\,\left<By_i,By_j\right>
	\\
	\ &\leq\ 
	\|A\|^2\|B\|^2
	\sum_{i,j} 
	\left<x_i,x_j\right>
	\left<y_i,y_j\right>,
\end{alignat*}
so~$\otimes\circ(A\times B)$
is bounded by~$\|A\|\|B\|$.
The last step in the display above
is justified by~\sref{mult-completely-monotone},
and the inequalities
$(\,\left<Ax_i,A x_j\right>\,)\leq
(\, \|A\|^2 \left<x_i,x_j\right>\,)$
and
$(\,\left<By_i,B y_j\right>\,)\leq
(\, \|B\|^2 \left<y_i,y_j\right>\,)$.\qed
\end{point}
\end{point}
\begin{point}{70}[special-tensor]{Theorem}%
\index{spacial tensor product}
Let~$\scrA$
and~$\scrB$
be von Neumann algebras
of bounded operators
on Hilbert spaces~$\scrH$ and~$\scrK$,
respectively.
Sending operators $A\in\scrA$ and~$B\in\scrB$
to $A\otimes B\colon \scrH\otimes \scrK\to\scrH\otimes \scrK$
from~\sref{hilb-tensor-functor} gives
an miu-bilinear 
map 
\begin{equation*}
	\otimes\colon \scrA\times \scrB\longrightarrow
	\scrB(\scrH\otimes\scrK).
\end{equation*}
Letting~$\scrT$ 
be the von Neumann subalgebra
of $\scrB(\scrH\otimes\scrK)$
generated by the range of~$\otimes$,
the restriction~$\gamma\colon \scrA\times \scrB\to\scrT$
of~$\otimes$
is a tensor product of~$\scrA$ and~$\scrB$.
\begin{point}{80}{Proof}%
We'll check that the three conditions of~\sref{tensor} hold;
we leave it to the reader to verify that~$\otimes$
is miu-bilinear.
\begin{point}{90}{Condition~\ref{tensor-1}}%
The range of~$\gamma$ being the same as the range of~$\otimes$
generates~$\scrT$ 
simply by the way~$\scrT$ was defined.
\end{point}
\begin{point}{100}{Condition~\ref{tensor-2}}%
Let~$\sigma\colon \scrA\to\C$
and~$\tau\colon \scrB\to\C$ be np-maps.
We must find an np-functional~$\omega$ on~$\scrT$
with $\omega(A\otimes B)=\sigma(A)\tau(B)$
for all~$A\in \scrA$, $B\in \scrB$.
Note that by~\sref{normal-functional}
$\sigma$ and~$\tau$ are of the form
$\sigma\equiv\sum_n \left<x_n,(\,\cdot\,)x_n\right>$
and~$\tau\equiv\sum_n \left<y_n,(\,\cdot\,)y_n\right>$
for some~$x_1,x_2,\dotsc\in\scrH$
and~$y_1,y_2,\dotsc\in\scrK$
with~$\sum_n\|x_n\|^2<\infty$
and~$\sum_m\|y_m\|^2 <\infty$.
So as~$\sum_{n,m}\|x_n\otimes y_m\|^2\equiv\sum_n \|x_n\|^2\,
\sum_m\|y_m\|^2 <\infty$,
we can define
an np-functional~$\omega$ on~$\scrT$
by $\omega(T):= \sum_{n,m} \left<x_n\otimes y_m,
T\,x_n\otimes y_m\right>$;
which does the job:  $\omega(A\otimes B)
= \sum_{n,m} \left<x_n, Ax_n\right> \left<y_m,By_m\right>
= \sigma(A)\tau(B)$
for all~$A\in\scrA$ and~$B\in\scrB$.
\end{point}
\begin{point}{110}{Condition~\ref{tensor-3}}%
It remains to be shown that the
product functionals
on~$\scrT$ form a faithful collection.
These functionals are---as we've just seen---all
of the form
$\sum_{m,n}\left<x_n\otimes y_n,(\,\cdot\,)\,x_n\otimes y_m\right>$
for some $x_1,x_2,\dotsc\in\scrH$
and~$y_1,y_2,\dotsc\in\scrK$
(and, conversely, it's easily seen
that a functional
of that form
is a product functional).
It suffices,
then,
to show that the subset of
product functionals
of the  form $\left<x\otimes y,(\,\cdot\,)x\otimes y\right>$
where~$x\in\scrH$ and~$y\in\scrK$ is faithful.
To this end,
let~$T\in\scrT_+$
with $\left< x\otimes y, Tx\otimes y\right>=0$
for all~$x\in\scrH$ and~$y\in\scrK$ be given
in order to show that~$T=0$.
Note that since
$\|\sqrt{T}\,x\otimes y\|^2=\left<x\otimes y,T\,x\otimes y\right>
=0$, and so~$\sqrt{T}\,x\otimes y=0$
for all~$x\in\scrH$, $y\in \scrK$,
we have~$\sqrt{T}=0$ (since the linear
span of the $x\otimes y$ is dense in~$\scrH\otimes\scrK$),
and thus~$T=0$.\qed
\end{point}
\end{point}
\end{point}
\begin{point}{120}{Exercise}%
\index{tensor product!of von Neumann algebras!exists}%
Given von Neumann algebras~$\scrA$ and~$\scrB$
(which are not a priori represented on Hilbert spaces)
construct a tensor product~$\gamma\colon \scrA\times \scrB\to\scrT$
of~$\scrA$ and~$\scrB$
using~\sref{ngns} and~\sref{special-tensor}.
\end{point}
\end{parsec}
\subsection{Universal Property}
\begin{parsec}{1120}%
\begin{point}{10}%
Before we bring our categorical faculties
to bear upon the tensor product for von Neumann algebras
we quickly review
the (algebraic)
tensor product of plain vector spaces~$V$ and~$W$ first ---
    it is a vector space~$\Define{V\odot W}$%
\index{*tensora@$\odot$, algebraic tensor product}%
\index{tensor product!algebraic = of vector spaces}
equipped
    with a bilinear mapping~$\Define{\odot}\colon V\times W\to V\odot W$
which is  universal  
in the sense that for every bilinear mapping~$\beta\colon V\times W\to Z$
into some vector space~$Z$
    there is a unique linear map~$\Define{\beta_\odot}\colon V\odot W\to Z$%
\index{*tensorasup@$\beta_\odot$}
with~$\beta_\odot(v\odot w)=\beta(v,w)$
for all~$v\in V$ and~$w\in W$.
This property
uniquely determines the algebraic tensor product in the sense
that for any bilinear map~$\mathbin{\tilde\odot}\colon
 V\times W\to V\mathbin{\tilde\odot} W$
 into a vector space~$V\mathbin{\tilde \odot} W$
which shares this property
there is a unique linear isomorphism $\varphi\colon V\odot W\to V
\mathbin{\tilde \odot} W$
with $\varphi(v\odot w) = v\mathbin{\tilde\odot} w$
for all~$v\in V$ and~$w\in W$.

In fact, one may take this property as a neat abstract 
definition of the algebraic
tensor product.
However, to  see that the darn thing actually exists,
one still needs a concrete description
such as this one:
take given a basis~$B$ of~$V$ and a basis~$C$ of~$W$
the bilinear map $\odot$ on~$V\times W$
to the vector space $(B\times C)\cdot \C$ with basis~$B\times C$
determined by~$b\odot c = (b,c)$
for~$b\in B$ and~$c\in C$.
This shows us not only that the algebraic tensor product
exists,
but also 
that~$\odot$ is injective (among other things).

This is all, of course, well known,
and we already saw in~\sref{hilb-tensor-universal-property}
that the tensor product for Hilbert spaces
has a similar universal property;
the interesting thing here is that
with some work one can see that
a tensor product
$\gamma\colon \scrA\times \scrB\to \scrT$
of von Neumann algebras
$\scrA$ and~$\scrB$
has a similar universal property too!
We'll see that any bilinear map $\beta\colon \scrA\times \scrB\to\scrC$
into a von Neumann algebra~$\scrC$
which is sufficiently regular
extends uniquely along~$\gamma$ to a ultraweakly continuous
map $\beta_\gamma \colon  \scrT\to\C$,
where regular will mean 
that the extension $\beta_\odot\colon \scrA\odot\scrB\to\scrC$
from the \emph{algebraic} tensor product
is ultraweakly continuous
and bounded
with respect to the norm and ultraweak topology
induced on~$\scrA\odot\scrB$ by~$\scrT$
via~$\gamma$.

To prevent a circular description
here,
we'll first describe the norm and ultraweak topology
that the tensor product induces on~$\scrA\odot \scrB$
directly,
which turns out to be independent (as it should)
from the choice of~$\gamma$.
This description
is essentially based
on the fact that the product functionals on~$\scrT$
are centre separating;
and that this determines both norm and 
ultraweak topology
is just a general 
observation concerning
centre separating sets, as we saw in~\sref{vn-center-separating-fundamental}.
\end{point}
\begin{point}{20}[tensor-extra]{Definitions}%
Let~$\scrA$ and~$\scrB$ be von Neumann algebras.
\begin{enumerate}
\item
A \Define{basic functional}%
\index{functional!basic, on~$\scrA\odot\scrB$}
is 
a map $\omega \colon \scrA\odot\scrB\to\C$
with
$\omega\equiv (\sigma\odot \tau)(t^*(\,\cdot\,)t)$
for some np-maps
$\sigma\colon \scrA\to\C$, $\tau\colon \scrB\to\C$,
and
$t\in \scrA\odot\scrB$.

A \Define{simple functional}%
\index{functional!simple, on~$\scrA\odot\scrB$}
is a finite sum of basic functionals.
\item
Each basic functional $\omega \colon \scrA\odot\scrB\to\C$
gives us an operation~$\Define{[\,\cdot\,,\,\cdot\,]_\omega}$,
that will turn out to be an inner product in~\sref{basic-state-inner-product}
 by
$\Define{[s,t]_\omega}:=\omega(s^*t)$
(cf.~\sref{state-inner-product}),
and an associated semi-norm
denoted by~$\Define{\|t\|_\omega}:=[t,t]_\omega^{\smash{\nicefrac{1}{2}}} 
= \omega(t^*t)^{\nicefrac{1}{2}}$.

The \Define{tensor product norm}
on~$\scrA\odot \scrB$
is the norm (see~\sref{tensor-product-norm})
given by
\begin{equation*}
	\textstyle
	\Define{\|t\|}\ =\ \sup_\omega \|t\|_\omega,
\end{equation*}
where~$\omega$ ranges over all basic functionals
on~$\scrA\odot\scrB$
with~$\omega(1)\leq 1$.
\item
Note that having endowed~$\scrA\odot \scrB$
with the tensor product norm
we can speak of bounded functionals on~$\scrA\odot \scrB$,
and the operator norm on them;
and note that
the basic and simple  functionals are bounded.

The \Define{ultraweak tensor product topology}%
\index{ultraweak tensor product topology}
is the least topology on~$\scrA\odot\scrB$
that makes all operator norm limits
of simple functionals continuous.
\item
A bilinear map $\beta\colon \scrA\times \scrB\to\scrC$
to a von Neumann algebra~$\scrC$
is called
\begin{enumerate}
\item
(continues the list from~\sref{bilinear-basic})
\item
\Define{bounded}%
\index{bilinear map!bounded}
when the unique extension $\beta_\odot \colon \scrA\odot \scrB\to \scrC$
is bounded,
\item 
\Define{\textbf{n}ormal}%
\index{bilinear map!normal}%
\index{normal!bilinear map}
when~$\beta_\odot$
is continuous with respect to the ultraweak tensor product topology 
on~$\scrA\odot\scrB$
and the ultraweak topology on~$\scrC$,
\item
\Define{\textbf{c}ompletely \textbf{p}ositive}%
\index{bilinear map!completely positive}%
\index{completely positive!bilinear map}%
\index{positive!completely $\sim$ bilinear map}
when~$\sum_{i,j}c_i^*\,\beta(a_i^*a_j,b_i^*b_j)\,c_j\geq 0$
for all tuples $a_1,\dotsc,a_N\in\scrA$,
$b_1,\dotsc,b_N\in\scrB$,
and $c_1,\dotsc,c_N\in\scrC$.
\end{enumerate}
\end{enumerate}
\spacingfix%
\begin{point}{21}{Warning}%
While we'll be able to see shortly that any bilinear map
$\beta\colon \scrA\times\scrB\to\scrC$
between von Neumann algebras
that is normal
is jointly ultraweakly continuous as well,
(as a consequence of~\sref{tensor-basic},)
we do not know---but doubt---that the converse holds.
So to clearly differentiate between these two possibly different properties,
we decided to call the former ``normality'' instead of 
    the more likely ``ultraweak continuity'',
stretching the use of the word ``normal'' beyond its usual 
    domain of positive (bilinear) maps.
\end{point}
\end{point}
\begin{point}{30}[product-state-positive]{Lemma}%
Given $C^*$-algebras~$\scrA$ and~$\scrB$
we have~$(\sigma\odot \tau) (t^*t)\geq 0$
for all  $t\in\scrA\odot\scrB$
and p-maps  $\sigma\colon \scrA\to\C$
and~$\tau\colon \scrB\to\C$.
\begin{point}{40}{Proof}%
Note that writing~$t\equiv \sum_n a_n \odot b_n$,
where~$a_1,\dotsc,a_N\in \scrA$, $b_1,\dotsc,b_N\in \scrB$,
we have
$(\sigma\odot\tau)(t^*t)
= \sum_{n,m} \sigma(a_n^*a_m)\,\tau(b_n^*b_m)$.
Since~$(a_n^*a_m)$
is a positive matrix over~$\scrA$,
and~$\sigma\colon \scrA\to\C$
is completely positive (by~\sref{cp-commutative}),
the matrix~$(\sigma(a_n^*a_m))$ is positive.
Since~$(\tau(b_n^*b_m))$
is positive by the same token,
the entrywise product
$(\,\sigma(a_n^*a_m)\,\tau(b_n^*a_m)\,)$
is positive too (by~\sref{schur}).
Whence
$(\sigma\odot\tau)(t^*t)
=\ \sum_{n,m} \sigma(a_n^*a_m)\,\tau(b_n^*b_m) \geq 0$.\qed
\end{point}
\end{point}
\begin{point}{50}[basic-state-inner-product]{Exercise}%
Use~\sref{product-state-positive} 
to show that
 $[\,\cdot\,,\,\cdot\,]_\omega$
from~\sref{tensor-extra}
is an inner product.
\end{point}
\begin{point}{60}{Lemma}%
Product functionals on~$\scrA\odot\scrB$
formed from 
separating
collections~$\Omega$ and~$\Xi$ 
of linear functionals
on $C^*$-algebras~$\scrA$ and~$\scrB$,
respectively,
are separating
in the sense that given~$t\in\scrA\odot\scrB$
the condition that $(\sigma\odot \tau)(t)=0$
for all~$\sigma\in \Omega$ and~$\tau\in\Xi$
entails that~$t=0$.
\begin{point}{70}{Proof}%
Write~$t\equiv \sum_n a_n\odot b_n$
for some  $a_1,\dotsc,a_N\in\scrA$
and~$b_1,\dotsc,b_N\in \scrB$.
	Note that (by replacing them if necessary)
we may assume that the~$a_1,\dotsc,a_N$
are linearly independent.
Let~$\tau\in\Xi$ be given.
Since~$0=(\sigma\odot \tau)(t)
= \sum_n\sigma(a_n)\tau(b_n)
= \sigma(\,\sum_n a_n\tau(b_n)\,)$
for all $\sigma$ from the separating collection~$\Omega$,
we have~$0=\sum_n a_n\tau(b_n)$,
and so---$a_1,\dotsc,a_N$ being linearly independent---we get
 $0=\tau(b_1)=\dotsb = \tau(b_N)$.
Since this holds for any~$\tau$
in the separating collection~$\Xi$
we get~$0=b_1=\dotsb=b_N$,
and thus~$t=\sum_n a_n\odot b_n=0$.\qed
\end{point}
\end{point}
\begin{point}{80}[tensor-product-norm]{Exercise}%
Show that the tensor product norm
from~\sref{tensor-extra}
is, indeed, a norm.
\end{point}
\begin{point}{90}[product-functional]{Exercise}%
Note that given np-functionals 
$\sigma \colon \scrA\to\C$
and~$\tau\colon \scrB\to\C$
on von Neumann algebras,
the functional $\sigma\odot\tau\colon \scrA\odot\scrB\to\C$
is ultraweakly continuous and bounded,
almost by definition.

Show that $f\odot g$ is
bounded and ultraweakly continuous too
for all~$f\in\scrA_*$ and~$g\in\scrB_*$
(perhaps using~\sref{luws}).
\end{point}
\begin{point}{100}[tensor-basic]{Exercise}%
We're going to show that 
the ultraweak tensor product topology
and tensor product norm from~\sref{tensor-extra}
actually describe the norm and ultraweak topology
on~$\scrA\odot\scrB$ induced by a tensor product
$\scrA\times\scrB\to\scrT$ (via~$\gamma_\odot$)
by establishing
the two closely related facts that
$\gamma_\odot\colon\scrA\odot\scrB\to\scrT$
is an isometry
and an ultraweak embedding,
and that certain
functionals 
$\omega\colon \scrA\odot\scrB\to\C$
can be extended uniquely to~$\scrT$ along~$\gamma_\odot$.
\begin{enumerate}
\item
Show using~\sref{vn-center-separating-fundamental}
that the collection~$\Omega$
of np-functionals
on~$\scrT$ of the form 
$\gamma(\sigma,\tau)(\gamma_\odot(s)^*(\,\cdot\,)\gamma_\odot(s))$,
where~$\sigma\colon \scrA\to\C$,
$\tau\colon \scrB\to\C$
are np-functionals
and~$s\in\scrA\odot\scrB$,
is order separating,
and that
every np-functional on~$\scrT$
is the operator norm limit of finite sums
of functionals from~$\Omega$.

Show that~$\omega\circ \gamma_\odot$ is a basic functional
(see \sref{tensor-extra})
for every~$\omega\in\Omega$,
and that every basic functional is of this form
for some unique~$\omega\in\Omega$.

\item
Show that the subset~$\Omega_1$ of~$\Omega$
of unital maps is order separating,
and so determines the norm on~$\scrT$
via~$\|a\|^2=\|a^*a\| = \sup_{\omega\in\Omega_1} \omega(a^*a)$
for all~$a\in\scrT$
(see~\sref{order-separating-norm}).

Prove that $\|\gamma_\odot(s)\|
=\sup_{\omega\in\Omega_1} \omega(s^*s)^{\nicefrac{1}{2}}
=\sup_{\omega\in\Omega_1}
\|s\|_{\omega\circ \tau_\odot}=\|s\|$
for all~$s\in\scrA\odot\scrB$,
and 
conclude
that~$\gamma_\odot$ is an isometry.

\item
Show that~$\|f\circ\gamma_\odot\|\leq \|f\|$
for every $f\in\scrT_*$,
and deduce from this
that when~$\omega\colon \scrT\to\C$
is an np-functional
its restriction $\omega\circ\gamma_\odot$
is the operator norm limit
of simple functionals on~$\scrA\odot\scrB$
implying that~$\omega\circ\gamma_\odot$---and
thus $\gamma_\odot$ itself---is ultraweakly continuous.

\item
In order to show that~$\gamma_\odot$ is an ultraweak embedding,
we'll need the equality $\|f\circ \gamma_\odot\|=\|f\|$
for all~$f\in\scrT_*$.

In order to show this in turn,
recall 
(from \sref{polar-decomposition-of-functional})
that there is a partial isometry~$u$ in~$\scrT$
with~$f(u)=\|f\|$ (see~\sref{functional-norm}). 

Show that given~$\varepsilon>0$ 
there is a net~$(s_\alpha)_\alpha$
in~$\scrA\odot\scrB$
with $\|s_\alpha\|\leq 1+\varepsilon$ for all~$\alpha$
such that $\gamma_\odot(s_\alpha)$
converges ultrastrongly to~$t$ as~$\alpha\to\infty$
(cf.~\sref{dense-subalgebra}).

Deduce that $\|f\|=f(u)=\left|f(u)\right|
=\lim_\alpha \left|f(\gamma_\odot(s_\alpha))\right|
\leq \|f\circ \gamma_\odot\| (1+\varepsilon)$,
and
conclude that~$\|f\|=\|f\circ\gamma_\odot\|$.

\item
Show that any functional $\omega'\colon \scrA\odot\scrB\to\C$
that is the operator norm limit of simple functionals
on~$\scrA\odot\scrB$
can be extended uniquely along~$\gamma_\odot$
to an np-functional on~$\scrT$
(using the fact that the operator
norm limit of np-functionals is an np-functional again,
see~\sref{predual-complete}).

Deduce from this that~$\gamma_\odot$ is a ultraweak topological embedding.

(Note that by~\sref{vn-extension} any 
bounded ultraweakly continuous functional
on~$\scrA\odot\scrB$ can be extended uniquely
to a normal functional on~$\scrT$.)
\end{enumerate}
\spacingfix%
\end{point}
\begin{point}{110}[tensor-universal-property]{Theorem}%
\index{tensor product!of von Neumann algebras!universal property}
A tensor product~$\gamma\colon \scrA\times\scrB\to\scrT$
of von Neumann algebras~$\scrA$ and~$\scrB$
has this universal property:
for every normal bounded bilinear map $\beta\colon \scrA\times \scrB\to\scrC$
to a von Neumann algebra~$\scrC$
there is a unique ultraweakly continuous
map  $\Define{\beta_\gamma}\colon \scrT
\to \scrC$%
\index{*tensorsup@$\beta_\gamma$}
with $\beta_\gamma\circ \gamma  = \beta$.
Moreover, $\|\beta_\gamma\|=\|\beta_\odot\|$.
\begin{point}{120}{Proof}%
Since $\beta_\odot\colon \scrA\odot\scrB\to\scrC$
is ultraweakly continuous and bounded,
and
$\scrA\odot\scrB$
can by~\sref{tensor-basic} be
considered an ultraweakly dense $*$-subalgebra
of~$\scrT$ via~$\gamma_\odot$,
the theorem follows from~\sref{vn-extension}
except for some trivial details.\qed
\end{point}
\end{point}
\end{parsec}%
\begin{parsec}{1130}%
\begin{point}{10}%
\index{completely positive!bilinear map}%
We'll need some observations
concerning completely positive bilinear maps.
\end{point}
\begin{point}{20}{Exercise}%
\index{Schur's Product Theorem}
Show that a mi-bilinear
map $\beta\colon \scrA\times\scrB\to\scrC$ between von Neumann 
algebras is completely positive.
\end{point}
\begin{point}{30}{Notation}%
Given a bilinear map
$\beta\colon \scrA\times\scrB\to\scrC$
between von Neumann algebras,
we define
$\Define{M_N\beta}\colon M_N\scrA\times M_N\scrB\to M_N\scrC$
by  $(M_N\beta)(A,B) = 
(\beta(A_{ij},B_{ij}))_{ij}$%
\index{Mnbeta@$M_n\beta$, for bilinear~$\beta$}
for each~$N$.
\end{point}
\begin{point}{40}[cp-bilinear]{Exercise}%
Show that for a bilinear map $\beta\colon \scrA\times\scrB\to\scrC$
between von Neumann algebras
the following are equivalent.
\begin{enumerate}
\item
$\beta$ is completely positive.
\item
$M_N\beta$ is completely positive
for each~$N$.
\item
$(M_N\beta)(A,B)\geq 0$
for all~$A\in M_N(\scrA)_+$, $B\in M_N(\scrB)_+$ and~$N$.
\end{enumerate}
Deduce 
as a corollary that $h\circ \beta \circ (f\times g)$
is completely positive
when~$f\colon \scrA'\to\scrA$,
$g\colon \scrB'\to\scrB$
and~$h\colon \scrC\to\scrC'$
are cp-maps between von Neumann algebras.
\end{point}
\end{parsec}
\begin{parsec}{1140}%
\begin{point}{10}[tensor-universal-property-extra]{Exercise}%
\index{tensor product!of von Neumann algebras!universal property}
Let $\gamma\colon \scrA\times \scrB\to\scrT$
be a tensor product
of von Neumann algebras,
  $\beta\colon \scrA\times \scrB\to\scrC$
 a normal bounded bilinear map,
 and~$\beta_\gamma\colon \scrT\to\scrC$
 its extension along~$\gamma_\odot$
from~\sref{tensor-universal-property}.
Show that
\begin{enumerate}
\item
$\beta_\gamma$
is multiplicative iff~$\beta$ is multiplicative
(see~\sref{tensor-extra});
\item 
$\beta_\gamma$ 
is involution preserving iff~$\beta$ is involution preserving;
\item
$\beta_\gamma$ is unital
iff $\beta$ is unital;
\item
$\beta_\gamma$ is positive
iff
$\sum_{i,j} \beta(a_i^*a_j,b_i^*b_j) \geq 0$
for all tuples $a_1,\dotsc,a_N$
from~$\scrA$ and $b_1,\dotsc,b_N$ from $\scrB$;
\item
$\beta_\gamma$ is completely positive iff
$\beta$ is completely positive.
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{20}[tensor-uniqueness]{Exercise}%
\index{tensor product!of von Neumann algebras!uniqueness}
Show that the tensor product of von Neumann algebras~$\scrA$
and~$\scrB$ is unique in
the sense
that when~$\gamma\colon \scrA\times \scrB\to\scrT$
and~$\gamma'\colon \scrA\times \scrB\to\scrT'$
are tensor products of~$\scrA$ and~$\scrB$,
then there is a unique
nmiu-isomorphism $\varphi\colon \scrT\to\scrT'$
with $\varphi(\gamma(a,b))=\gamma'(a,b)$
for all~$a\in\scrA$ and~$b\in\scrB$.
\end{point}
\end{parsec}
\subsection{Functoriality}
\begin{parsec}{1150}%
\begin{point}{10}{Notation}%
Now that we've established
that that the tensor product
of von Neumann algebras~$\scrA$ and~$\scrB$
exists and is unique (up to unique nmiu-isomorphism)
we just pick one and denote it by $\Define{\otimes}\colon
\scrA\times\scrB\to\Define{\scrA\otimes\scrB}$.%
\index{*tensor@$\otimes$, tensor product!$\scrA\otimes\scrB$, of von Neumann algebras}%
\index{*tensor@$\otimes$, tensor product!$a\otimes b$,
of elements of von Neumann algebras}
\end{point}
\begin{point}{20}[tensor-functorial]{Proposition}%
Given ncp-maps $f\colon \scrA\to\scrC$
and $g\colon \scrB\to\scrD$
between von Neumann algebras
there is a unique ncp-map
$\Define{f\otimes g}\colon \scrA\otimes\scrB\to\scrC\otimes\scrD$
with 
\begin{equation*}
	(f\otimes g)(a\otimes b) \ =\ f(a)\otimes f(b)
\end{equation*}%
\index{*tensor@$\otimes$, tensor product!$f\otimes g$, of np-maps}
for all~$a\in\scrA$ and~$b\in\scrB$.
Moreover,
\begin{enumerate}
\item
$f\otimes g$ is multiplicative 
when~$f$ and~$g$ are multiplicative;
\item
$f\otimes g$ is involution preserving
when~$f$ and~$g$ are involution preserving; and
\item
$f\otimes g$ is (sub)unital 
when~$f$ and~$g$ are (sub)unital.
\end{enumerate}
\spacingfix%
\begin{point}{30}{Proof}%
As uniqueness of~$f\otimes g$ is rather obvious,
we leave it at that.
To establish
existence of~$f\otimes g$,
it suffices to show
that the bilinear map~$\beta\colon \scrA\times\scrB\to\scrC\otimes\scrD$
given by~$\beta(a,b)=f(a)\otimes g(b)$,
which is completely positive by~\sref{cp-bilinear},
is bounded and normal;
because then we may take $f\otimes g:=\beta_\otimes$%
\index{*tensorsupexact@$\beta_\otimes$}
as in~\sref{tensor-universal-property}
and all
the properties claimed for~$f\otimes g$ will then  follow 
with the very least of effort
from~\sref{tensor-universal-property-extra}.

To see that~$\beta$ is bounded,
we'll prove that~$\|\beta_\odot(s)\| \leq \|f\|\|g\| \|s\|$
given an element~$s$ of~$\scrA\otimes \scrB$,
and for this
it suffices (by the definition
of the tensor product norm, \sref{tensor-extra}) 
to show that
$\omega(\beta_\odot(s)^*\beta_\odot(s))
\leq \|f\|^2\|g\|^2\|s\|^2$
given a basic functional~$\omega$
on~$\scrA\odot\scrB$ with~$\omega(1)\leq 1$.
We'll prove in a moment that
$\|\omega\circ\beta_\odot\|\leq \|f\|\|g\|$
and~$\beta_\odot(s)^*\beta_\odot(s)\leq
\|f\|\|g\|\beta_\odot(s^*s)$,
because with these two claims
we get 
$\omega(\beta_\odot(s)^*\beta_\odot(s))
\leq \|f\|\|g\|\omega(\beta_\odot(s^*s))
\leq \|f\|\|g\| \|\omega\circ \beta_\odot\| \|s\|^2
\leq \|f\|^2\|g\|^2\|s\|^2$
 --- which is the result desired.

Concerning the first
promise, that $\|\omega\circ \beta_\odot\|\leq \|f\|\|g\|$,
note that writing
$\omega\equiv (\sigma\odot\tau)(t^*(\,\cdot\,)t)$,
where~$\sigma$ and~$\tau$
are np-maps on~$\scrC$ and~$\scrD$, respectively,
and~$t\equiv\sum_{ij} c_i \odot d_i$
is from~$\scrC\odot\scrD$,
we have 
\begin{equation*}
	\omega\circ\beta_\odot
= \textstyle \sum_{ij} \sigma(c_i^* f(\,\cdot\,)c_j)\,\odot\,
\tau(d_i^* g(\,\cdot\,)d_j),
\end{equation*}
and so~$\omega\circ \beta_\odot$
is ultraweakly continuous and bounded
by~\sref{product-functional},
because the $\sigma(c_i^*f(\,\cdot\,)c_j)$
and~$\tau(d_i^*g(\,\cdot\,)d_j)$
are bounded ultraweakly continuous functionals.
Although the bound for~$\omega\circ\beta_\odot$ 
thus obtained is in all probability nowhere near~$\|f\|\|g\|$,
it does allow
us by~\sref{tensor-universal-property}
to extend~$\omega\circ\beta_\odot$
to an ultraweakly continuous 
functional $\omega':=(\omega\circ\beta)_\otimes$ on~$\scrC\otimes \scrD$
with the same norm, $\|\omega'\|=\|\omega\circ\beta_\odot\|$.
Since this extension~$\omega'$
is completely positive
(because~$\beta$ and thus~$\omega\circ \beta$ are completely positive,
see~\sref{cp-bilinear})
its norm is by~\sref{cp-russo-dye} given by~$\|\omega'\|=\omega'(1)\equiv
\omega(f(1)\otimes g(1))\leq \|f\|\|g\|$,
where we used that~$\omega(1)\leq 1$.
Thus $\|\omega\circ \beta_\odot\|=\|\omega'\| \leq \|f\|\|g\|$,
as was claimed.

Incidentally,
since each~$\omega\circ \beta_\odot$
is ultraweakly continuous,
so is~$\beta_\odot$,
and thus~$\beta$ is normal.
The only thing that remains
is to make good on our last promise,
that~$\beta_\odot(s)^*\beta_\odot(s)\leq 
\|f\|\|g\|\beta_\odot(s^*s)$.
To this end,
write $s\equiv \sum_i a_i\odot b_i$,
and consider
the matrices~$A$ and~$B$ given by
\begin{equation*}
A\ :=\  \begin{pmatrix}
a_1 & a_2 & \dotsb & a_n \\
0 & 0 & \dotsb & 0 \\
\vdots & \vdots & \ddots&\vdots \\
0 & 0 & \dotsb & 0
\end{pmatrix}
\qquad\qquad
B\ :=\  \begin{pmatrix}
b_1 & b_2 & \dotsb & b_n \\
0 & 0 & \dotsb & 0 \\
\vdots & \vdots & \ddots&\vdots \\
0 & 0 & \dotsb & 0
\end{pmatrix},
\end{equation*}
and the cp-map $h\colon M_n(\scrC\otimes \scrD)\to \scrC\otimes \scrD$
given by~$h(C)= \left<(1,\dotsc,1), C(1,\dotsc,1)\right> =\sum_{ij}C_{ij}$.
We make these arrangements
so that we
may apply the inequality
$(M_nf)(A)^*  (M_nf)(A)
\leq \|(M_nf)(1)\| (M_nf)(A^*A)$
easily derived from~\sref{cp-cs}.
Indeed,
noting also~$\|(M_nf)(1)\|=\|f(1)\|=\|f\|$,
we have
\begin{alignat*}{3}
	\beta_\odot(s)^*\beta_\odot(s) 
\ &=\ \textstyle \sum_{ij}f(a_i)^*f(a_j)\otimes g(b_i)^*g(b_j)\\
\ &=\ h(\ 
(M_nf)(A)^* (M_nf)(A) \ \ (M_n \otimes)\ \ 
(M_ng)(B)^*(M_ng)(B) \ ) \\
\ &\leq\  
\|f\|\|g\| 
h(\ (M_nf)(A^*A) \ \ (M_n \otimes)\ \ 
(M_ng)(B^*B) \ ) 
\\
\ &=\  
\|f\|\|g\| \,\textstyle \sum_{ij} f(a_i^*a_j)\otimes g(b_i^*b_j) \\
\ &= \ \|f\|\|g\|\,\beta_\odot(s^*s),
\end{alignat*}
which concludes this proof.\qed
\end{point}
\end{point}
\begin{point}{40}[tensor-functor]{Exercise}%
Show that the assignments
$(\scrA,\scrB)\mapsto \scrA\otimes \scrB$,
and~$(f,g)\mapsto f\otimes g$
    give a bifunctor~$\Define{\otimes}\colon \Cat{C}\times\Cat{C}
\to\Cat{C}$
\index{*tensor@$\otimes$, tensor product!bifunctor 
on~$\W{miu},\dotsc$}%
\index{tensor product!of von Neumann algebras!functorial}
where~$\Cat{C}$
can be~$\W{miu}$, $\W{cp}$, $\W{cpu}$
or $\W{cpsu}$.
\end{point}
\begin{point}{50}[tensor-injective]{Proposition}%
Given injective nmiu-maps
$f\colon \scrA\to\scrC$ and~$g\colon \scrB\to\scrD$,
the nmiu-map $f\otimes g\colon \scrA\otimes \scrB\to
\scrC\otimes\scrD$ is injective.
\begin{point}{60}{Proof}%
The trick
is to consider the von Neumann subalgebra~$\scrT$
generated by
the elements of~$\scrC\otimes \scrD$
of the form~$f(a)\otimes g(b)$
where~$a\in\scrA$ and~$b\in\scrB$,
and to show that  the miu-bilinear map
$\gamma\colon \scrA\times\scrB\to\scrT$
given by~$\gamma(a,b)=f(a)\otimes g(b)$
is a tensor product of~$\scrA$ and~$\scrB$.
Indeed,
if this is achieved,
then
there is, by~\sref{tensor-uniqueness},
a unique nmiu-map $\varphi\colon \scrA\otimes\scrB\to\scrT$
with $\varphi(a\otimes b)=\gamma(a,b)
=f(a)\otimes g(b)$,
so that the following diagram commutes.
\begin{equation*}
\xymatrix@C=4em{
\scrA\times \scrB
\ar[rr]^-{f\times g}
\ar[rd]^-\gamma
\ar[d]_-\otimes
&
&
\scrC\times\scrD 
\ar[d]^-\otimes
\\
\scrA\otimes\scrB
\ar[r]|-\varphi
&
\scrT
\ar[r]|-\subseteq
&
\scrC\otimes\scrD
}
\end{equation*}
The map on the bottom side of this rectangle above is
none other than~$f\otimes g$,
and is thus,
being
the composition of the isomorphism~$\varphi$
with the inclusion $\scrT\subseteq \scrC\otimes\scrD$,
injective.

It remains to be shown that~$\gamma$
is a tensor product,
that is, obeys the conditions from~\sref{tensor}.
Condition~\ref{tensor-1}
holds simply by definition of~$\scrT$.
To see that~$\gamma$
obeys condition~\ref{tensor-2},
let np-functionals
$\tilde\sigma\colon \scrA\to\C$
and $\tilde\tau\colon \scrB\to\C$ be given;
we must find an np-functional $\gamma(\tilde\sigma,
\tilde\tau)$ on~$\scrT$
with $\gamma(\tilde\sigma,\tilde\tau)(a\otimes b)
= \gamma(a,b)$.

By ultraweak permanence
$\tilde\sigma$ and~$\tilde\tau$
can be extended along~$f$ and~$g$, respectively,
see~\sref{functional-extension},
giving us np-functionals $\sigma\colon \scrC\to\C$
and $\tau\colon\scrD\to\C$
with~$\tilde\sigma = \sigma\circ f$
and $\tilde\tau = \tau\circ g$.
Now simply take $\gamma(\tilde\sigma,\tilde\tau)$
to be the restriction
of $\sigma\otimes \tau$
to~$\scrT$,
which does the job.

Finally,
concerning
condition~\ref{tensor-3},
let~$z$ be a central projection of~$\scrT$
with $\gamma(\tilde\sigma,\tilde\tau)(z)=0$
for all~$\tilde\sigma$
and~$\tilde\tau$ of aforementioned type.
We must show that~$z=0$,
and for this
it suffices to show that
$(\sigma\otimes \tau)(z)=0$
for all  np-functionals
$\sigma$ and~$\tau$ on~$\scrC$ and~$\scrD$,
respectively.
Since for such~$\sigma$ and~$\tau$
we have
$\gamma(\tilde\sigma,\tilde\tau)
(\gamma(a,b))
 = 
 \sigma(f(a))\,\tau(g(b))
 = (\sigma\otimes\tau)(\gamma(a,b))$
 for all~$a\in\scrA$ and~$b\in\scrB$,
 we have $\gamma(\tilde\sigma,\tilde\tau)
 (t) = (\sigma\otimes \tau)(t)$
 for all~$t\in\scrT$,
 and, in particular,
 $0=\gamma(\tilde\sigma,\tilde\tau)(z)
 = (\sigma\otimes\tau)(z)$.
 Hence~$z=0$.\qed
\end{point}
\end{point}
\end{parsec}%
\subsection{Miscellaneous Properties}
\begin{parsec}{1160}%
\begin{point}{10}[product-functional-norm]{Lemma}%
Given von Neumann algebras~$\scrA$ and~$\scrB$,
we have $\|f\otimes g\|=\|f\|\|g\|$
for all~$f\in\scrA_*$ and~$g\in\scrB_*$.%
\index{*tensor@$\otimes$!$f\otimes g$, of normal functionals}
\begin{point}{20}{Proof}%
The trick is to use the polar decomposition
for normal functionals, \sref{polar-decomposition-of-functional}.
On its account we can find partial isometries $u\in\scrA$
and $v\in\scrB$
such that
$f(u(\,\cdot\,))$
and~$g(v(\,\cdot\,))$ are positive,
and
$f\equiv f(uu^*(\,\cdot\,))$,  $g\equiv g(vv^*(\,\cdot\,))$.
Then $u\otimes v$ is a partial isometry
such that $(f\otimes g)((u\otimes v)(\,\cdot\,))$
is positive,
and $f\otimes g
= (f\otimes g)(\,(u\otimes v)\, (u\otimes v)^*\,(\,\cdot\,)\,)$
so that $\|f\otimes g\|=(f\otimes g)(u\otimes v)
= f(u)g(v)=\|f\|\|g\|$ by~\sref{functional-norm}.\qed
\end{point}
\end{point}
\begin{point}{30}[tensor-simple-facts]{Exercise}%
There are some easily obtained facts
concerning the tensor product~$\scrA\otimes\scrB$
of von Neumann algebras
that nevertheless deserve explicit mention.
\begin{enumerate}
\item
Show that~$a\otimes b\geq 0$
for all~$a\in\scrA_+$ and~$b\in\scrB_+$;
and conclude that $a_1\otimes b_1 \leq a_2\otimes b_2$
for all
$a_1\leq a_2$ from~$\scrA$ and $b_1\leq b_2$ from~$\scrB$.
\item
Show that $\|a\otimes b\| = \|a\|\|b\|$
for all~$a\in\scrA$ and~$b\in\scrB$.

Conclude that $\otimes\colon \scrA\times\scrB\to\scrA\otimes \scrB$
is norm continuous.

(Warning: as~$\otimes$ is not linear
this is not entirely trivial.)
\item
Show that $\otimes\colon \scrA_*\times\scrB_*\to(\scrA\otimes\scrB)_*$
is norm continuous
(using~\sref{product-functional-norm}).
\item
Show that~$\otimes\colon \scrA\times \scrB\to \scrA\otimes \scrB$
is ultraweakly continuous.

(Hint: since we
already know that~$\otimes_\odot\colon \scrA\odot\scrB\to\scrA\otimes\scrB$
is ultraweakly continuous, by~\sref{tensor-basic},
an equivalent question 
is whether~$\odot\colon \scrA\times\scrB\to\scrA\odot\scrB$
is ultraweakly continuous,
which may be boiled down
to the fact
that $(a,b)\mapsto \sum_{ij} \sigma(a_i^* a a_j)\,\tau(b_i^* b b_j)\colon
\ \scrA\times \scrB\to\C$ is ultraweakly continuous,
where~$\sigma$ and~$\tau$ are np-functionals
on~$\scrA$ and~$\scrB$, respectively,
and
$a_1,\dotsc,a_n\in\scrA$, and~$b_1,\dotsc,b_n\in\scrB$.)
\item
Show that $a\otimes(\,\cdot\,)\colon \scrB\to \scrA \otimes \scrB$
is a ncp-map for every~$a\in\scrA$,
and that $1\otimes(\,\cdot\,)\colon \scrB\to \scrA\otimes \scrB$
is an nmiu-map.
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{31}%
The following observation will come in very handy later on when we prove that
\begin{equation*}
\scrA\otimes (\scrB\otimes \scrC)
    \cong (\scrA\otimes\scrB)\otimes \scrC,
    \qquad\text{and}\qquad
\scrA\otimes (\scrB\oplus\scrC)\cong\scrA\otimes \scrB
    \,\oplus\,\scrA\otimes \scrC,
\end{equation*}
see \sref{associator}, and \sref{tensor-distributes-over-sums}.
\end{point}
\begin{point}{40}[tensor-generation]{Proposition}
Let~$\scrA$ and~$\scrB$ 
be von Neumann algebras.
\begin{enumerate}
\item
\label{tensor-generation-1}
If~$S$ and~$T$ are subsets of~$\scrA$
and~$\scrB$, respectively,
whose linear span is ultraweakly dense,
then the linear span
of $\{\,s\otimes t\colon\,s\in S,\,t\in T\,\}$
is ultraweakly dense in~$\scrA\otimes\scrB$.
\item
\label{tensor-generation-2}
If~$\Omega$ and~$\Theta$ are centre separating collections
of np-functionals on~$\scrA$ and~$\scrB$, respectively,
then~$\{\,\omega\otimes\vartheta\colon\, 
\omega\in\Omega,\,\vartheta\in\Theta\,\}$
is centre separating for~$\scrA\otimes\scrB$.
\end{enumerate}%
\spacingfix%
\begin{point}{50}{Proof}%
Concerning~\ref{tensor-generation-1}:
Let~$S'$ and~$T'$ denote the linear spans of~$S$
and~$T$, respectively.
Since linear combinations of elements of~$\scrA\otimes\scrB$
of the form $a\otimes b$
lie ultraweakly dense in~$\scrA\otimes\scrB$ 
where~$a\in\scrA$ and~$b\in\scrB$,
it suffices to show that such element~$a\otimes b$
is the ultraweak limit of elements of the form $s'\otimes t'$
where~$s'\in S'$ and~$t'\in T'$
(because such~$s'\otimes t'$ are, of course, a linear combinations
of elements of the form $s\otimes t$ where $s\in S$
    and~$t\in T$.)

This is indeed the case
as there are nets $(s_\alpha')_\alpha$
and~$(t_\beta')_\beta$ in~$S'$ and~$T'$
that converge ultraweakly to~$a$ and~$b$, respectively,
and so, 
because~$\otimes$ is ultraweakly continuous by~\sref{tensor-simple-facts},
we see that~$s_\alpha'\otimes t_\beta'$
converges ultraweakly to~$a\otimes b$
as~$\alpha,\beta\to\infty$.

Concerning~\ref{tensor-generation-2},
let~$t$ be a positive element of~$\scrA\otimes \scrB$
with $(\omega\otimes \vartheta)(s^*ts)=0$
for all~$\omega\in\Omega$, $\vartheta\in\Theta$,
and~$s\in\scrA\otimes \scrB$;
we must show that~$t=0$.
For this it suffices
to show that~$(\sigma\otimes\tau)(t)=0$
for all np-functionals  $\sigma\colon \scrA\to\C$
and 
$\tau\colon\scrB\to\C$
(since the product functionals $\sigma\otimes\tau$
	form a faithful collection.)
Now, since~$\Omega$ is centre separating
such $\sigma$ may by~\sref{vn-center-separating-fundamental} be obtained
as operator norm limit of finite sums
of functionals of the
form~$\omega(a^*(\,\cdot\,)a)$
where~$\omega\in\Omega$ and~$a \in\scrA$.
Since an np-functional $\tau\colon \scrB\to\C$ 
can be obtained in a similar fashion
from~$\Theta$,
and~$\otimes \colon \scrA_*\otimes \scrB_*\to(\scrA\otimes\scrB)_*$
is operator norm continuous (by~\sref{tensor-simple-facts}),
we see that a product functional~$\sigma\otimes \tau$
can be obtained as the operator norm limit
of finite sums of functionals
of the form $\omega(a^*(\,\cdot\,)a)\,\otimes\,
\vartheta(b^*(\,\cdot\,)b)
\,\equiv\, (\omega\otimes\vartheta)(\,(a\otimes b)^*\,(\,\cdot\,)
\,(a\otimes b)\,)$;
and since those functionals 
map~$t$ to~$0$,
by assumption,
we conclude that~$(\sigma\otimes \tau)(t)=0$ too.\qed
\end{point}
\end{point}
\begin{point}{60}%
To obtain certain examples
the following characterisation of
the tensor product of von Neumann algebras
proves useful.
\end{point}
\begin{point}{70}[tensor-characterization]{Theorem}%
Given centre separating collections~$\Sigma$ and~$\Gamma$
of np-functionals
on von Neumann algebras~$\scrA$ and~$\scrB$,
respectively,
an miu-bilinear map
$\gamma\colon \scrA\times\scrB\to\scrT$
is a tensor product iff all of the following conditions hold.
\begin{enumerate}
\item
The range of~$\gamma$ generates~$\scrT$.
\item
For all~$\sigma\in \Sigma$ and $\tau\in\Gamma$
the product functional $\gamma(\sigma,\tau)\colon \scrT\to\C$
exists
(see~\sref{tensor})
 and is positive.
\item
The set
$\{\,\gamma(\sigma,\tau)\colon\,\sigma\in\Sigma,\,\tau\in \Gamma\,\}$
is centre separating for~$\scrT$.
\end{enumerate}
\spacingfix%
\begin{point}{80}{Proof}%
A tensor product~$\gamma$
obeys these conditions
by definition and by~\sref{tensor-generation},
so we only need to show that
a~$\gamma$ that obeys these conditions is a tensor product,
and for this it
suffices to show that~$\gamma$ can be extended
to an nmiu-isomorphism $\gamma_\otimes \colon \scrA\otimes\scrB\to \scrT$.
To extend~$\gamma$ to just an miu-map~$\gamma_\otimes$
(to begin with)
it suffices by~\sref{tensor-universal-property}
and~\sref{tensor-universal-property-extra} 
to show that~$\gamma_\odot\colon \scrA\odot\scrB\to\scrT$
is bounded with respect to the tensor product norm
on~$\scrA\odot\scrB$
and continuous with respect to the tensor product
topology on~$\scrA\odot \scrB$ and the ultraweak topology on~$\scrT$.

To see that~$\gamma_\odot$
is bounded, 
let~$t\in \scrA\odot\scrB$ be given;
we'll show
that~$\|\gamma_\odot(t)\|^2
\equiv \|\gamma_\odot(t^*t)\|\leq \|t\|^2$
where~$\|t\|$ is the tensor product norm of~$t$.
Since by~\sref{vn-center-separating-fundamental}
the np-functionals on~$\scrT$
of the form
\begin{equation}
	\label{tensor-characterization-1}	
	\gamma(\sigma,\tau)(\,\gamma_\odot(s)^*\,
(\,\cdot\,)\,\gamma_\odot(s)\,)
\end{equation}
where~$\sigma\in\Sigma$, $\tau\in\Gamma$
and~$s\in\scrA\odot\scrB$,
are order separating,
also with  the restriction
that~$1=\gamma(\sigma,\tau)(\gamma_\odot(s^*s))\equiv
(\sigma\odot\tau)(s^*s)$,
and therefore determine the norm of~$t^*t$ as in~\sref{order-separating-norm},
it suffices to show that
$\gamma(\sigma,\tau)(\gamma_\odot(s)^* \gamma_\odot(t^*t)
\gamma_\odot(s)) \leq \|t\|^2$
given such~$\sigma$, $\tau$, and~$s$
(with $(\sigma\odot \tau)(s^*s)=1$).
But since $
\gamma(\sigma,\tau)(\gamma_\odot(s)^* \gamma_\odot(t^*t)\gamma_\odot(s)) =
(\sigma\odot\tau)(s^* t^*t s)
= \|t\|_{(\sigma\odot\tau)(s^*(\,\cdot\,)s)}^2
\leq \|t\|^2$
by the definition of the tensor product norm
(see~\sref{tensor-extra}),
this is indeed the case.

To see that $\gamma_\odot\colon \scrA\odot\scrB\to\scrT$
is ultraweakly continuous
it suffices to show that  $\omega\circ \gamma_\odot$
is the operator norm limit of finite sums of basic functionals
on~$\scrA\odot\scrB$
(see~\sref{tensor-extra})
given any np-functional $\omega\colon \scrT\to\C$.
Since by~\sref{vn-center-separating-fundamental} such~$\omega$
is the norm limit
of finite sums of
functionals on~$\scrT$
of the form displayed in~\eqref{tensor-characterization-1},
and~$\gamma_\odot$
is bounded,
we may assume without loss of generality
that~$\omega$
itself is as shown in~\eqref{tensor-characterization-1}.
Since $\omega\circ \gamma_\odot 
\equiv (\sigma\odot\tau)(s^*(\,\cdot\,)s)$
is then a basic functional $\gamma_\odot$
is ultraweakly continuous.

Having established boundedness and continuity
of~$\gamma_\odot$
we obtain our  nmiu-map $\gamma_\otimes\colon \scrA\otimes\scrB
\to\scrT$
with~$\gamma_\otimes(a\otimes b)=\gamma(a,b)$
for all~$a\in\scrA$ and~$b\in \scrB$.
To show that~$\gamma$ is a tensor product,
it suffices
to show that~$\gamma_\otimes$
is an nmiu-isomorphism,
and for this,
it suffices
to show that~$\gamma_\otimes$ is a bijection.
In fact, 
we only need to show that~$\gamma_\otimes$ is injective,
because since the elements
of~$\scrT$ of the form~$\gamma(a,b)\equiv\gamma_\otimes(a\otimes b)$
generate~$\scrT$ (by assumption),
and are in the range of~$\gamma_\otimes$
(which is a von Neumann subalgebra of~$\scrT$
by~\sref{injective-nmiu-iso-on-image}),
$\gamma_\otimes$ will be surjective.

To show that~$\gamma_\otimes$ is injective,
it suffices to show that~$\ceil{\gamma_\otimes}\equiv\cceil{\gamma_\otimes}
=1$
(see~\sref{carrier-miu}).
Since the product functionals on $\scrA\otimes\scrB$
of the form $\sigma\otimes \tau$
where~$\sigma\in\Sigma$ and~$\tau\in\Gamma$
are centre separating (by~\sref{tensor-generation}),
and~$\cceil{\gamma_\otimes}$ is central,
it suffices to show that
$(\sigma\otimes\tau)(\,\cceil{\gamma_\otimes}^\perp\,)=0$
given~$\sigma\in\Sigma$ and~$\tau\in\Gamma$.
But this is easy ---
$(\sigma\otimes \tau)(\,\cceil{\gamma_\otimes}^\perp \,)
=
\gamma(\sigma, \tau)(\gamma_\otimes(\,\cceil{\gamma_\otimes}^\perp \,))
= 0$.
Whence~$\gamma$ is a tensor product.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}{1170}%
\begin{point}{10}%
Using the characterization from~\sref{tensor-characterization}
it is pretty 
easy to see that the tensor product distributes
over (infinite) direct sums
(see~\sref{tensor-distributes-over-sums})
after some unsurprising
observations regarding direct sums
(in~\sref{sum-generation}).
\end{point}
\begin{point}{20}[sum-generation]{Exercise}%
Let~$(\scrA_i)_{i\in I}$
be a collection of von Neumann algebras.
\begin{enumerate}
\item
Show that
given a generating subset~$A_i$ 
for each von Neumann algebra~$\scrA_i$
the set $\bigcup_{i\in I} \kappa_i(A_i)$ 
generates~$\bigoplus_{i\in I} \scrA_i$,
where~$\kappa_i\colon \scrA_i\to\bigoplus_{i\in I} \scrA_i$
denotes
the np-map given by~$(\kappa_i(a))_i=a$ and~$(\kappa_i(a))_j=0$
when~$j\neq i$.
\item
Show that
given a centre separating collection~$\Omega_i$
of np-functionals on~$\scrA_i$
for each~$i\in I$
the collection $\{\,\omega\circ \pi_i\colon \,
\omega\in\Omega_i,\,i\in I\,\}$
is centre separating for~$\bigoplus_{i\in I}\scrA_i$.
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{30}[tensor-distributes-over-sums]{Proposition}%
Given von Neumann algebras
$\scrA$ and~$(\scrB_i)_{i\in I}$
the bilinear map
\begin{equation*}
	\textstyle
	\gamma\colon 
	\ 
	\scrA \times \bigoplus_i \scrB_i
	\longrightarrow \bigoplus_i \scrA\otimes \scrB_i,\ 
	(a,b)\mapsto (a_i\otimes b)_i
\end{equation*}
is a tensor product.
(Whence~$\scrA\otimes \bigoplus_i \scrB_i
\cong \bigoplus_i\scrA\otimes \scrB_i$.)
\begin{point}{40}{Proof}%
We use~\sref{tensor-characterization}
to show that~$\gamma$ is a tensor product.
Note that
$\gamma$ is clearly miu-bilinear,
and that
the elements of the form $\gamma(a,\kappa_i(b))
= \kappa(a\otimes b)$
from the range of~$\gamma$
where~$a\in \scrA$, $i\in I$, and~$b\in\scrB_i$ 
generate~$\bigoplus_i\scrA \otimes\scrB_i$ by~\sref{sum-generation}.
Further, since
given $i\in I$ and np-functionals
$\sigma\colon \scrA\to\C$ and
$\tau\colon \scrB_i\to\C$
the product functional $\gamma(\sigma,\tau\circ \pi_i)$
exists being simply~$(\sigma\otimes \tau)\circ\pi_i
\colon \bigoplus_i \scrA\otimes \scrB_i\to\C$,
and such product functionals form  a centre separating collection 
by~\sref{sum-generation},
we see that~$\gamma$ is indeed a tensor product.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}{1180}%
\begin{point}{10}%
The tensor interacts
with projections as expected.
\end{point}
\begin{point}{20}{Lemma}%
Let~$\scrA$ and~$\scrB$ be von Neumann algebras.
\begin{enumerate}
\item
We have $\ceil{a\otimes b} = \ceil{a}\otimes \ceil{b}$
for all~$a\in\scrA_+$ and~$b\in\scrB_+$.
\item
We have~$\cceil{a\otimes b} = \cceil{a}\otimes \cceil{b}$
for all~$a\in\scrA$ and~$b\in\scrB$.
\end{enumerate}
\spacingfix%
\begin{point}{30}{Proof}%
Let~$a\in\scrA_+$ and~$b\in\scrB_+$ be given.
Since the map~$(\,\cdot\,)\otimes b\colon \scrA\to \scrA\otimes \scrB$
is np,
$\ceil{a\otimes b}
\smash{\overset{\sref{ncp-ceil}}{=\joinrel=\joinrel=}}
\ceil{\ceil{a}\otimes b}$.
Since similarly~$\ceil{\ceil{a}\otimes b}
=\ceil{\,\ceil{a}\otimes \ceil{b}\,}
\equiv \ceil{a}\otimes\ceil{b}$
using here that~$\ceil{a}\otimes\ceil{b}$
is already a projection,
we get~$\ceil{a}\otimes \ceil{b}=\ceil{a\otimes b}$.

Let~$a\in\scrA$ and~$b\in\scrB$ be given
in order to prove that~$\cceil{a\otimes b}
=\cceil{a}\otimes\cceil{b}$.
Since~$\cceil{a}\otimes 1$ 
commutes with all elements of~$\scrA\otimes \scrB$
of the form~$a'\otimes b'$,
and thus with all elements of~$\scrA\otimes \scrB$,
we see that~$\cceil{a}\otimes 1$ is central.
Since similarly $1\otimes\cceil{b}$ is central,
we see that~$\cceil{a}\otimes \cceil{b}
= (\cceil{a}\otimes 1)\otimes(1\otimes \cceil{b})$
is central too.
Since
in addition 
$\cceil{a}\otimes\cceil{b}$
is a projection,
and $(\cceil{a}\otimes\cceil{b})\,(a\otimes b)
= (\cceil{a}a)\otimes (\cceil{b}b)
= a\otimes b$
we see that~$\cceil{a\otimes b}\leq \cceil{a}\otimes \cceil{b}$
(by definition, see~\sref{central support}).

So all that remains is to show that~$\cceil{a}\otimes\cceil{b}
\leq \cceil{a\otimes b}$.
Recall that~$\cceil{a}= \bigcup_{\tilde{a}\in\scrA}
\ceil{\tilde{a}^* a^*a\tilde{a}}$
by~\sref{cceil-fundamental}.
Using this,  a similar
expression for~$\cceil{b}$,
and~\sref{ncp-union},
we see that~$\cceil{a}\otimes \cceil{b}
=\bigcup_{\tilde{a}\in\scrA}
\bigcup_{\tilde{b}\in\scrB}
\ceil{ \smash{(\tilde{a}^*a^*a\tilde{a})
\otimes (\tilde{b}^*b^*b\tilde{b})} }$,
and so it suffices to show that 
$\ceil{\smash{(\tilde{a}^*a^*a\tilde{a})
\otimes (\tilde{b}^*b^*b \tilde{b})}}
\leq \cceil{a\otimes b}$
given~$\tilde{a}\in\scrA$
and~$\tilde{b}\in\scrB$.
This is indeed the case
since
$\ceil{\smash{(\tilde{a}^*a^*a\tilde{a})
\otimes (\tilde{b}^*b^*b \tilde{b})}} 
=
\ceil{\smash{(\tilde{a}\otimes\tilde{b})^*\,
	(a \otimes b)^*(a\otimes b) \,
(\tilde{a}\otimes \tilde{b})}}
\leq \cceil{a\otimes b}$
(by~\sref{cceil-fundamental}, again.)\qed
\end{point}
\end{point}
\begin{point}{40}[carrier-tensor]{Exercise}%
Let~$f\colon \scrA\to\scrB$
and~$g\colon \scrC\to\scrD$ be np-maps
between von Neumann algebras.
We're going to prove that~$\ceil{f\otimes g}
=\ceil{f}\otimes \ceil{g}$.
\begin{enumerate}
\item
Show that~$(f\otimes g)(\ceil{f}\otimes\ceil{g})=1\otimes 1$,
and conclude that~$\ceil{f\otimes g} \leq\ceil{f}\otimes\ceil{g}$.
\item
Assume for the moment that~$\scrA$
and~$\scrC$ are von Neumann algebras
of bounded operators on Hilbert spaces~$\scrH$
and~$\scrK$, respectively,
and that~$f$ and~$g$ are vector functionals,
that is, $\scrB=\scrD=\C$,
and~$f=\left<x,(\,\cdot\,)x\right>$
for some~$x\in\scrH$,
and
$g=\left<y,(\,\cdot\,)y\right>$
for some
$y\in \scrK$.

Show that~$\ceil{f}=\bigcup_{a\in\scrA^\square}
\ceil{\,a^* \ketbra{x}{x} a\,}$
using~\sref{carrier-vector-state}
and~\sref{double-commutant}.

\item
With the same assumptions as in the previous
point,
suppose, furthermore, without loss of generality
that~$\scrA\otimes \scrB$
is
given as the von Neumann subalgebra of~$\scrB(\scrH\otimes \scrK)$
generated by the operators~$A\otimes B$
where~$A\in\scrA$ and~$B\in\scrB$
(cf.~\sref{special-tensor}).

Show that~$f\otimes g = \left<x\otimes y,(\,\cdot\,)x\otimes y\right>$.

Given~$a\in\scrA^\square$ and~$b\in\scrB^\square$
show that $a\otimes b \in (\scrA\otimes \scrB)^\square$,
and thus
\begin{equation*}
	\ceil{a^* \ketbra{x}{x}a}\otimes
\ceil{b^* \ketbra{y}{y}b} \,\leq\, \ceil{f\otimes g}.
\end{equation*}

Deduce from this that~$\ceil{f}\otimes \ceil{g}\leq \ceil{f\otimes g}$,
so~$\ceil{f}\otimes \ceil{g}= \ceil{f\otimes g}$.
\item
Let~$f$ and~$g$ be arbitrary again,
and assume now that~$f$ and~$g$ are functionals,
that is, $\scrB=\scrD=\C$.
Show that~$\ceil{f\otimes g}=\ceil{f}\otimes \ceil{g}$.
\item
Let~$f$ and~$g$ be arbitrary again,
and recall
from~\sref{ultracyclic-basic}
that~$1=\bigcup_{\sigma}\ceil{\sigma}$
when~$\sigma$ ranges over the np-functionals
$\sigma$ on~$\scrB$.

Show that~$1\otimes 1 
= \bigcup_{\sigma,\tau}\ceil{\sigma \otimes \tau}$
where~$\sigma$ and~$\tau$
range over the np-functionals
on~$\scrB$ and~$\scrD$, respectively.

Show using~\sref{diamond-suprema}
and~\sref{diamond-composition}
that
$\ceil{f\otimes g} \equiv
(f\otimes g)_\diamond(1\otimes 1)
= \ceil{f}\otimes \ceil{g}$.
\item
Show that $(f\otimes g)_\diamond (s\otimes t)
= f_\diamond(s)\otimes g_\diamond(t)$
for projections
$s\in \scrB$
and~$t\in \scrD$.
\end{enumerate}
\spacingfix%
\end{point}%
\end{parsec}%
\subsection{Monoidal Structure}
\begin{parsec}{1190}%
\begin{point}{10}%
Up to this point
we have only written about the tensor product~$\scrA\otimes \scrB$
of \emph{two} von Neumann algebras
(to save ink),
but all of it,
as you will no doubt have observed already,
can be easily adapted 
to deal with
a tensor product
$\otimes\colon \scrA_1\times\dotsc\times \scrA_n
\to\scrA_1\otimes \dotsb\otimes \scrA_n$
of a tuple $\scrA_1,\dotsc,\scrA_n$ of von Neumann algebras,
which will then, of course, be a multilinear map
instead of a bilinear map, etc..

What is less obvious
is that there should be any relation
between 
$(\scrA\otimes\scrB)\otimes \scrC$,
and 
$\scrA\otimes (\scrB\otimes \scrC)$
and~$\scrA\otimes\scrB\otimes\scrC$;
but there is.
\end{point}
\begin{point}{20}{Proposition}%
Given von Neumann algebras~$\scrA$, $\scrB$ and~$\scrC$,
the trilinear map $\gamma\colon (a,b,c)\mapsto (a\otimes b)\otimes c,\ 
\scrA\times\scrB\times\scrC \to (\scrA\otimes \scrB)\otimes\scrC$
is a tensor product.
\begin{point}{30}{Proof}%
We need to verify the three conditions
from~\sref{tensor} (adapted
to trilinear maps).
The first condition,
that the elements of the form~$(a\otimes b)\otimes c$
generate $(\scrA\otimes \scrB)\otimes \scrC$
follows
by~\sref{tensor-generation}
since
the elements of the form~$a\otimes b$
generate~$\scrA\otimes \scrB$
(and~$\scrC$ generates~$\scrC$).
The second condition
is met by defining
$\gamma(\sigma,\tau,\upsilon):= (\sigma\otimes\tau)\otimes\upsilon$
for all np-functionals
$\sigma\colon \scrA\to\C$,
$\tau\colon \scrB \to\C$
and~$\upsilon\colon \scrC\to\C$.
Finally,
these product functionals
$\gamma(\sigma,\tau,\upsilon)$
are centre separating by~\sref{tensor-generation}
because
the functionals on~$\scrA\otimes \scrB$
of the form $\sigma\otimes\tau$
are centre separating (and so is
the set of all np-functionals on~$\scrC$),
which was the third condition.\qed
\end{point}
\end{point}
\begin{point}{40}[associator]{Corollary}%
There is a unique nmiu-isomorphism
\begin{equation*}
    \Define{\alpha_{\scrA,\scrB,\scrC}}\colon 
    \, \scrA\otimes(\scrB\otimes \scrC)
\longrightarrow  (\scrA \otimes \scrB)\otimes\scrC,
\end{equation*}%
    called an \Define{associator}\index{associator}%
\index{alpha@$\alpha_{\scrA,\scrB,\scrC}$, associator},
with $\alpha_{\scrA,\scrB,\scrC}
    (\,a\otimes(b\otimes c)\,)=(a\otimes b)\otimes c$
for all~$a\in\scrA$, $b\in\scrB$, $c\in\scrC$,
for any von Neumann algebras
$\scrA$, $\scrB$, $\scrC$.
\end{point}
\begin{point}{41}%
If the point above means that~$\otimes$
is associative,
then the following two points
mean that~$\otimes$ has~$\C$ as its unit,
and~$\otimes$ is commutative, respectively.
\end{point}
\begin{point}{42}{Exercise}%
Show that given a von Neumann algebra~$\scrA$
the bilinear maps $(z,a)\mapsto za\colon \C\times \scrA\to\scrA$
    and $(a,z)\mapsto za\colon \scrA\times \C\to\scrA$
are tensor products,
and deduce from this that there are unique nmiu-isomorphisms
\begin{equation*}
\Define{\lambda_\scrA}\colon \C\otimes\scrA\longrightarrow\scrA,
\qquad
    \text{and,}\qquad
\Define{\varrho_\scrA}\colon \scrA\otimes\C\longrightarrow\scrA,
\end{equation*}%
    called a \Define{left} and \Define{right unitor}\index{unitor}%
\index{rho@$\varrho_\scrA$, right unitor}%
\index{lambda@$\lambda_\scrA$, left unitor},
respectively,
    with~$\lambda_\scrA(z\otimes a)=za=\varrho_\scrA(a\otimes z)$ for all~$a\in\scrA$
and~$z\in\C$.
\end{point}
\begin{point}{43}{Exercise}
Show that given von Neumann algebras~$\scrA$ and~$\scrB$
the bilinear map $(a,b)\mapsto b\otimes a\colon \scrA \otimes \scrB
\longrightarrow \scrB\otimes \scrA$
is a tensor product,
and deduce from this that there is a unique nmiu-isomorphism
\begin{equation*}
    \Define{\gamma_{\scrA,\scrB}}\colon \scrA\otimes\scrB\longrightarrow
    \scrB\otimes\scrA,
\end{equation*}
called a \Define{braiding}\index{braiding}%
\index{gamma@$\gamma_{\scrA,\scrB}$, braiding},
    with $\gamma_{\scrA,\scrB}(a\otimes b)=b\otimes a$
    for all~$a\in\scrA$ and~$b\in\scrB$.
\end{point}
\begin{point}{50}[vn-smc]{Theorem}%
Endowed with the tensor product,
$\W{miu}$, $\W{cp}$, $\W{cpu}$,
and~$\W{cpsu}$ are symmetric monoidal categories\cite{maclane}
with~$\C$ as unit.
\begin{point}{51}{Proof}%
The first order of business is showing that
the associators $\alpha_{\scrA,\scrB,\scrC}$
(from~\sref{associator})
form a natural transformation
    in~$\W{cp}$
    (and thus in~$\W{miu}$,
    $\W{cpu}$, and $\W{cpsu}$ too,
    as the $\alpha_{\scrA,\scrB,\scrC}$'s are nmiu),
that is, 
that the following diagram commutes
\begin{equation}
    \label{eq:tensor-alpha-natural}
    \xymatrix@C=4em{
\scrA\otimes(\scrB\otimes\scrC)
    \ar[r]^-{f\otimes(g\otimes h)}
    \ar[d]_-{\alpha_{\scrA,\scrB,\scrC}}
&
\scrA'\otimes(\scrB'\otimes\scrC')
    \ar[d]^-{\alpha_{\scrA',\scrB',\scrC'}}
\\
(\scrA\otimes\scrB)\otimes\scrC
    \ar[r]^-{(f\otimes g)\otimes h}
&
(\scrA'\otimes \scrB')\otimes \scrC'
}
\end{equation}
for all ncp-maps $f\colon \scrA\to \scrA'$,
    $g\colon \scrB\to\scrB'$,
    and $h\colon \scrC\to\scrC'$.
Note that by both routes through this diagram
$a\otimes (b\otimes c)$
gets mapped to $(f(a)\otimes g(b))\otimes h(c)$
for all~$a\in\scrA$, $b\in\scrB$, and~$c\in \scrC$.
Since the linear span of such
$a\otimes (b\otimes c)$'s
is ultraweakly dense in~$\scrA\otimes(\scrB\otimes \scrC)$
    (by~\sref{tensor-generation},)
this entails that~\eqref{eq:tensor-alpha-natural} commutes.

By a similar but simpler argument one sees
that the braidings ($\gamma_{\scrA,\scrB}$) and unitors
($\lambda_\scrA$ and $\varrho_\scrA$)
give natural transformations.
\begin{point}{52}%
It remains to be shown
that the appropriate coherence relations hold.
Given von Neumann algebras $\scrA$, $\scrB$,
$\scrC$, and~$\scrD$,
the pentagon
    \newcommand{\wrapcell}[1]{\hbox to 2em{\hss $#1$\hss}}
\begin{equation*}
\xymatrix@C=.1em@R=3em{
    && \wrapcell{(\scrA\otimes \scrB)\otimes (\scrC\otimes \scrD) } 
    \ar[rrd]^{\alpha_{\scrA\otimes\scrB,\scrC,\scrD}}
    && \\
    \wrapcell{\scrA\otimes(\scrB\otimes (\scrC \otimes \scrD))}
    \ar[rru]^{\alpha_{\scrA,\scrB,\scrC\otimes\scrD}}
    \ar[ddr]|{\id_\scrA\otimes\alpha_{\scrB,\scrC,\scrD}}
    &&&&
    \wrapcell{((\scrA\otimes \scrB)\otimes \scrC)\otimes \scrD}
    \\
    \\
    & 
    {\scrA\otimes((\scrB\otimes \scrC)\otimes\scrD)}
    \ar[rr]_{\alpha_{\scrA,\scrB\otimes\scrC,\scrD}}
    &&
    {(\scrA\otimes (\scrB\otimes \scrC))\otimes\scrD}
    \ar[ruu]|{\alpha_{\scrA,\scrB,\scrC}\otimes \id_\scrD}
}
\end{equation*}
commutes,
since by both routes
the elements in~$\scrA\otimes(\scrB\otimes (\scrC\otimes \scrD))$
of the form $a\otimes (b\otimes (c\otimes d))$
(whose linear span is ultraweakly dense)
get sent to $((a\otimes b)\otimes c)\otimes d$.

By similar arguments the diagrams
\begin{equation*}
\xymatrix{
    \scrA\otimes(\C\otimes \scrC)
    \ar[rr]^{\alpha_{\scrA,\C,\scrC}}
    \ar[rd]_{\id_\scrA\otimes \lambda_\scrC}
    &
    &
    (\scrA\otimes \C)\otimes \scrC
    &
    \C\otimes \C 
    \ar@/_1em/[d]_{\varrho_\C}
    \ar@/^1em/[d]^{\lambda_\C}
    \\
    &
    \scrA\otimes \scrC
    \ar[ru]_{\varrho_\scrA\otimes \id_\scrC}
    &
    &
    \C
}
\end{equation*}
commute, as does the diagram
\begin{equation*}
\xymatrix@C=4em{
    \scrA\otimes(\scrB\otimes \scrC)
    \ar[r]^{\alpha_{\scrA,\scrB,\scrC}}
    \ar[d]_{\id_\scrA\otimes\gamma_{\scrB,\scrC}}
    &
    (\scrA\otimes\scrB)\otimes\scrC
    \ar[r]^{\gamma_{\scrA\otimes\scrB,\scrC}}
    &
    \scrC\otimes(\scrA\otimes\scrB)
    \ar[d]^{\alpha_{\scrC,\scrA,\scrB}}
    \\
    \scrA\otimes(\scrC\otimes \scrB)
    \ar[r]_{\alpha_{\scrA,\scrC,\scrB}}
    &
    (\scrA\otimes \scrC)\otimes \scrB
    \ar[r]_{\gamma_{\scrA,\scrC}\otimes \id_\scrB}
    &
    (\scrC\otimes \scrA)\otimes \scrB
},
\end{equation*}
and do the diagrams
\begin{equation*}
\xymatrix{
\scrA\otimes\scrB
    \ar[r]^{\gamma_{\scrA,\scrB}}
    \ar[rd]_{\id_{\scrA\otimes \scrB}}
&
\scrB\otimes \scrA
    \ar[d]^{\gamma_{\scrB,\scrA}}
&
    &
\scrB\otimes\C
    \ar[r]^{\gamma_{\scrB,\C}}
    \ar[rd]_{\varrho_{\scrB}}
&
\C\otimes \scrB
    \ar[d]^{\lambda_\scrB}
\\
&
\scrA\otimes \scrB
&
    &
&
\scrB
}.
\end{equation*}
Thus $\W{miu}$, $\W{cp}$, $\W{cpu}$,
and~$\W{cpsu}$ are symmetric monoidal categories.\qed
\end{point}
\end{point}
\end{point}
\end{parsec}
\section{Quantum Lambda Calculus}
\label{S:model}
\begin{parsec}{1200}%
\begin{point}{10}[qlcm-intro]%
In this section we provide
the parts needed
to build a model
	of the quantum lambda calculus\index{quantum lambda calculus}
using von Neumann algebras.
We will not venture
to describe the quantum lambda calculus
in all its details here,
nor will we describe how to build the model
from these parts
(as we did in~\cite{model});
we'll just touch upon
the two key ingredients:
the interpretation of ``$\bang$'' and ``$\limp$''%
 \index{*bang@$\bang$}\index{*lollypop@$\limp$}
---
with them the expert
can easily produce the model.

Let us, nevertheless, try to give some impression to those who are not familiar 
with the quantum lambda calculus.
The quantum lambda calculus is a type theory
proposed by Selinger and Valiron in~\cite{selinger2005,selinger2006}
to describe programs for quantum computers
especially designed
to include 
not only
function types ($\limp$)
and
classical data types (such as~$\bit$),
but also quantum data types
(such as $\qbit$),
so that there can be a term such as
$\mathsf{new}\colon \bit\limp \qbit$
that represents the program
that initialises a qubit in the given state.
There are of course also terms
such as
$\mathsf{0}\colon \bit$
and~$\mathsf{1}\colon \bit$,
so that~$\mathsf{new}\,\mathsf{0}\colon \qbit$
represents a qubit in state~$\ket{0}$.
The addition of quantum data 
to a type theory
is a very delicate matter
for if one were to allow
for example
in this system
a variable to be used twice
(a thing usually beyond dispute)
it would not take much more
to construct
a program
that duplicates the contents
of a qubit,
which is nonphysical.

Still, classical data
such as a bit
can be duplicated freely,
so to accommodate this 
the type~$\bang \bit$ is used.
More precisely,
the type
$\bang A$
represents that part of the type of~$A$ that is duplicable,
so that~$\bang \bit$
is the proper type for a bit,
and $\bang\qbit$ is empty.
For example,
the term that represents the measurement
of a qubit is~$\mathsf{meas}\colon \qbit\limp \bang\bit$,
where the~$\bang$ indicates that the bit resulting from the measurement
may be duplicated freely.

The model
we alluded to
assigns to each type~$A$ a von Neumann algebra~$\sem{A}$,%
\index{*sem@$\sem{\,\cdot\,}$}
e.g.~$\sem{\qbit}=M_2$
and~$\sem{\bit}=\C^2$.
A (closed) term~$t:A$
is interpreted as an npsu-functional $\sem{t:A}\colon \sem{A}\to\C$,
so for example $\sem{\mathsf{0}\colon \bit}\colon
(x,y)\mapsto x\colon \C^2\to\C$.
When~$t:A$ has free variables $x_1:B_1,\dotsc,x_N:B_N$
the interpretation 
becomes an ncpsu-map $\sem{t}\colon \sem{A}\to\sem{B_1}\otimes 
\dotsb \otimes \sem{B_N}$,
so for example,
\begin{equation*}
	\sem{\, x\colon \qbit \vdash \mathsf{meas} x\,}
\colon (x,y)\mapsto
\smash{\bigl(
	\begin{smallmatrix}x& 0 \\ 0 & y
	\end{smallmatrix}\bigr)}
\colon \C^2\to M_2.
\end{equation*}
In short, there are no surprises here.
As said, the difficulty lies
in the definition
of $\sem{!A}$ and~$\sem{A\limp B}$,
for which we will provide the following
three ingredients.
\begin{itemize}
\item
The observation (by Kornell, \cite{kornell2012})
that
the category 
$\op{(\W{miu})}$
is monoidal closed,
that is,
that
for every von Neumann algebra~$\scrB$,
the functor
$\scrB\otimes (\,\cdot\,)\colon 
\W{miu}\to \W{miu}$
has a left adjoint
$(\,\cdot\,)^{*\scrB}$.

\item
The following two adjunctions.
\begin{equation*}
\xymatrix@C=6em{
	\Cat{Set}
	\ar@/^1.0em/[r]^-{\ell^\infty}
	\ar@{}[r]|-{\perp}
	&
	\op{(\W{miu})}
	\ar@/^1.0em/[r]^-{\subseteq}
	\ar@/^1.0em/[l]^-{\nsp:=\W{miu}(-,\C)}
	\ar@{}[r]|-{\perp}
	&
	\op{(\W{cpsu})}
	\ar@/^1.0em/[l]^-{\mathcal{F}}
}
\end{equation*}
\end{itemize}
The interpretation of~$\sem{!A}$
and~$\sem{A\limp B}$ will then be
\begin{equation*}
\sem{!A}\ =\ 
\linf(\nsp(\sem{A}))
\qquad\text{and}\qquad
\sem{A\limp B}
\ = \ 
\mathcal{F}(\sem{B})^{*\sem{A}}.
\end{equation*}%
By the universal properties of~$\mathcal{F}$
and~$(\,\cdot\,)^{*\scrB}$,
an ncpsu-map $f\colon \scrA\rightarrow \scrC\otimes \scrB$
corresponds to unique nmiu-map 
$\Lambda(f)\colon \mathcal{F}(\scrA)^{*\scrB}\longrightarrow \scrC$.
This is used to interpret 
the ``$\lambda$'':
\begin{equation*}
    \sem{\lambda x^B. t}
    \,=\, \Lambda(\sem{t})\colon \mathcal{F}(\sem{A})^{\sem{B}}
    \longrightarrow\sem{B_1}\otimes\dotsb\otimes\sem{B_N}
\end{equation*}
for any term  $t:A$  with free variables
$x_1:B_1$, \ldots, $x_N:B_N$, $x:B$,
so  
\begin{equation*}
\sem{t} \colon \sem{A}\longrightarrow 
\sem{B_1}\otimes\dotsb\otimes\sem{B_N}\otimes \sem{B}.
\end{equation*}

Note that~$\sem{!A}$
will always be a `discrete' commutative von Neumann algebra
no matter how complicated~$\sem{A}$ may be,
so that although this does the job
perhaps a more interesting interpretation of~$\bang$
may be chosen as well.
This is not the case:
in the next
section we'll show that
any von Neumann algebra
that carries 
a $\otimes$-monoid structure
(such as $\sem{!A}$)
is commutative and discrete,
and that~$\linf(\nsp(\scrA))$
is moreover the free $\otimes$-monoid
on~$\scrA$.
\end{point}
\begin{point}{20}%
In~\cite{qlc} the quantum lambda calculus
is extended with recursion via the ``$let\ rec$''
operator;
we don't know whether it's possible to interpret
    $let\ rec$ in our model.
\end{point}
\end{parsec}
\begin{parsec}{1210}%
\begin{point}{10}%
In this section,
we'll need the following result
from the literature on von Neumann algebras.
\end{point}
\begin{point}{20}[intersection-tensor]{Proposition}%
Given Hilbert spaces~$\scrH$ and~$\scrK$,
and von Neumann subalgebras~$\scrA_1$ and~$\scrA_2$
of~$\scrB(\scrH)$
and von Neumann subalgebras~$\scrB_1$ and~$\scrB_2$
of~$\scrB(\scrK)$,
we have 
\begin{equation*}
(\scrA_1 \otimes  \scrB_1)\,\cap\,
(\scrA_2 \otimes \scrB_2)
= (\scrA_1\cap\scrA_2)\,\otimes\,
(\scrB_1\cap \scrB_2).
\end{equation*}
Here
$\scrA_1 \otimes \scrB_1$
denotes not just any tensor product of~$\scrA_1$ and~$\scrB_1$,
but instead
the ``concrete'' tensor product 
of~$\scrA_1$ and~$\scrB_1$:
the least von Neumann subalgebra of~$\scrB(\scrH\otimes\scrK)$
that contains all operators
of the form $A\otimes B$ where~$A\in\scrA_1$
and~$B\in\scrB_1$.
\begin{point}{30}[intersection-tensor-proof]{Proof}%
See Corollary IV.5.10 of~\cite{Takesaki1}.\qed
\end{point}
\end{point}
\end{parsec}
\subsection{First Adjunction}
\begin{parsec}{1220}%
\begin{point}{10}{Definition}%
We write $\Define{\nsp}:=\W{miu}(\,\cdot\,,\C)$
	\index{nsp@$\nsp\colon \op{(\W{miu})}\to \Cat{Set}$}
for the functor $\op{(\W{miu})}\to \Cat{Set}$
which maps a von Neumann algebra~$\scrA$
to its set
of nmiu-functionals,
$\nsp(\scrA)$,
and sends an nmiu-map $f\colon \scrA\to\scrB$
to the map~$\nsp(f)\colon \nsp(\scrB)\to\nsp(\scrA)$
given by~$\nsp(f)(\varphi)=\varphi \circ f$
for~$\varphi \in \nsp(\scrB)$.
\end{point}
\begin{point}{20}[first-adjunction]{Proposition}%
Given a set~$X$
the map
\begin{equation*}
\eta\colon X\to\nsp(\linf(X))
\qquad\text{given by}\qquad
	\eta(x)(h)\ =\ h(x)
\end{equation*}
is universal
in the sense that for every 
map $f\colon X\to\nsp(\scrA)$,
where~$\scrA$ is a von Neumann algebra,
there is a unique
nmiu-map $g\colon \scrA\to\linf(X)$
such that
\begin{equation*}%
\xymatrix{%
X
\ar[r]^-\eta
\ar[rd]_-f
&
\nsp(\linf(X))
\ar[d]^-{\nsp(g)}
&
\linf(X)
\\
&
\nsp(\scrA)
&
\scrA
\ar@{.>}[u]_-g
}
\end{equation*}
commutes.
Moreover, and as a result, the assignment
$X\mapsto \linf(X)$
extends to a functor
$\linf\colon \Cat{Set}\to\op{(\W{miu})}$%
	\index{linfunctor@$\linf\colon \Cat{Set}\to\op{(\W{miu})}$}
that is left adjoint
to~$\nsp$,
and is given by $\linf(f)(h) = h\circ f$
for any map $f\colon X\to Y$
and~$h\in \linf(Y)$.
\begin{point}{30}{Proof}%
Note that if we identify~$\linf(X)$
with the $X$-fold product of~$\C$,
we see that~$\eta(x)\colon \linf(X)\equiv \bigoplus_{x\in X}\C\to \C$
is simply the $x$-th projection,
and thus an nmiu-map (see~\sref{vn-products}).
Hence we do indeed get a map $\eta\colon X\to\nsp(\linf(X))$.

To see that~$\eta$ has the desired universal property,
let~$f\colon X\to\nsp(\scrA)$ be given,
and define~$g\colon \scrA\to \linf(X)$
by~$g(a)(x)=f(x)(a)$.
One can now either prove directly that~$g$ is nmiu,
or reduce this in a slightly roundabout way
from the known fact that~$\linf(X)$ is the 
$X$-fold product of~$\C$ with the $\eta(x)$ as projections;
indeed~$g$ is simply the  unique nmiu-map with $\eta(x)\circ g = f(x)$
for all~$x\in X$, that is,  $g=\left<f(x)\right>_{x\in X}$.
In any case,
we see that $\nsp(g)(\eta(x)) \equiv \eta(x)\circ g = f(x)$
for all~$x\in X$, and so~$\nsp(g) \circ \eta = f$.
Concerning uniqueness of such~$g$,
note that given an nmiu-map $g'\colon \scrA\to\linf(X)$
with~$\nsp(g')\circ \eta = f$
we have~$\eta(x)\circ  g'= \nsp(g')(\eta(x))
= f(x)$ for all~$x\in X$,
and so~$g'=\left<f(x)\right>_{x\in X}=g$.

Hence~$\eta$ is a universal arrow from~$X$
to~$\nsp$.
That as a result the assignment $X\mapsto \linf(X)$
extends to a functor
$\Cat{Set}\to\op{(\W{miu})}$
by sending~$f\colon X\to Y$
to the unique nmiu-map $\linf(f)\colon \linf(Y)\to\linf(X)$
with $\nsp(\linf(f))\circ \eta_X = \eta_Y\circ f$
is a known and easily checked fact
(where~$\eta_X:= \eta$ and~$\eta_Y\colon Y\to\nsp(\linf(Y))$ 
is what you'd expect).
Finally, applying~$x\in X$ and~$h\in \linf(Y)$
we get
$ \linf(f)(h)(x)
= \eta_X(x)(\linf(f)(h)))
=\nsp(\linf(x))(\eta_X(x))(h)
=\eta_Y(f(x))(h)
=h(f(x))$.\qed
\end{point}
\end{point}
\begin{point}{40}[nmiu-functional-product]{Lemma}%
A nmiu-functional $\varphi$
on a direct sum $\bigoplus_i \scrA_i$
of von Neumann algebras
is of the form~$\varphi\equiv \varphi'\circ \pi_i$
for some~$i$ and nmiu-functional~$\varphi'$ on~$\scrA_i$.
\begin{point}{50}{Proof}%
Let~$e_j$ denote the element of~$\bigoplus_i \scrA_i$
given by $e_j(j)=1$ and~$e_j(i)=0$ for all~$i\neq j$.
Note that given~$i$ and~$j$ with $i\neq j$
we have~$e_ie_j=0$
and so~$0=\varphi(e_i e_j)=\varphi(e_i)\varphi(e_j)$;
from this we see that
there is at most one~$i$ with~$\varphi(e_i)\neq 0$.
Since for this~$i$
we have $e_i^\perp = \sum_{j\neq i} e_j$
and so~$\varphi(e_i^\perp)=\sum_{j\neq i} \varphi(e_j)=0$,
we see that $\varphi(a)=\varphi(e_i a )$
for all~$a\in \bigoplus_i \scrA_i$.
Letting  $\kappa_i\colon \scrA_i\to\bigoplus_j \scrA_j$
be the nmisu-map given by~$\kappa_i(a)(i)=a$
and~$\kappa_i(a)(j)=0$ for~$j\neq i$
we have~$\varphi = \varphi \circ \kappa_i \circ \pi_i$.
Hence taking~$\varphi':=\varphi\circ \kappa_i$
does the job.\qed
\end{point}
\end{point}
\begin{point}{60}[cor:linf-ff]{Exercise}%
Deduce from~\sref{nmiu-functional-product}
that the functor $\nsp\colon \op{(\W{miu})}\to \Cat{Set}$
preserves coproducts,
and that the 
map $\eta\colon X\to \nsp(\linf(X))$
from~\sref{first-adjunction} is a bijection.

Show that~$\linf\colon\Cat{Set}\to \op{(\W{miu})}$
is full and faithful.
	Whence~$\Cat{Set}$ is (isomorphic to)  
a coreflective subcategory of~$\op{(\W{miu})}$ 
	via~$\linf\colon \Cat{Set} \to \op{(\W{miu})}$.
\end{point}
\end{parsec}
\begin{parsec}{1230}
\begin{point}{10}{Exercise}%
	We're going to prove that
	$\ell^\infty(X\times Y)\cong \ell^\infty(X)\otimes \ell^\infty(Y)$.
\begin{enumerate}%
\item
Given an element~$x$ of a set~$X$
let~$\hat{x}$ denote
the element of~$\ell^\infty(X)$
that equals~$1$ on~$x$ and is zero elsewhere.

Show that~$\{\,\hat{x}\colon\, x\in X\,\}$
generates~$\ell^\infty(X)$.
\item
Show that the  projections $\pi_x\colon \ell^\infty(X)\equiv
\bigoplus_{y\in X}\C\to\C$
form an order separating collection of
		nmiu-functionals on~$\ell^\infty(X)$.
\item
Using this, and~\sref{tensor-characterization},
prove that given sets~$X$ and~$Y$
the map
\begin{equation*}
	\otimes\colon \ell^\infty(X)\times \ell^\infty(Y)
\to\ell^\infty(X\times Y)
\end{equation*}
given by~$(f\otimes g)(x,y)=f(x)g(y)$
is a tensor product.

Conclude that 
	$\ell^\infty(X\times Y)\cong \ell^\infty(X)\otimes \ell^\infty(Y)$.

		(In fact, it follows that~$\ell^\infty$ is strong monoidal.)
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{20}{Exercise}%
Let~$\scrA$ and~$\scrB$
be von Neumann algebras.
We're going to show that~$\nsp(\scrA\otimes\scrB)\cong \nsp(\scrA)\times
	\nsp(\scrB)$.
\begin{enumerate}
\item
Given an nmiu-functional $\varphi\colon \scrA\otimes \scrB\to\C$
show that~$\sigma:= \varphi((\,\cdot\,)\otimes 1)$
and~$\tau:=\varphi(1\otimes (\,\cdot\,))$
are nmiu-functionals on~$\scrA$ and~$\scrB$, respectively;
		and show that~$\varphi=\sigma\otimes \tau$
		(by proving that $\varphi(a\otimes b)=\sigma(a)\tau(b)$.)
\item
Show that~$\sigma,\tau\mapsto \sigma\otimes \tau$
		gives a bijection $\nsp(\scrA)\times\nsp(\scrB)
		\to\nsp(\scrA\otimes\scrB)$.

		(This  makes~$\nsp$  strong monoidal.)
\end{enumerate}
\spacingfix%
\end{point}%
\end{parsec}%
\subsection{Second Adjunction}
\begin{parsec}{1240}%
\begin{point}{10}[vn-generation-bound]{Lemma}%
If a von Neumann algebra~$\scrA$
is generated by~$S\subseteq \scrA$,
then
\begin{equation*}
\#\scrA \ \leq\  2^{2^{\#\mathbb{C}+\#S}},
\end{equation*}
where~$\#S$ denotes the cardinality of~$S$, and so on.
\begin{point}{20}{Proof}%
Note that the
$*$-subalgebra~$S'$ of~$\scrA$
generated by~$S$
is ultraweakly dense in~$\scrA$.
Since every element of~$S'$
can be formed
from the infinite set $S\cup \mathbb{C}$ using 
the finitary operations
of
addition, multiplication,
and
involution,
$\#S'\leq \#\mathbb{C}+ \#S$.
Since every element of~$\scrA$
is the ultraweak limit of a filter
(see \cite[\S12]{willard})
on~$S'$
of which there no more than~$2^{2^{\#S'}}$,
we conclude~$\#\scrA \leq 2^{2^{\#\mathbb{C}+\#S}}$.\qed
\end{point}
\end{point}
\begin{point}{30}[second-adjunction]{Theorem}%
The inclusion $\W{miu}\to\W{cpsu}$
has a left adjoint $\Define{\mathcal{F}}\colon \W{cpsu}\to\W{miu}$.%
	\index{F@$\mathcal{F}\colon \W{cpsu}\to\W{miu}$}
\begin{point}{40}[second-adjunction-proof]{Proof}%
Note that since the category~$\W{miu}$
has all products (\sref{vn-products}),
and equalisers (\sref{vn-equalisers}),
$\W{miu}$ has all limits 
(by Theorem~V2.1 and Exercise V4.2 of~\cite{maclane}).
Moreover, the inclusion~$U\colon \W{miu}\to\W{cpsu}$
preserves these limits (see~\sref{vn-products} and~\sref{vn-equalisers}).
So by Freyd's adjoint functor theorem (Theorem~V6.1 of~\cite{maclane})
it suffices to check the \emph{solution set condition},
that is,
that 
\begin{quote}
for every von Neumann algebra~$\scrA$
there 
be a set~$I$,
and for each~$i\in I$ an ncpsu-map $f_i\colon \scrA\to\scrA_i$
into a von Neumann algebra~$\scrA_i$
such that every ncpsu-map $f\colon \scrA\to \scrB$
into some von Neumann algebra~$\scrB$
is of the form~$ f\equiv h\circ f_i$
for some~$i\in I$ and nmiu-map $h\colon \scrA_i\to\scrB$.
\end{quote}
To this end, given a von Neumann algebra~$\scrA$,
let~$\kappa:=2^{2^{\#\C+\#\scrA}}$, define
\begin{alignat*}{3}
	I\ = \ \{\ (\scrC,\gamma)\colon \scrC\text{ is }&
	\text{a von Neumann algebra
	on a subset of~$\kappa$,}\\
&\text{and $\gamma \colon \scrA\to\scrC$ is an ncpsu-map} \ \},
\end{alignat*}
and set~$f_i := \gamma$ for every $i\equiv(\scrC,\gamma)\in I$.

Let $f\colon \scrA\to\scrB$
be an ncpsu-map
into a von Neumann algebra~$\scrB$.
The von Neumann algebra~$\scrB'$ generated by~$f(\scrA)$
has cardinality below~$\kappa$
by~\sref{vn-generation-bound},
and so by relabelling the elements of~$\scrB'$
we may find a von Neumann algebra~$\scrC$
on a subset of~$\kappa$
isomorphic to~$\scrB'$
via some nmiu-isomorphism $\Phi\colon \scrB'\to\scrC$.
Then the map $\gamma\colon \scrA\to \scrC$
given by~$\gamma(a)=\Phi(f(a))$ for all~$a\in\scrA$
is ncpsu,
so that~$i:=(\scrC,\gamma)\in I$,
and, moreover,
the assignment~$c\mapsto \Phi^{-1}(c)$
gives an nmiu-map $h\colon \scrC\to \scrB$
with~$h\circ f_i \equiv h\circ \gamma=f$.
Hence~$U\colon \W{miu}\to\W{cpsu}$
obeys the solution set condition,
and therefore has a left adjoint.\qed
\end{point}
\begin{point}{50}{Remark}%
A bit more can be said
about the adjunction between the inclusion~$U\colon \W{miu}\to\W{cpsu}$
and~$\mathcal{F}$:
since~$\W{miu}$ has the same objects as~$\W{cpsu}$,
the category~$\op{(\W{cpsu})}$
is, for very general reasons, equivalent
to the Kleisli category
	of the (by the adjunction induced) monad~$\mathcal{F}U$ 
on~$\op{(\W{miu})}$
in a certain natural way
(see e.g.~Theorem~9 of~\cite{qpakm}).
\end{point}
\end{point}
\end{parsec}
\subsection{Free Exponential}
\begin{parsec}{1250}%
\begin{point}{10}%
	We'll prove Kornell's result (from~\cite{kornell2012})
that the functor
$\scrB\otimes(\,\cdot\,)\colon
\W{miu}\to\W{miu}$
has a left adjoint~$(\,\cdot\,)^{*\scrB}$
for every von Neumann algebra~$\scrB$.
Kornell original proof is rather complex,
and so is ours, unfortunately,
but we've managed
to peel off one layer of complexity from the original 
proof
by way of Freyd's Adjoint Functor Theorem,
reducing the problem
to the facts that
$\scrB\otimes(\,\cdot\,)\colon \W{miu}\to\W{miu}$
preserves products,  equalisers,
and satisfies the solution set condition.
\end{point}
\begin{point}{20}[vn-gns-bound]{Lemma}%
A von Neumann algebra~$\scrA$
can be faithfully represented
on a Hilbert space which contains no more
than~$2^{\#\scrA}$ vectors.
\begin{point}{30}{Proof}%
If~$\scrA=\{0\}$,
then the result is obvious,
so let us assume that~$\scrA\neq \{0\}$.
Then~$\scrA$ is infinite,
and so~$\aleph_0 \cdot \#\scrA  = \#\scrA$. 

Let~$\Omega$ be the set of np-functionals on~$\scrA$.
Recall that 
by the GNS-construction (see~\sref{ngns})
$\mathscr{A}$
can be faithfully represented on
the Hilbert space
$\scrH_\Omega\equiv \bigoplus_{\omega\in\Omega} \scrH_\omega$.
Since every element of~$\scrH_\omega$
is the limit of a sequence of elements from~$\scrA$,
we have $\#\scrH_\omega \leq \aleph_0^{\#\scrA} \leq (2^{\aleph_0})^{\#\scrA} 
= 2^{\#\scrA}$,
because $\aleph_0\cdot \#\scrA=\#\scrA$.
Since every normal state is a map $\omega\colon \scrA\to\C$,
we have $\#\Omega\leq \#\C^{\#\scrA}=(2^{\aleph_0})^{\#\scrA}
= 2^{\#\scrA}$, because $\aleph_0 \cdot \#\scrA = \#\scrA$.
Hence $\#\scrH = \sum_{\omega\in\Omega} \#\scrH_\omega
\leq 2^{\#\scrA}\cdot2^{\#\scrA}
=2^{\#\scrA}$.\qed
\end{point}
\end{point}
\begin{point}{40}[equaliser-lemma]{Lemma (Kornell)}%
Every nmiu-map $h\colon \scrD\to\scrA\otimes \scrC$,
where~$\scrA$, $\scrC$ and~$\scrD$ are von Neumann algebras,
factors as 
$\smash{\xymatrix@C=3em{\scrD
\ar[r]|-{\tilde{h}}
& 
\tilde\scrA\otimes \scrC
\ar[r]|-{\iota\otimes\id}
&
\scrA \otimes \scrC
}}$,
where~$\smash{\tilde\scrA}$
is a von Neumann algebra,
and~$\iota$ and~$\tilde{h}$
are nmiu-maps,
such that
for all nmiu-maps $f,g\colon \scrA\to\scrB$
into some von Neumann algebra~$\scrB$
with $(f\otimes\id)\circ h = (g\otimes \id)\circ h$
we have $f\circ \iota = g\circ \iota$.

Moreover,
$\tilde\scrA$
can be generated by
less than~$\#\scrD\,\cdot\,2^{\#\scrC}$ elements.
\begin{point}{50}{Proof}%
Assume (without loss of generality)
that
$\scrC$
is a von Neumann algebra of operators on
a Hilbert space~$\scrH$
with no more than $2^{\#\scrC}$ vectors, see~\sref{vn-gns-bound}.

For every vector~$\xi\in \scrH$
let
$r_\xi\colon \scrA\otimes \scrC\to\scrA$
be the unique np-map
given by~$r_\xi(a\otimes c) = \left<\xi,c\xi\right> a$
for all~$a\in\scrA$ and~$c\in \scrC$
(see~\sref{tensor-universal-property}
and~\sref{tensor-universal-property-extra}),
and
let~$\tilde\scrA$
be the least von Neumann subalgebra
of~$\scrA$
that contains $S:=\smash{ \bigcup_{\xi \in\scrH} r_\xi(h(\scrD))}$,
and let~$\iota\colon \tilde\scrA\to\scrA$
be the inclusion
(so~$\iota$ is nmiu).
Note that~$S$ (which generates~$\tilde\scrA$)
has no more than $\#\scrD\cdot\#\scrH\leq \#\scrD \cdot 2^{\#\scrC}$
elements.

Let~$f,g\colon \scrA\to\scrB$
be nmiu-maps
into a von Neumann algebra~$\scrB$
such that $(f\otimes\id)\circ h = (g\otimes \id)\circ h$.
We must show that~$f\circ \iota = g\circ \iota$.
By definition of~$\tilde\scrA$
(and the fact that~$f$ and~$g$ are nmiu),
it suffices to show that $f\circ r_\xi\circ h=g\circ r_\xi\circ h$
for all~$\xi\in\scrH$.
Note that given such~$\xi$,
we have $f\circ r_\xi = r_\xi' \circ (f\otimes\id)$,
where~$r_\xi'\colon \scrB\otimes\scrC\to\scrB$
is the np-map
given by~$r_\xi'(b\otimes c)=\left<\xi,c\xi\right>b$.
Since similarly,
$g\circ r_\xi = r_\xi'\circ (g\otimes \id)$,
we get~$f\circ r_\xi \circ h
= r_\xi' \circ (f\otimes \id)\circ h
= r_\xi' \circ (g\otimes \id)\circ h
= g\circ r_\xi \circ h$.

It remains only to 
be shown that $h(\scrD) \subseteq \tilde\scrA\otimes \scrC$,
because we may then simply let~$\tilde{h}$
be the restriction of~$h$ to~$\tilde\scrA\otimes \scrC$.
It is enough to prove that
$h(\scrD) \subseteq \tilde\scrA 
\otimes  \bsp(\scrH)$,
because 
$\tilde\scrA \otimes  \scrC
\,=\, (\tilde\scrA\otimes \bsp(\scrH))\,\cap\,
(\scrA\otimes \scrC)$
(see~\sref{intersection-tensor})
and we already know that $h(\scrD)\subseteq \scrA\otimes \scrC$.
Let $(e_k)_k$ be orthonormal basis of $\scrH$.
Since $1= \sum_k \ket{e_k}\!\bra{e_k}$
in $\bsp(\scrH)$,
we have, for all~$d\in\scrD$,
\begin{align*}
h(d) \ &=\ \textstyle\bigl(\sum_k 1\otimes \ket{e_k}\!\bra{e_k}\bigr)
\ h(d)\ \bigl(\sum_\ell 1\otimes \ket{e_\ell}\!\bra{e_\ell}\bigr)\\
\ &=\ \textstyle \sum_k\sum_\ell\ 
 (\,1\otimes \ket{e_k}\!\bra{e_k}\,) \ h(d)\  
 (\,1\otimes \ket{e_\ell}\!\bra{e_\ell}\,).
\end{align*}
We are done
if we can prove that,
for all~$\xi,\zeta\in\scrH$,
\begin{equation}
\label{eq:main-equaliser-todo}
(\,1\otimes \ket{\xi}\!\bra{\xi}\,) \ 
h(d)\  (\,1\otimes \ket{\zeta}\!\bra{\zeta}\,)
\ \in\ \tilde\scrA\otimes \bsp(\scrH).
\end{equation}
By an easy computation, we see that,
for all $e \,\in\,\scrA\otimes \scrC$
	of the form $e\equiv a\otimes c$,
\begin{equation*}
\label{eq:polarisation-equaliser}
(\,1\otimes \ket{\xi}\!\bra{\xi}\,) \ e
\  (\,1\otimes \ket{\zeta}\!\bra{\zeta}\,)
\ =\ 
\frac{1}{4}\sum_{k=0}^3i^k \,r_{i^k\xi+\zeta}(e)\otimes \ket\xi\!\bra\zeta.
\end{equation*}
It follows that the equation above holds for all~$e\in \scrA\otimes \scrC$.
Choosing $e=h(d)$
we see that~\eqref{eq:main-equaliser-todo}
holds,
because
$r_{i^k\xi+\zeta}(h(d)) \in\tilde\scrA$.\qed
\end{point}
\end{point}
\begin{point}{60}[tensor-equalisers]{Proposition}%
Let $e\colon\scrE\to\scrA$ be an equaliser of
nmiu-maps $f,g\colon\scrA\to\scrB$ 
between von Neumann algebras.
Then $e\otimes\id\colon\scrE\otimes\scrC\to\scrA\otimes\scrC$
is an equaliser of 
$f\otimes\id$ and $g\otimes\id$
for every von Neumann algebra~$\scrC$.
\begin{point}{70}{Proof}%
Let~$h\colon\scrD\to\scrA\otimes \scrC$
be an nmiu-map 
with $(f\otimes\id)\circ h=(g\otimes\id)\circ h$.
We must show that there is a unique
 nmiu-map $k\colon\scrD\to\scrE\otimes\scrC$
such that  $h=(e\otimes\id)\circ k$.
Note that since the equaliser map~$e$ 
is injective,
$e\otimes\id\colon\scrE\otimes\scrC\to\scrA\otimes\scrC$
is injective (by~\sref{tensor-injective})
and thus uniqueness of~$k$ is clear.
Concerning existence,
by~\sref{equaliser-lemma},
$h$ factors as
$\smash{\xymatrix@C=3em{\scrD
\ar[r]|-{\tilde{h}}
& 
\tilde\scrA\otimes \scrC
\ar[r]|-{\iota\otimes\id}
&
\scrA \otimes \scrC
}}$
where~$\tilde{h}$ and~$\iota$ are nmiu-maps,
and moreover,
we have $f\circ \iota = g\circ \iota$.
Since~$e$ is an equaliser of~$f$ and~$g$,
there is a unique nmiu-map $\tilde\iota\colon \tilde\scrA\to \scrE$
with~$e\circ \tilde\iota = \iota$.
Now, define $k:=(\tilde \iota\otimes \id)\circ \tilde{h}\colon 
\scrD\to \scrE\otimes \scrC$.
Then~$(e\otimes \id)\circ k = 
((e\circ\tilde \iota)\otimes \id)\circ \tilde{h}
= (\iota\otimes \id)\circ \tilde{h}
= h$.\qed
\end{point}
\end{point}
\begin{point}{71}%
So given a von Neumann algebra~$\scrA$
the functor
$(\,\cdot\,)\otimes \scrA\colon \W{miu}\to\W{miu}$
preserves all equalisers and products,
thus all limits, and in particular, all pullbacks.
This has the following pleasant consequence  used later on.
\end{point}
\begin{point}{72}[tensor-preimage]{Exercise}%
Given a nmiu-map~$\varrho\colon \scrB\to\scrC$ 
between von Neumann algebras~$\scrB$ and~$\scrC$,
and a von Neumann subalgebra $\scrS$ of~$\scrC$,
show that
\begin{equation*}
(\varrho\otimes\scrA)^{-1}(\scrS\otimes \scrA)\ 
    =\ \varrho^{-1}(\scrS)\otimes \scrA
\end{equation*}
for every von Neumann algebra~$\scrA$,
where for the sake of simplicity we
take $\varrho^{-1}(\scrS)\otimes \scrA$
to be the von Neumann subalgebra of~$\scrB\otimes \scrA$
    generated by 
\begin{equation*}
    \{ \,b\otimes a\colon \,b\in \varrho^{-1}(\scrS),\,
a\in\scrA\,\}.
\end{equation*}
(Hint: express $\varrho^{-1}(\scrS)$ 
as pullback in~$\W{miu}$
of $\varrho\circ \pi_1, e\circ \pi_2 \colon \scrB\oplus\scrS\to\scrC$,
    where $e\colon \scrS\to\scrC$ is the inclusion.)
\end{point}
\begin{point}{80}[tensor-closed]{Theorem (Kornell)}%
The functor $(\,\cdot\,)\otimes\scrA\colon\W{miu}\to\W{miu}$
has a left adjoint
    $\Define{(\,\cdot\,)^{*\scrA}}$
for every von Neumann algebra~$\scrA$.
	\index{free exponential}%
	\index{*AstarB@$\scrA^{*\scrB}$, free exponential}
    \begin{point}{90}[tensor-closed-proof]{Proof}%
	The category $\W{miu}$ is (small-)complete,
and
$(-)\otimes\scrA\colon\W{miu}\to\W{miu}$
preserves (small-)products and equalisers.
Thus,
by Freyd's (General)
Adjoint Functor Theorem~\cite[Thm.~V.6.2]{maclane},
it suffices to check the following Solution Set Condition
(where we've used that $\W{miu}$
is locally small).
\begin{itemize}
\item
	For each $\scrB\in\W{miu}$, there is a small subset $\mathcal{S}$ of objects in $\W{miu}$
such that every arrow $h\colon \scrB\to\scrC\otimes\scrA$
can be written as a composite $h=(t\otimes\id_{\scrA})\circ f$ for some $\scrD\in \mathcal{S}$,
$f\colon\scrB\to\scrD\otimes \scrA$, and $t\colon \scrD\to\scrC$.
\end{itemize}
Let $\scrB$ be an arbitrary von Neumann algebra.
We claim that the following set $\mathcal{S}$ satisfies the required condition:
\[
	\mathcal{S}=
\{\,\scrD\colon\,
    \text{$\scrD$ is a von Neumann algebra on a subset of~$\kappa$}\,\},
\quad\text{where}\quad\kappa=2^{2^{\#\C\cdot\#\scrB\cdot2^{\#\scrA}}}.
\]
Note that~$\kappa$
being an ordinal number
is just the set of all ordinal numbers~$\alpha<\kappa$.
To prove the claim,
suppose that $h\colon \scrB\to\scrC\otimes\scrA$ is given.
By \sref{equaliser-lemma},
$h$ factors
as
\begin{equation*}
	\xymatrix@C=4em{\scrB\ar[r] & \tilde\scrC\otimes 
\scrA\ar[r]|-{\iota\otimes \id} & \scrC\otimes\scrA },
\end{equation*}
where~$\tilde\scrC$
is a von Neumann algebra
generated by no more than~$\#\scrB\cdot2^{\#\scrA}$
elements.
It follows that~$\tilde\scrC$ has no
more than~$\kappa$ elements (by~\sref{vn-generation-bound}).
Thus we may assume without loss of generality
that~$\tilde\scrC$
is a subset of~$\kappa$,
that is,~$\tilde\scrC\in\mathcal{S}$.\qed
\end{point}
\end{point}
\begin{point}{100}[cstar-no-model]{Remark}%
It should be noted that analogues
of the first and second adjunctions
can be found in the setting of $C^*$-algebras,
which raises the question as to whether
a variation on the free exponential exist for $C^*$-algebras,
that is, is there a tensor~$\otimes$ on~$\Cstar{miu}$
such that $(-)\otimes \scrA\colon
\Cstar{miu}\to\Cstar{miu}$
has a left adjoint?

Such a tensor does not exist
if we require that
on commutative
$C^*$-algebras it is given by the product of the spectra
(as is the case for the projective and injective tensors
of $C^*$-algebras)
in the sense that there
is a natural isomorphism
$\Phi_{X,Y}\colon 
\smash{\xymatrix{
C(X)\otimes C(Y)
\ar[r]|-{\cong}
&
C(X\times  Y)}}$ 
between the obvious functors of type $\CH\times \CH\to \op{(\Cstar{miu})}$.
Indeed, if~$(-)\otimes \scrA\colon \Cstar{miu}\to\Cstar{miu}$
had a left adjoint 
and so would preserve all limits
for all $C^*$-algebras~$\scrA$,
then the functor~$(-)\times X\colon \CH\to\CH$
would preserve all colimits
for every compact Hausdorff space~$X$,
which it does not,
because if it did
the square $\beta\N \times \beta\N$ of
the Stone--\v{C}ech compactification~$\beta\N$
of the natural numbers (being the $\N$-fold
coproduct of the one-point space)
would be homeomorphic to the Stone--\v{C}ech
compactification~$\beta(\N\times \N)$
of~$\N\times \N$,
which it is not (by Theorem~1 of~\cite{glicksberg1959}).

Whence
$\Cstar{cpsu}$
does not form a model of the quantum lambda calculus
in the same way that~$\W{cpsu}$ does.
\end{point}
\end{parsec}
\subsection{Hereditarily Atomic Von Neumann Algebras}
\begin{parsec}{1251}
\begin{point}{10}
We'll argue that it's possible to modify our model of the quantum lambda 
calculus from~\cite{model} to include only 
hereditarily atomic (\sref{def:hereditarily-atomic})
von Neumann algebras
    (as suggested by Kornell on page~5 of~\cite{kornell2018quantum}.)
To this end
we must bring up that the types of the quantum lambda calculus
are generated as follows:
there's a type $\qbit$, and a type~$\top$;
and from types~$A$ and~$B$, we can form\footnote{The 
type $\bit$ discussed in~\sref{qlcm-intro} is missing from this list,
since it can defined by $\bit:=\top\oplus\top$.}
\begin{equation*}
A\oplus B,\quad A\otimes B,\quad !A,\quad \text{and}\quad 
     A\limp B.
\end{equation*}
Note that 
the interpretations,
$\sem{\qbit}=M_2$
    and $\sem{\top}=\C$,
of the ground types
are hereditarily atomic,
and that the interpretation
of
the sum,
$\sem{A\oplus B}=\sem{A}\oplus\sem{B}$, and the tensor,
$\sem{A\otimes B} = \sem{A}\otimes \sem{B}$,
are hereditarily atomic
when~$\sem{A}$ and~$\sem{B}$ are hereditarily atomic.
The interpretation
$\sem{!A} = \linf(\nsp(\sem{A}))$
is hereditarily atomic regardless
of whether $\sem{A}$ is hereditarily atomic, or not.
So whether all von Neumann algebras
in our model are hereditarily atomic
hinges only on the interpretation
of~$\limp$.
As it turns out, 
the interpretation $\sem{A\limp B} = \mathcal{F}(\sem{B})^{*\sem{A}}$
we chose is not always hereditarily atomic
when $\sem{A}$ and~$\sem{B}$
are hereditarily atomic:
    we claim (without proof) that
$\sem{\top^{\oplus 3} \limp \top}
\equiv \C^{*\C^3}$
has $\scrB(\ell_2)$  as factor,
and that $\sem{\top\limp \bit}\equiv\mathcal{F}(\C^2)$
has $L^\infty[0,1]$ as summand.
\end{point}
\begin{point}{20}
The solution is obvious:
show that the functor $(\,\cdot\,)\otimes \scrA\colon
\haW{miu}\to\haW{miu}$
has a left adjoint 
    $(\,\cdot\,)^{*_\mathrm{ha}\scrA}$
for every hereditarily atomic von Neumann 
algebra~$\scrA$,
and show that the inclusion $\haW{miu}\to\haW{cpsu}$
    has a left adjoint $\mathcal{F}_{\mathrm{ha}}$.
One may then define $\sem{\,\cdot\,}_\mathrm{ha}$
exactly the same as~$\sem{\,\cdot\,}$ except for
\begin{equation*}
    \sem{A\limp B}_{\mathrm{ha}}
    \ :=\ \mathcal{F}_\mathrm{ha}(\,
    \sem{B}_\mathrm{ha}\, )^{*_\mathrm{ha}\sem{A}_{\mathrm{ha}}}.
\end{equation*}
The benefit of using the hereditarily atomic model
is that
$\mathcal{F}_\mathrm{ha}$
and $\scrA^{*_\mathrm{ha}\scrB}$
admit a significantly more concrete
    description see~\sref{Fha-concrete}
    and~\sref{AstarhaB-concrete}
A potential drawback might be that the purely quantum mechanical is restricted
to finite dimensions, so to speak.
\end{point}%
\end{parsec}%
\begin{parsec}{1252}
\begin{point}{10}
We establish the existence of~$\mathcal{F}_\mathrm{ha}$
indirectly at first.
\end{point}
\begin{point}{20}{Proposition}%
The inclusion $\haW{miu}\to\haW{cpsu}$
has a left adjoint
\begin{equation*}
    \Define{\mathcal{F}_\mathrm{ha}}(\scrA)
    \colon \haW{cpsu}\longrightarrow \haW{miu}.
\end{equation*}%
\index{Fha@$\mathcal{F}_\mathrm{ha}\colon \haW{cpsu}\longrightarrow \haW{miu}$}%
\spacingfix{}%
\begin{point}{30}{Proof}%
Given our definition of hereditary atomicity,
    \sref{def:hereditarily-atomic},
it's  pretty clear 
that the subcategory
$\haW{miu}$
    of~$\W{miu}$
is closed under
products,
and that these products are preserved
by the inclusion functor
    $\haW{miu}\to\haW{cpsu}$.
Using~\sref{ha-equalisers}
one sees the same holds for equalisers.
Whence the proof is completed by
an application of Freyd's adjoint functor theorem,
exactly as in~\sref{second-adjunction-proof},
but with as solution set
for a hereditarily atomic von Neumann algebra~$\scrA$,
the ncpsu-maps 
$\gamma\colon \scrA\to\scrC$
for which $\scrC$
    is a \emph{hereditarily atomic} 
    von Neumann algebra on a subset of
    the cardinal $\kappa\equiv\smash{ 2^{2^{\#\C+\#\scrA}}}$.
    \qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}{1253}%
\begin{point}{10}
To give a concrete description
of the functor~$\mathcal{F}_\mathrm{ha}$
we need some notation first.
\end{point}
\begin{point}{20}
Let~$\scrA$ be a hereditarily atomic von Neumann algebra.
    We'll describe $\mathcal{F}_\mathrm{ha}(\scrA)$
    in terms of ncpsu-maps $f\colon \scrA\to M_{N_f}$
    with $W^*(f(\scrA))=M_{N_f}$.
    Let us say that two such maps $f_1\colon \scrA\to M_{N_{f_1}}$
    and $f_2 \colon \scrA\to M_{N_{f_2}}$
are \Define{miu-equivalent}\index{miu-equivalent}
when there is an nmiu-isomorphism
    $\varphi\colon M_{N_{f_1}}\to M_{N_{f_2}}$
with~$\varphi \circ f_1 = f_2$,
(which implies that  $N_{f_1}=N_{f_2}$.)
Choose a set~$\Define{R_\scrA}$\index{RA@$R_\scrA$}
of representatives
for this miu-equivalence.
\end{point}
    \begin{point}{30}[Fha-concrete]{Theorem}%
Given a hereditarily atomic von Neumann algebra~$\scrA$,
the unique nmiu-map~$\Phi$ that causes the diagram
\begin{equation*}
\xymatrix@C=6em{
    \scrA
    \ar[r]^-{\eta_\scrA}
    \ar[rd]_-{\left<r\right>_{r\in R_\scrA}}
    &
    \mathcal{F}_\mathrm{ha}(\scrA)
    \ar[d]^\Phi
    \\
    &
    \bigoplus_{r\in R_\scrA} M_{N_r}
}
\end{equation*}
to commute is an nmiu-isomorphism.
Here~$\eta$ denotes the unit of the adjunction
    between $\mathcal{F}_\mathrm{ha}$
    and the inclusion
    $\haW{miu}\to\haW{cpsu}$.
\begin{point}{40}[Fha-concrete-proof]{Proof}%
Since~$\mathcal{F}_\mathrm{ha}(\scrA)$
is hereditarily atomic,
it's nmiu-isomorphic to 
a direct sum of the form $\bigoplus_{i\in I} M_{N_i}$.
We may as well assume
that $\mathcal{F}_\mathrm{ha}(\scrA)\equiv
\bigoplus_{i\in I} M_{N_i}$.
We claim,
writing $\eta_\scrA\equiv \left<s_i\right>_{i\in I}
    \colon \scrA\to\bigoplus_{i\in I}M_{N_i}$,
that the $s_i$ form a set of representatives
for miu-equivalence as well.

The theorem follows easily from this claim.
Indeed, if given~$r\in R_\scrA$
we denote
by~$i_r$ the unique element of~$I$
    for which $s_{i_r}$ is miu-equivalent to~$r$,
    and let~$\varphi_r\colon M_{N_{i_r}}\to M_{N_{r}}$
    be a corresponding nmiu-isomorphism with~$r = \varphi_r\circ s_{i_r}$,
then one easily sees using its defining property
    that $\Phi$ is the composition of
\begin{equation*}
\xymatrix@C=5.5em{
\mathcal{F}_\mathrm{ha}(\scrA)\,\equiv\,
\bigoplus_{i \in I} M_{N_i}
    \ar[r]^-{\left<\pi_{i_r} \right>_{r\in R_\scrA}}
    & 
    \bigoplus_{r\in R_\scrA}
    M_{N_{r_i}}
    \ar[r]^-{\bigoplus_{r\in R_\scrA} \varphi_r}
    &
    \bigoplus_{r\in R_\scrA} M_{N_r}.
}
\end{equation*}
Since $r\mapsto i_r$ gives a bijection~$R_\scrA\to I$,
the first map above
is a nmiu-isomorphism.
Since the second map is clearly a nmiu-isomorphism
too, $\Phi$ is a nmiu-isomorphism.
\begin{point}{50}
Let us begin by proving that $W^*(s_i(\scrA))=M_{N_i}$
for every $i\in I$.

To this end, we'll first show 
that~$W^*(\eta_\scrA(\scrA))=\mathcal{F}_\mathrm{ha}(\scrA)$.
Let us denote by $f\colon \scrA\to W^*(\eta_\scrA(\scrA))$
the restriction of~$\eta_\scrA$.
By the universal property of~$\eta_\scrA$,
    there's a unique nmiu-map $\varrho\colon \mathcal{F}_\mathrm{ha}(\scrA)
    \to W^*(\eta_\scrA(\scrA))$
    with $f = \varrho\circ \eta_\scrA$.
Letting $e\colon W^*(\eta_\scrA(\scrA))\to \mathcal{F}_\mathrm{ha}(\scrA)$
be the inclusion,
we have $e\circ \varrho \circ \eta_\scrA = e\circ f = \eta_\scrA$.
    Since the identity $\id_{\mathcal{F}_\mathrm{ha}(\scrA)}\colon \mathcal{F}_\mathrm{ha}(\scrA)
\to \mathcal{F}_\mathrm{ha}(\scrA)$
is the unique nmiu-map $\tau\colon \mathcal{F}_\mathrm{ha}(\scrA)
\to \mathcal{F}_\mathrm{ha}(\scrA)$
with $\tau\circ \eta_\scrA = \eta_\scrA$,
    we get~$\id_{\mathcal{F}_\mathrm{ha}(\scrA)}= e\circ \varrho$.
    Since~$\id_{\mathcal{F}_\mathrm{ha}(\scrA)}$ is surjective,
    so is~$e$, and thus $W^*(\eta_\scrA(\scrA))=\mathcal{F}_\mathrm{ha}(
    \scrA)$.

Note that $W^*(\eta_\scrA(\scrA))
    \subseteq \bigoplus_{i\in I}
    W^*(s_i(\scrA))$
    because $\bigoplus_{i\in I} W^*(s_i(\scrA))$
    is a von Neumann subalgebra
    of~$\mathcal{F}_\mathrm{ha}(\scrA)$
    with $\eta_\scrA(\scrA) 
    \,\subseteq\, \bigoplus_{i\in I} W^*(s_i(\scrA))$.
    Since $W^*(\eta_\scrA(\scrA))=
    \mathcal{F}_\mathrm{ha}(
    \scrA)$,
    we get 
    $\bigoplus_{i\in I} W^*(s_i(\scrA))=
    \mathcal{F}_\mathrm{ha}(\scrA)
    \equiv \bigoplus_{ i \in I} M_{N_i}$,
    and so $W^*(s_i(\scrA))=M_{N_i}$
    for all~$i\in I$.

It remains to be shown
that given an ncpsu-map
$f\colon \scrA\to M_{N_f}$
    with $W^*(f(\scrA))= M_{N_f}$
there's a unique $i\in I$
such that~$s_i$ is miu-equivalent to~$f$.
\end{point}
\begin{point}{60}{Uniqueness}%
Let~$i,j\in I$ such that $s_i$ and~$s_j$ are miu-equivalent
be given, 
and let $\varphi\colon M_{N_i}\to M_{N_j}$
be the associated nmiu-isomorphism with~$\varphi \circ s_i = s_j$.
We must show that~$i=j$.
Recall that by the universal property of~$\eta_\scrA$,
there's a unique
nmiu-map $\varrho\colon \mathcal{F}_\mathrm{ha}(\scrA)
\to M_{N_j}$
with $s_j = \varrho\circ \eta_\scrA$.
    Surely, 
\begin{equation*} 
    \textstyle
    \pi_j\colon \mathcal{F}_\mathrm{ha}(\scrA)
    \equiv \bigoplus_{i'\in I}  M_{N_{i'}}
    \longrightarrow M_{N_j}
\end{equation*}
fits this description;
but so does $\varphi\circ \pi_i$,
since $\varphi\circ \pi_i \circ \eta_\scrA = \varphi\circ s_i = s_j$.
Hence~$\pi_j = \varphi\circ \pi_i$.
    This entails that the carriers (see~\sref{carrier-miu}) 
    of~$\pi_j$ and~$\pi_i$
are equal, so~$i=j$.
\begin{point}{70}[Fha-concrete-existence]{Existence}
Let~$f\colon \scrA\to M_{N_f}$
be an ncpsu-map with $M_{N_f}=W^*(f(\scrA))$.
We must show that there is an~$i\in I$
such that~$s_i$
is miu-equivalent with~$f$.
By the universal property of~$\eta_\scrA$
there's a unique nmiu-map $\varrho\colon \mathcal{F}_\mathrm{ha}(\scrA)
\to M_{N_f}$ with $f = \varrho\circ \eta_\scrA$.
We claim that~$\varrho$ must be of the form~$\varrho'\circ \pi_i$
for some nmiu-isomorphism $\varrho'\colon M_{N_i}\to M_{N_f}$.

First note that~$\varrho$ is surjective:
indeed, $\varrho(\mathcal{F}_\mathrm{ha}(\scrA))$
is a von Neumann subalgebra of~$M_{N_f}$ by~\sref{nmiu-image},
that contains $f(\scrA)$.
Thus $\varrho(\mathcal{F}_\mathrm{ha}(\scrA))
    \,\supseteq\, W^*(f(\scrA))\equiv M_{N_f}$,
which implies that~$\varrho$ is surjective.
Since~$\varrho$ is surjective, it maps central projections
    of $\mathcal{F}_\mathrm{ha}(\scrA)$
    to central projections
    of~$M_{N_f}$.
    For each~$i\in I$ let~$c_i$
    denote the central projection in $\mathcal{F}_\mathrm{ha}(\scrA)$
    given by $c_i(i)=1$ and $c_i(j)=0$ for all~$j\neq i$.
    Then the $c_i$ form an orthogonal family
    of  central projections with~$\sum_{i\in I}c_i =1$.
    So the $\varrho(c_i)$
    form an orthogonal family
    of central projections of~$M_{N_f}$ as well, 
    with $\sum_{i\in I} \varrho(c_i)=1$.
Since the only non-zero central projection in 
    $M_{N_f}$ (being a factor, \sref{central-examples}) is~$1$,
    it follows that there is exactly one~$i\in I$
    with $\varrho(c_i)=1$,
    and that $\varrho(c_j)=0$ for all~$j\neq i$.
    From this one easily deduces (c.f.~\sref{nmiu-factors}) 
    that~$\varrho$ must be of the form~$\varrho = \varrho'\circ \pi_i$
    for some injective nmiu-map $\varrho'\colon M_{N_i}\to M_{N_f}$.
    Since~$\varrho$ is surjective, $\varrho'$ is surjective too,
    and thus $\varrho'$ is a nmiu-isomorphism.

Now, since $\varrho = \varrho' \circ \pi_i $,
and $f=\varrho\circ \eta_\scrA$,
we get $f = \varrho' \circ \pi_i \circ \eta_\scrA\equiv
\varrho' \circ s_i$.
Since~$\varrho'$ is a nmiu-isomorphism,
we see that $f$ is miu-equivalent to~$s_i$.\qed
\end{point}
\end{point}
\end{point}
\end{point}
\begin{point}{80}{Remark}%
Given the concrete description for~$\mathcal{F}_\mathrm{ha}$
from~\sref{Fha-concrete}
it seems tempting to prove directly
that $\left<r\right>_{r\in R_\scrA}
\colon \scrA\to\bigoplus_{r\in R_\scrA}M_{N_r}$
is a universal arrow from~$\scrA$ to the inclusion
$\haW{miu}\to\haW{cpsu}$,
without presupposing the existence of~$\mathcal{F}_\mathrm{ha}$.
However, our attempts to do so have been thwarted
by our inability to prove  that
$W^*(\left<r\right>_{r\in R_\scrA})
= \bigoplus_{r\in R_\scrA} M_{N_r}$
using elementary means.

Whether this indicates an error in our proof,
or the power of the adjoint functor theorem,
remains to be seen.
\end{point}
\end{parsec}%
\begin{parsec}{1254}%
\begin{point}{10}%
To allow interpretation of~$\limp$
in~$\haW{miu}$,
we'll show that
the functor
$(\,\cdot\,)\otimes \scrB\colon \haW{miu}\to\haW{miu}$
    has a left adjoint $(\,\cdot\,)^{*_\mathrm{ha}\scrB}$ for every
hereditarily atomic von Neumann algebra~$\scrB$.
This result has already been established by Kornell
(in Theorem~9.1 of~\cite{kornell2018quantum});
we improve upon it by giving a different,
slightly more concrete, description.
    As was the case for~$\mathcal{F}_\mathrm{ha}$,
    we establish the existence
    of~$(\,\cdot\,)^{*_\mathrm{ha}\scrB}$
indirectly at first.
\end{point}
\begin{point}{20}{Proposition}%
Given a hereditarily atomic von Neumann algebra~$\scrB$,
    the functor $(\,\cdot\,)\otimes\scrB\colon
    \haW{miu}\longrightarrow \haW{miu}$
    has a left adjoint
    $\Define{(\,\cdot\,)^{*_\mathrm{ha}\scrB}}\colon
    \haW{miu}\to\haW{miu}$%
\index{*AstarBha@$\scrA^{*_\mathrm{ha}\scrB}$}.
\begin{point}{30}{Proof}%
We already know from~\sref{tensor-closed} that~$(\,\cdot\,)\otimes \scrB$
preserves limits as functor $\W{miu}\to\W{miu}$.
Since the subcategory $\haW{miu}$
of~$\W{miu}$ is closed
under products and equalisers,
    the restriction of~$(\,\cdot\,)\otimes\scrB$
    to a functor $\haW{miu}\to\haW{miu}$
    preserves limits as well.
The proof is now completed by an application
of Freyd's adjoint functor theorem,
exactly as in~\sref{tensor-closed-proof},
    but with a suitably modified solution set.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}{1255}
\begin{point}{10}
To describe $\scrA^{*_\mathrm{ha}\scrB}$ concretely
we need some notation.
\end{point}
\begin{point}{20}{Definition}
We say that a nmiu-map~$s\colon \scrA\to\scrC\otimes \scrB$,
where $\scrA$, $\scrB$ and~$\scrC$
are von Neumann algebras,
is \Define{$(\,\cdot\,)\otimes\scrB$-surjective}%
\index{surjective@$(\,\cdot\,)\otimes\scrB$-surjective}
when the only von Neumann subalgebra~$\scrS$
of~$\scrC$ with $s(\scrA)\subseteq \scrS\otimes\scrB$
is~$\scrS=\scrC$,
where for the sake of simplicity we regard $\scrS\otimes \scrB$
to be a von Neumann subalgebra of~$\scrC\otimes \scrB$
(c.f.~\sref{tensor-injective}).
\begin{point}{21}[tensor-map-factorisation]
    By inspecting the proof of~\sref{equaliser-lemma}
one sees that for any nmiu-map $s\colon \scrA\to\scrC\otimes \scrB$
there is a von Neumann subalgebra~$\tilde\scrC$
of~$\scrC$
such that~$s(\scrA)\subseteq \tilde\scrC\otimes \scrB$,
and the restriction of~$s$
to a a map $s\colon \scrA\to\tilde\scrC\otimes \scrB$
    is $(\,\cdot\,)\otimes\scrB$-surjective.
\end{point}
\end{point}
\begin{point}{30}[tensorBsurjectivity]{Lemma}
Given a $(\,\cdot\,)\otimes \scrB$-surjective
nmiu-map $s\colon \scrA\to\scrC\otimes \scrB$
and a nmiu-map  $\varrho\colon \scrC\to\scrD$
between von Neumann algebras,
the composition 
\begin{equation*}
\xymatrix@C=3em{
\scrA
\ar[r]^-s
    &
\scrC\otimes\scrB
    \ar[r]^-{\varrho\otimes\scrB}
    &
    \scrD\otimes\scrB
}
\end{equation*}
is $(\,\cdot\,)\otimes\scrB$-surjective
iff $\varrho$ is surjective.
\begin{point}{40}{Proof}%
Suppose that~$\varrho$ is surjective,
and let~$\scrS$ be a von Neumann subalgebra
of~$\scrD$ with 
    $(\varrho\otimes \scrB)(s(\scrA))\subseteq \scrS\otimes \scrB$.
To prove that $(\varrho\otimes \scrB)\circ s$
is $(\,\cdot\,)\otimes \scrB$-surjective,
we must show that~$\scrS=\scrD$.
Since $(\varrho\otimes \scrB)(s(\scrA))\subseteq \scrS\otimes \scrB$,
we have 
$s(\scrA)\subseteq (\varrho\otimes\scrB)^{-1}(\scrS \otimes \scrB)
\equiv \varrho^{-1}(\scrS) \otimes \scrB$,
by~\sref{tensor-preimage},
and so~$\varrho^{-1}(\scrS)=\scrC$,
because~$s$ is $(\,\cdot\,)\otimes \scrB$-surjective.
Whence~$\scrS = \varrho(\varrho^{-1}(\scrS))
\equiv \varrho(\scrC) = \scrD$,
using here that~$\varrho$ is surjective.
\begin{point}{50}
For the other direction suppose that~$(\varrho\otimes \scrB)\circ s$
is $(\,\cdot\,)\otimes\scrB$-surjective.
Since the range of~$\varrho\otimes \scrB$ 
is~$\varrho(\scrC)\otimes \scrB$,
we have 
$(\varrho\otimes\scrB)(s(\scrA))\subseteq \varrho(\scrC)\otimes \scrB$,
and so~$\varrho(\scrC)=\scrD$,
because~$(\varrho\otimes \scrB)\circ s$
is $(\,\cdot\,)\otimes\scrB$-surjective.\qed
\end{point}
\end{point}
\end{point}
\begin{point}{60}{Definition}%
Let~$\scrA$ and~$\scrB$ be hereditarily atomic von Neumann algebras.
We'll describe $\scrA^{*_\mathrm{ha}\scrB}$
in terms
of the $(\,\cdot\,)\otimes \scrB$-surjective
    nmiu-maps $f\colon \scrA\to M_{N_f}\otimes \scrB$.
Let us say that two such maps
    $f_1\colon \scrA\to M_{N_{f_1}}\otimes \scrB$
    and $f_2 \colon \scrA \to M_{N_{f_2}}\otimes \scrB$
    are 
\Define{$(\,\cdot\,)\otimes\scrB$-equivalent}%
\index{equivalent@$(\,\cdot\,)\otimes\scrB$-equivalent}
when there is a nmiu-isomorphism
    $\varphi\colon M_{N_{f_1}}\to M_{N_{f_2}}$
    with $(\varphi\otimes\scrB) \circ f_1 = f_2$
    (which implies that $N_{f_1}=N_{f_2}$.)
Pick a set of representatives
    $\Define{S_{\scrA,\scrB}}$%
    \index{SAB@$S_{\scrA,\scrB}$}
    for this 
$(\,\cdot\,)\otimes\scrB$-equivalence.
\end{point}
\begin{point}{70}[AstarhaB-concrete]{Theorem}
Let~$\scrA$ and~$\scrB$ be hereditarily atomic 
von Neumann algebras.
the unique nmiu-map
$\Phi\colon 
    \scrA^{*_\mathrm{ha}\scrB}
    \longrightarrow
    \bigoplus_{s\in S_{\scrA,\scrB}} M_{N_s}$
    that makes the diagram
\begin{equation*}
\xymatrix@C=10em{
\scrA
    \ar[r]^-{\eta_{\scrA,\scrB}}
    \ar[rdd]_-{\left<s\right>_{s\in S_{\scrA,\scrB}}}
&
\scrA^{*_\mathrm{ha}\scrB}\otimes \scrB
    \ar[d]^-{\Phi\otimes \scrB}
\\
&
\bigl(\,\bigoplus_{s\in S_{\scrA,\scrB}} M_{N_s}\,\bigr)
\otimes \scrB
    \ar[d]_{\cong}^{\left<\pi_s\otimes \scrB\right>_{s\in S_{\scrA,\scrB}}}
\\
&
\bigoplus_{s\in S_{\scrA,\scrB}} M_{N_s}\otimes \scrB
}
\end{equation*}
commute
is a nmiu-isomorphism.
Here $\eta_{(\,\cdot\,),\scrB}$
    denotes
the unit of the adjunction
between $(\,\cdot\,)^{*_\mathrm{ha}\scrB}$
and~$(\,\cdot\,)\otimes\scrB$.
\begin{point}{80}{Proof}%
We follow roughly the same lines
    as the proof of~\sref{Fha-concrete}.
Since~$\scrA^{*_\mathrm{ha}\scrB}$
is hereditarily atomic
we write~$\scrA^{*_\mathrm{ha}\scrB}
\equiv \bigoplus_{i\in I} M_{N_i}$
without loss of generality.
Note that writing $e_i = (\pi_i\otimes \scrB)\circ \eta_{\scrA,\scrB}$
the diagram
\begin{equation*}
\xymatrix@C=10em{
\scrA
    \ar[r]^-{\eta_{\scrA,\scrB}}
    \ar[rd]_-{\left<e_i\right>_{i\in I}}
&
\scrA^{*_\mathrm{ha}\scrB}\otimes \scrB
    \,\equiv\, \bigoplus_{i\in I}M_{N_i}\otimes \scrB
    \ar[d]_{\cong}^{\left<\pi_i\otimes \scrB\right>_{i \in I}}
\\
&
\bigoplus_{i \in I} M_i\otimes \scrB
}
\end{equation*}
commutes.
We claim that the $e_i$ are $(\,\cdot\,)\otimes \scrB$-surjective,
and, moreover,
form a set of representatives
for $(\,\cdot\,)\otimes \scrB$-equivalence
on the set of nmiu-maps
    $f\colon \scrA\to M_{N_f}\otimes \scrB$.
From this claim the theorem follows
with a reasoning similar to that
in~\sref{Fha-concrete-proof}, which we won't repeat here.
\begin{point}{90}
To prove that $e_i\equiv (\pi_i \otimes \scrB)\circ \eta_{\scrA,\scrB}$
is $(\,\cdot\,)\otimes\scrB$-surjective,
it suffices,
by~\sref{tensorBsurjectivity},
to show that $\eta_{\scrA,\scrB}$
is $(\,\cdot\,)\otimes \scrB$-surjective
(since~$\pi_i$ is surjective.)
So let~$\scrS$ be a von Neumann subalgebra of~$\scrA^{*_\mathrm{ha}\scrB}$
such that $\eta_{\scrA,\scrB}(\scrA)\subseteq
\scrS \otimes \scrB$.
We must show that~$\scrS = \scrA^{*_\mathrm{ha}\scrB}$.
Letting~$f\colon \scrA\to\scrS\otimes \scrB$
denote the restriction of~$\eta_{\scrA,\scrB}$,
there is, by the universal property of~$\eta_{\scrA,\scrB}$,
a unique nmiu-map $\varrho\colon \scrA^{*_\mathrm{ha}\scrB}
\to \scrS$
such that~$f= (\varrho\otimes \scrB) \circ \eta_{\scrA,\scrB}$.
Note that if we compose $\varrho$ with the inclusion
    $e\colon \scrS\to \scrA^{*_\mathrm{ha}\scrB}$,
    then
we get a nmiu-map $\sigma := e\circ \varrho\colon 
    \scrA^{*_\mathrm{ha}\scrB}
    \to\scrA^{*_\mathrm{ha}\scrB}$
    with the property
    that 
    $(\sigma\otimes\scrB)\circ \eta_{\scrA,\scrB} = \eta_{\scrA,\scrB}$.
Since the identity on~$\scrA^{*_\mathrm{ha}\scrB}$
is the only map with this property,
we get $e \circ \varrho = \id$.
This implies that~$e$ is surjective,
and thus~$\scrS=
    \scrA^{*_\mathrm{ha}\scrB}$.
    Whence~$\eta_{\scrA,\scrB}$
    is $(\,\cdot\,)\otimes \scrB$-surjective.

It remains to be show that for every nmiu-map
$f\colon \scrA\to M_{N_f}\otimes \scrB$
there is a unique $i\in I$
such that~$e_i$
is $(\,\cdot\,)\otimes \scrB$-equivalent
to~$f$.
\end{point}
\begin{point}{100}{Uniqueness}%
Suppose that $e_i$ and~$e_j$ are $(\,\cdot\,)\otimes\scrB$-equivalent
for some~$i,j\in I$;
we must show that~$i=j$.
Let~$\varphi\colon M_{N_i} \to M_{N_j}$
be an nmiu-isomorphism 
with $(\varphi\otimes \scrB ) \circ e_i = e_j$.
Note that $\pi_j\colon \scrA^{*_\mathrm{ha}\scrB}
    \equiv \bigoplus_{j'\in I} M_{N_{j'}}\longrightarrow
M_{N_j}$
    is the unique nmiu-map~$\varrho\colon \scrA^{*_\mathrm{ha}\scrB}
    \to M_{N_j}$ 
with $e_j = \varrho\otimes \scrB \circ \eta_{\scrA,\scrB}$.
    Since $(\varphi \circ \pi_i)\otimes \scrB \circ \eta_{\scrA,\scrB}
    = (\varphi\otimes \scrB) \,\circ\, (\pi_i\otimes\scrB )
    \,\circ\, \eta_{\scrA,\scrB}
    = \varphi\otimes \scrB \circ e_i = e_j$,
    we get $\varphi \circ \pi_j = \pi_i$.
    Hence~$i=j$.
\end{point}
\begin{point}{110}{Existence}%
Let $f\colon \scrA\to M_{N_f}\otimes\scrB$
be a $(\,\cdot\,)\otimes \scrB$-surjective  nmiu-map.
We must show that there is a unique $i\in I$
such that $f$ is $(\,\cdot\,)\otimes\scrB$-equivalent
to~$e_i$.
By the universal property of~$\eta_{\scrA,\scrB}$,
there's a unique nmiu-map
$\varrho\colon \scrA^{*_\mathrm{ha}\scrB}\longrightarrow
M_{N_f}$
with $(\varrho\otimes \scrB)\circ \eta_{\scrA,\scrB}
=  f$.
Note that~$\varrho$
    is surjective by~\sref{tensorBsurjectivity}.
Now, following the same reasoning as in~\sref{Fha-concrete-existence},
we see that~$\varrho\colon \scrA^{*_\mathrm{ha}\scrB}\equiv
\bigoplus_{i \in I} M_{N_i}\longrightarrow M_{N_f}$
must be of the form~$\varrho\equiv \varrho'\circ \pi_i$
for some~$i\in I$ and nmiu-isomorphism $\varrho'\colon
M_{N_i}\to M_{N_f}$.
So~$ f= (\varrho\otimes \scrB) \circ \eta_{\scrA,\scrB}
    = (\varrho'\otimes\scrB) \,\circ\, 
    (\pi_i\otimes \scrB) \,\circ\, \eta_{\scrA,\scrB}
    = (\varrho'\otimes\scrB) \circ e_i$,
    and hence $f$ is $(\,\cdot\,)\otimes\scrB$-equivalent
    to~$e_i$.\qed
\end{point}
\end{point}
\end{point}
\end{parsec}
\section{Duplicators and Monoids}
\label{S:duplicable}
\begin{parsec}{1260}%
\begin{point}{10}%
When asked for an
interpretation of the type $!A$
as a von Neumann algebra
\begin{equation}
\label{fock}
\sem{!A}
\ = \ 
\bigoplus_n \sem{A}^{\otimes n}
\end{equation}
definitely seems
like a suitable answer
given
the cue that~$!A$ should represent
as many instances of~$A$ as needed,
which makes the interpretation
we actually use in our model of the quantum lambda calculus
(namely $\sem{!A}=\ell^\infty(\nsp(\sem{A}))$)
rather
suspect.
To address such concerns
we'll show that any von Neumann algebra
that carries a $\otimes$-monoid structure
(in~$\W{miu}$ as~$\sem{!A}$ should)
must be nmiu-isomorphic
to $\ell^\infty(X)$ for some set~$X$
(see \sref{duplicable})
ruling out the interpretation~\eqref{fock}
for all but the most trivial cases.
We'll show in fact that~$\ell^\infty(\nsp(\scrA))$
is the free $\otimes$-monoid
over~$\scrA$
in~$\W{miu}$ (see \sref{thm:free-monoid-in-vNAMIU})
exonerating it in our minds from all doubts.
\end{point}
\end{parsec}
\subsection{Duplicators}
\begin{parsec}{1270}%
\begin{point}{10}[def:duplicator]{Definition}%
A von Neumann algebra~$\mathscr{A}$
is \Define{duplicable}%
	\index{duplicable von Neumann algebra}
if there is a \Define{duplicator} on~$\mathscr{A}$,%
	\index{duplicator}
that is,
an npsu-map
$\delta\colon \mathscr{A}\otimes \mathscr{A}\to\mathscr{A}$
with a \Define{unit} $u\in [0,1]_\scrA$ 
satisfying
\begin{equation*}
\delta(a\otimes u)\ =\ a\ = \ \delta(u\otimes a)
\quad\text{for all~$a\in\mathscr{A}$.}
\end{equation*}
(Note that we require of~$\delta$ neither associativity
nor commutativity.)
\end{point}
\begin{point}{20}{Remark}
The unit $u$ can be identified with
a positive subunital map $\tilde{u}\colon \C\to \scrA$ via $\tilde{u}(\lambda)=\lambda u$.
The definition is motivated by the fact that the interpretation of $\bang A$
must carry a commutative monoid structure in $\W{miu}$.
The condition is weaker, requiring the maps to be only positive subunital,
and dropping associativity and commutativity.
Nevertheless this is sufficient to prove the following.
\end{point}
\begin{point}{30}[duplicable]{Theorem}%
A von Neumann algebra~$\mathscr{A}$
is duplicable if and only if
$\mathscr{A}$ is nmiu-isomorphic to $\linf(X)$ for some set~$X$.
In that case, the duplicator $(\delta,u)$
is unique, given by
$\delta(a\otimes b) = a\cdot b$ and $u=1$.
\begin{point}{40}%
Thus, to interpret duplicable types,
we can really only use von Neumann algebras of the form $\linf(X)$.
It also follows that a von Neumann algebra
is duplicable precisely when it is a (commutative) monoid
in $\W{miu}$, or in the 
symmetric monoidal category $\W{cpsu}$ of von Neumann algebras
and normal completely positive subunital (CPsU) maps.
\end{point}
\begin{point}{50}[sec:characterisation-dup-vna]%
To prove~\sref{duplicable}
we proceed as follows.
First we prove 
in~\sref{lem:uniqueness-duplicator}
every duplicable von Neumann algebra~$\scrA$
is commutative (and that the duplicator is given by multiplication).
This reduces the problem
to a measure theoretic one,
because~$\mathscr{A} \cong \bigoplus_i L^\infty(X_i)$
for some finite complete measure spaces~$X_i$
(by~\sref{cvn}).
Since each of the~$L^\infty(X_i)$s will be duplicable
(see~\sref{cor:duplicable-product})
we may assume without loss of generality
that~$\scrA\cong L^\infty(X)$ for some finite complete measure space~$X$.
Since~$X$ splits into a discrete and a continuous
part (see~\sref{lem:measure-space-continuous-discrete}),
and the result is obviously true for discrete spaces,
we only need to show that~$L^\infty(C)=\{0\}$
for any continuous complete finite measure space~$C$
for which~$L^\infty(C)$ is duplicable.
In fact,
we'll show that~$\mu(C)=0$
for such~$C$
(see~\sref{lem:continuous-measure-space}).
\end{point}
\end{point}
\begin{point}{60}[lem:unit-duplicator]{Lemma}%
Let~$\delta$
be a duplicator 
with unit~$u$
on a von Neumann algebra~$\mathscr{A}$.
Then~$u=1$ and~$\delta(1\otimes 1)=1$.
\begin{point}{70}{Proof}%
Since~$1=\delta(u\otimes 1)\leq \delta(1\otimes 1) \leq 1$,
	we have $\delta(1\otimes 1)=1$, and so $\delta(u^\perp\otimes 1)=0$.
But,
because  $u^\perp = \delta(u^\perp \otimes u)
\leq \delta(u^\perp \otimes 1) = 0$,
we have~$u^\perp=0$, and thus~$u=1$.
Hence~$1=\delta(1\otimes u)=\delta(1\otimes 1)$.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}{1280}%
\begin{point}{10}%
To prove that a duplicable von Neumann 
algebra is commutative we'll need the following two classical theorems
from the theory of $C^*$-algebras.
\end{point}
\begin{point}{20}[tomiyama]{Theorem (Tomiyama)}%
\index{Tomiyama's Theorem}
Any linear surjection
 $f\colon \scrA\to\scrB$
of a von Neumann algebra~$\scrA$ onto a von Neumann subalgebra 
$\scrB\subseteq \scrA$
with~$f(f(a))=f(a)$ and~$\|f(a)\|\leq\|a\|$ 
for all~$a\in \scrA$
obeys~$bf(a)=f(ba)$
for all~$a\in\scrA$ and~$b\in\scrB$.
\begin{point}{21}{Remark}%
The usual (see e.g.~10.5.86 of~\cite{kr}) 
and original\cite{tomiyama} formulations of Tomiyama's theorem
involve $C^*$-algebras instead of von Neumann algebras,
and include the conclusion that~$f$ is positive.
Since these improvements
weren't necessary for our purposes,
we've left them out, shortening the proof.
\end{point}
\begin{point}{30}{Proof}%
(Based on II.6.10.2 of \cite{blackadar2006operator}.)

Let~$a\in\scrA$ and~$b\in\scrB$ be given.
Since $b$ is the
norm limit of linear combinations of projections
(cf.~\sref{projections-norm-dense}),
it suffices to show that $ef(a)=f(ea)$
for every projection~$e$ from~$\scrB$ and~$a\in \scrA$.
For this, in turn,
it suffices to show that $e^\perp f(ea)=0$
for every projection~$e$ from~$\scrB$,
(and thus also~$ef(e^\perp a)=0$,)
because then $f(ea)=ef(ea)=ef(a)$.

Let~$\lambda \in \R$ be given.
The trick is to obtain the following inequality.
\begin{equation}
\label{eq:tomiyama}
(1+2\lambda) \left\|e^\perp f(ea)\right\|^2 
\ \leq\  \left\|ea\right\|^2
\end{equation}
Indeed, this inequality can only hold for all~$\lambda$
when $\|e^\perp f(ea)\|=0$.
Working towards~\eqref{eq:tomiyama},
let us first note that $f(e^\perp f(ea))=e^\perp f(ea)$:
indeed, since  $e^\perp f(ea)\in \scrB$
and~$f\colon \scrA\to\scrB$ is surjective,
    there must be~$a'\in\scrA$ with~$f(a')=e^\perp f(ea)$,
    and thus  $e^\perp f(ea)=f(a')=f(f(a'))=f(e^\perp f(ea))$.
Then:
\begin{alignat*}{3}
    &(1+\lambda)^2 \left\|e^\perp f(ea)\right\|^2\\
    &= \ \left\|e^\perp f(\,ea + \lambda e^\perp f(ea)\,)\right\|^2
    \qquad && \text{since }f(e^\perp f(ea))=e^\perp f(ea) \\
    &\leq \ \left\|\,ea\,+\,\lambda e^\perp f(ea)\,\right\|^2\qquad
    &&\text{since }\|e^\perp\|\leq 1\text{ and }\|f\|\leq 1 \\
    &=\ \left\|ea\right\|^2\,+\,\lambda^2 \left\|e^\perp f(ea)\right\|^2
    \qquad&&\text{using $\|c\|^2=\|c^*c\|$ and $ee^\perp=0$}
\end{alignat*}
Subtracting $\lambda^2 \left\|e^\perp f(ea)\right\|^2$ from both
sides yields inequality~\eqref{eq:tomiyama}.\qed
\end{point}
\end{point}
\begin{point}{40}{[Moved to~\sref{russo-dye}]}%
    \begin{point}{50}{[Removed]}%
\end{point}
\end{point}
\begin{point}{60}[lem:sef-instrument]{Lemma}%
Let~$\mathscr{A}$ be a von Neumann algebra,
and let~$f\colon \mathscr{A}\oplus\mathscr{A}\to \mathscr{A}$
be a pu-map 
with $f(a,a)=a$ for all~$a\in \mathscr{A}$.
Then $p:=f(1,0)$ is central,
and
\begin{equation*}
	f(a,b) \,=\, ap\,+\, bp^\perp
\end{equation*}
for all~$a,b\in\mathscr{A}$.
\begin{point}{70}{Proof}%
(Based on Lemma~8.3 of~\cite{newdirections}.)

Note that $(c,d)\mapsto (\,f(c,d),\,f(c,d)\,)$
gives a pu-map~$f'$ from~$\scrA\oplus \scrA$
onto its von Neumann subalgebra~$\{\,(a,a)\colon\,a\in\scrA\,\}$
with~$f'(f'(c,d))=f'(c,d)$ for all~$c,d\in\scrA$.
Since~$\|f'\|\leq 1$ as a result of Russo--Dye's theorem 
(see~\sref{russo-dye-cor}),
Tomiyama's theorem (\sref{tomiyama}) 
implies that 
for all~$a,c,d\in\mathscr{A}$,
\begin{equation*}
	(a,a)\,f'(c,d)
	\ =\  f'(\,ac,\, ad\,),
	\quad\text{and so}\quad
a \,f(c,d) \ = \ f(\,ac\,,\,ad\,).
\end{equation*}
Upon taking the adjoint
we see that $f(c,d)b=f(cb,db)$
for all~$b,c,d\in\scrA$
(using here that~$f$ being positive is involution preserving,
see~\sref{cstar-p-implies-i}.)
As a result of these observations, we get
 $ap\equiv af(1,0)=f(a,0)=f(1,0)a\equiv pa$
 for all~$a\in\scrA$,
and so~$p$ is central.
Similarly, $f(0,b)=bp^\perp$
for all~$b\in\mathscr{A}$.
Then~$f(a,b)=f(a,0)+f(0,b)=ap+bp^\perp$
for all~$a,b\in\mathscr{A}$.\qed
\end{point}
\end{point}
\begin{point}{80}[lem:uniqueness-duplicator]{Lemma}%
Let $\delta\colon\mathscr{A}\otimes \mathscr{A}\to\mathscr{A}$
be a duplicator on a von Neumann algebra~$\mathscr{A}$.
Then~$\mathscr{A}$ is commutative and~$\delta(a\otimes b)=a\cdot b$
for all~$a,b\in\mathscr{A}$.%
	\index{duplicator!is multiplication}%
	\index{duplicable von Neumann algebra!is commutative}
\begin{point}{90}{Proof}%
To prove~$\scrA$ is commutative
we must show that all~$a\in\mathscr{A}$ are central,
but, of course,
it suffices
to show that all~$p\in [0,1]_\mathscr{A}$ are central
(by the usual reasoning).
Similarly, 
we only need to prove that $\delta(a\otimes p) = a\cdot p$
for all~$a\in\mathscr{A}$ and $p\in [0,1]_\mathscr{A}$.
Given such~$p\in[0,1]_\mathscr{A}$ 
define~$f\colon \mathscr{A}\oplus\mathscr{A}\to\mathscr{A}$
by $f(a,b) = \delta(a\otimes p+b\otimes p^\perp)$
for all~$a,b\in\mathscr{A}$.
Then~$f$ is positive, unital,
$f(1,0)=p$,
and 
$f(a,a)=a$
for all~$a\in \mathscr{A}$.
Thus by~\sref{lem:sef-instrument},
$p$ is central,
and  $f(a,b)=ap+bp^\perp$ for all~$a,b\in\mathscr{A}$.
Then~$a\cdot p=f(a,0)=\delta(a \otimes p)$.\qed
\end{point}
\end{point}
\begin{point}{100}{Remark}%
The special
case of~\sref{lem:uniqueness-duplicator}
in which~$\delta$ is \emph{completely} positive
can be found
in the literature,
see for example
Theorem~6 of~\cite{Maassen2010}
(where duplication is called copying,)
and \S3.3 of~\cite{clifton2003characterizing} 
    (where it's called broadcasting.)
\end{point}
\begin{point}{101}{Remark}
Note that we've not yet used that a duplicator is normal.
That a duplicator is normal will come in to play momentarily
when we show that~$L^\infty(X)$
is duplicable iff~$X$ is discrete.
\end{point}
\begin{point}{110}[cor:duplicability-multiplication]{Corollary}
Let~$\mathscr{A}$
be a von Neumann algebra.
Then~$\mathscr{A}$
is duplicable
iff there is
an np-map $\delta\colon\mathscr{A}\otimes\mathscr{A}
\to \mathscr{A}$
with $\delta(a\otimes b)=a\cdot b$ 
for all~$a,b\in\mathscr{A}$,
(and in that case~$\scrA$ is commutative.)
\begin{point}{120}{Remark}%
Thus
for a non-commutative von Neumann algebra~$\scrA$ 
multiplication $(a,b)\mapsto ab\colon \scrA\times \scrA\to\scrA$
is not a normal bilinear map
in the sense of~\sref{tensor-extra}.
\end{point}
\end{point}
\begin{point}{130}[cor:duplicable-product]{Corollary}%
When the direct sum~$\scrA\oplus\scrB$
of von Neumann algebras~$\scrA$ and~$\scrB$
is duplicable,
$\scrA$ and~$\scrB$ are duplicable
\begin{point}{140}{Proof}%
Let $\delta\colon (\mathscr{A}\oplus\mathscr{B})\otimes
(\mathscr{A}\oplus\mathscr{B})\longrightarrow
\mathscr{A}\oplus\mathscr{B}$
be a duplicator on~$\mathscr{A}\oplus\mathscr{B}$.
By~\sref{lem:uniqueness-duplicator}
$\mathscr{A}\oplus\mathscr{B}$
is commutative
and $\delta((a_1,b_1)\otimes (a_2,b_2))
= (a_1a_2,b_1b_2)$
for all $a_1,a_2\in\mathscr{A}$
and~$b_1,b_2\in\mathscr{B}$.
Let~$\kappa_1\colon \mathscr{A}\to\mathscr{A}\oplus\mathscr{B}$
be the nmiu-map
given by~$\kappa_1(a)=(a,0)$ for all~$a\in\mathscr{A}$.
Let~$\delta_\mathscr{A}$ be the composition of
$\xymatrix@C=3em{
\mathscr{A}\otimes\mathscr{A}
\ar[r]|-{\kappa_1\otimes\kappa_1}
&
(\mathscr{A}\oplus\mathscr{B})
\otimes
(\mathscr{A}\oplus\mathscr{B})
\ar[r]|-{\delta}
&
\mathscr{A}\oplus\mathscr{B}
\ar[r]|-{\pi_1}
&
\mathscr{A}
}$.
Then~$\delta_\mathscr{A}$ is normal, positive,
and
$\delta_\mathscr{A}(a_1\otimes a_2)
\,=\,  \pi_1(\delta((a_1,0)\otimes (a_2,0))) 
\,=\, \pi_1(a_1a_2,0)\,=\,a_1a_2$
for all~$a_1,a_2\in\mathscr{A}$.
Thus, by~\sref{cor:duplicability-multiplication},
$\mathscr{A}$
is duplicable.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}{1290}%
\begin{point}{10}%
We will now work towards
the proof that
if~$C$ is a continuous complete finite measure space,
then
$L^\infty(C)$
cannot be duplicable 
unless~$\mu(C)=0$,
see~\sref{lem:continuous-finite-measure-space-not-duplicable}.
Let us first fix some more terminology
from measure theory (see~\sref{measure-theory-recap} and~\cite{fremlin}).
\end{point}
\begin{point}{20}{Definition}
\label{def:measure-space}
Let~$X$ be a finite complete measure space.
\begin{enumerate}
\item
A measurable subset~$A$ of~$X$
is \Define{atomic}
\index{atomic subset of a measure space}
if $0<\mu(A)$
and $\mu(A')=\mu(A)$ for all~$A'\in\Sigma_X$
with~$A'\subseteq A$ and~$\mu(A')>0$.

\item
$X$ is \Define{discrete} if $X$ is covered by atomic measurable subsets.%
\index{measure space!discrete}

(This coincides with being ``purely atomic''
from 211K of~\cite{fremlin}.)
\item
$X$ is \Define{continuous}%
\index{measure space!continuous}
(or ``atomless'')
if~$X$ contains no atomic subsets.
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{30}%
The following lemma,
which will be very useful,
is a variation on
Zorn's Lemma
(that does not require the axiom of choice).
\end{point}
\begin{point}{40}[lem:measure-zorn]{Lemma}
Let~$\mathcal{S}$
be a collection of measurable subsets of
a finite complete measure space~$X$ 
such that 
for 
every ascending countable sequence
$A_1\subseteq A_2 \subseteq \dotsb$
in~$\mathcal{S}$
there is~$A\in\mathcal{S}$
with $A_1\subseteq A_2\subseteq\dotsb \subseteq A$.

Then each element~$A\in\mathcal{S}$
is contained in some~$B\in\mathcal{S}$
that is maximal in~$\mathcal{S}$ in the sense
that $\mu(B')=\mu(B)$
for all~$B'\in\mathcal{S}$ with $B\subseteq B'$.
\begin{point}{50}{Proof}
	The trick is to consider for every $C\in\mathcal{S}$
the quantity
\begin{equation*}
	\beta_C \ = \ \sup\{\,\mu(D)\colon\, C\subseteq D
\text{ and }D\in \mathcal{S}\,\}.
\end{equation*}
Note that $\mu(C)\leq \beta_C \leq \mu(X)$
	for all~$C\in\mathcal{S}$,
	and $\beta_{C_2}\leq \beta_{C_1}$
	for all~$C_1,C_2\in\mathcal{S}$ with $C_1 \subseteq C_2$.
	To prove this lemma, it suffices to find~$B\in\mathcal{S}$
with $A\subseteq B$ and~$\mu(B)=\beta_B$.

Define~$B_1:= A$.
Pick~$B_2\in\mathcal{S}$
such that $B_1 \subseteq B_2$
and~$\beta_{B_1}-\mu(B_2)\leq \nicefrac{1}{2}$.
Pick~$B_3\in\mathcal{S}$
such that $B_2\subseteq B_3$
and~$\beta_{B_2}-\mu(B_3) \leq \nicefrac{1}{3}$.
Proceeding in this fashion,
we get a sequence $B\equiv B_1\subseteq B_2 \subseteq \dotsb$
in~$\mathcal{S}$
with $\beta_{B_{n}}-\mu(B_{n+1})\leq \nicefrac{1}{n}$
for all~$n$.
By assumption there is a~$B\in\mathcal{S}$
with $B_1\subseteq B_2\subseteq \dotsb \subseteq B$.
Note that
\begin{equation*}
\mu(B_1)\,\leq\, \mu(B_2)\,\leq\,
\dotsb \,\leq\,\mu(B)\,\leq\, \beta_B \,\leq\, \dotsb
\,\leq\, \beta_{B_2}\,\leq\, \beta_{B_1}.
\end{equation*}
Since for every~$n\in\mathbb{N}$
we have both $\mu(B_{n+1})\leq \mu(B)\leq \beta_B \leq \beta_{B_n}$
and $\beta_{B_n}- \mu(B_{n+1}) \leq \nicefrac{1}{n}$,
we get $\beta_B-\mu(B)\leq \nicefrac{1}{n}$,
and so~$\beta_B = \mu(B)$.\qed
\end{point}%
\end{point}%
\begin{point}{60}[lem:measure-space-continuous-discrete]{Lemma}%
Each finite complete  measure space~$X$ 
contains a  discrete measurable  subset~$D$
such that~$X\backslash D$ is continuous.
\begin{point}{70}{Proof}%
Since clearly the countable union
of discrete measurable subsets of~$X$
is again discrete,
there is by~\sref{lem:measure-zorn}
a discrete measurable subset~$D$ of~$X$
which is maximal in the sense that~$\mu(D')=\mu(D)$
for every discrete measurable subset~$D'$ of~$X$ with $D\subseteq D'$.
To show that~$X\backslash D$ is continuous,
we must prove that~$X\backslash D$
contains no atomic measurable subsets.
If~$A\subseteq X\backslash D$ is an atomic measurable subset
of~$X$,
then~$D\cup A$
is a discrete measurable
subset of~$X$
which contains~$D$,
and $\mu(D\cup A)=\mu(D)\cup \mu(A) > \mu(D)$.
This contradicts the  maximality of~$D$.
Thus~$X\backslash D$ is continuous.\qed
\end{point}
\end{point}
\begin{point}{80}[lem:continuous-measure-space]{Lemma}%
Given a continuous finite complete measure space~$X$,
and~$r\in [0,\mu(X)]$,
there is a measurable subset~$A$ of~$X$ with $\mu(A)=r$.
\begin{point}{90}{Proof}%
Let us quickly get rid of the case that~$\mu(X)=0$.
Indeed, then~$r=0$, and so~$A=\varnothing$ will do.
For the remainder, assume that~$\mu(X)>0$.

For starters, we show that for every~$\varepsilon >0$
and~$B\in\Sigma_X$ with~$\mu(B)>0$
there is~$A\in\Sigma_X$ with $A\subseteq B$
and  $0<\mu(A)<\varepsilon$.
Define~$A_1 := B$.
Since~$\mu(B)>0$,
and~$A_1$ is not atomic (because~$X$ is continuous)
there is~$A\in\Sigma_X$ with $A\subseteq A_1$ 
and $\mu(A)\neq \mu(A_1)$.
Since~$\mu(A)+\mu(A_1\backslash A)=\mu(A_1)$,
either $0<\mu(A)\leq \frac{1}{2}\mu(A_1)$
or $0<\mu(X\backslash A)\leq \frac{1}{2}\mu(A_1)$.
In any case,
there is~$A_2\subseteq A_1$
with $A_2\in\Sigma_X$
and $0<\mu(A_2)\leq \frac{1}{2}\mu(A_1)$.
Similarly,
since~$A_2$ is not atomic (because~$X$ is continuous),
there is~$A_3\subseteq A_2$
with~$A_3\in\Sigma_X$ and $0<\mu(A_3)\leq \frac{1}{2}\mu(A_2)$.
Proceeding in a similar fashion,
we obtain a sequence $B\equiv A_1 \supseteq A_2\supseteq \dotsb$
of measurable subsets of~$X$
with $0<\mu(A_n)\leq 2^{-n}\mu(X)$.
Then, for every $\varepsilon >0$
there is~$n\in\mathbb{N}$
such that $0<\mu(A_n)\leq \varepsilon$ and~$A_n\subseteq B$.

Now, 
let us prove that there is~$A\in\Sigma_X$ with $\mu(A)=r$.
By~\sref{lem:measure-zorn}
there is a measurable
subset~$A$ of~$X$
with $\mu(A)\leq r$
and which is maximal
in the sense that $\mu(A')=\mu(A)$
for all~$A'\in\Sigma_X$
with $\mu(A)\leq r$ and~$A\subseteq A'$.
In fact, we claim that~$\mu(A)=r$.
Indeed, suppose that~$\varepsilon := r-\mu(A)>0$
towards a contradiction.
By the previous discussion,
there is~$C\in\Sigma_X$ with $C\subseteq X\backslash A$
such that $\mu(C)\leq \varepsilon$.
Then~$A\cup C$ is measurable,
and $\mu(A\cup C)=\mu(A)+\mu(C)\leq \mu(A)+\varepsilon\leq r$,
which contradicts the maximality of~$A$.\qed
\end{point}
\end{point}
\begin{point}{100}[lem:continuous-finite-measure-space-not-duplicable]{Lemma}%
Let~$X$ be a continuous finite complete measure space
for which~$L^\infty(X)$ is duplicable.
Then~$\mu(X)=0$.
\begin{point}{110}{Proof}%
Suppose that~$\mu(X)>0$
towards a contradiction.
Let~$\delta$
be a duplicator
on~$L^\infty(X)$.
By~\sref{lem:uniqueness-duplicator}
$\delta(\mathfrak{f}\otimes \mathfrak{g})=
\mathfrak{f}\cdot \mathfrak{g}$ for 
all~$\mathfrak{f},\mathfrak{g}\in L^\infty(X)$.

Let~$\omega\colon L^\infty(X)\to \mathbb{C}$
be given by~$\omega(f^\circ)=\frac{1}{\mu(X)}\int f \,d\mu$
for all~$f\in \mathcal{L}^\infty(X)$.
Then~$\omega$ is normal, positive, unital and faithful
(cf.~\sref{Linfty-vn}).
We'll use
the product
functional 
$\omega\otimes \omega\colon L^\infty(X)\otimes L^\infty(X)\to \mathbb{C}$,
(which is also faithful,
by~\sref{carrier-tensor})
to tease out a contradiction,
but first we  need a second ingredient.

Since~$X$ is continuous,
we may partition~$X$ into two measurable
subsets of equal measure 
with the aid of~\sref{lem:continuous-measure-space},
that is,
there are measurable subsets $X_{1}$ and~$X_{2}$
of~$X$ with $X=X_{1}\cup X_{2}$, $X_{1}\cap X_{2}=\varnothing$,
and
$\mu(X_{1})=\mu(X_{2})=\frac{1}{2}\mu(X)$.
Similarly, $X_{1}$ 
can be split into two measurable subsets, $X_{11}$ and $X_{12}$,
of equal measure, and so on.
In this way,
we obtain for every word~$w$ over the alphabet~$\{1,2\}$
--- in symbols, $w\in \{1,2\}^*$ ---
a measurable subset~$X_w$ of~$X$
such that $X_w = X_{w1}\cup X_{w2}$,
$X_{w1}\cap X_{w2}=\varnothing$,
and $\mu(X_{w1})=\mu(X_{w2})=\frac{1}{2}\mu(X_w)$.
It follows that~$\mu(X_w)=\frac{1}{2^{\#w}}\mu(X)$,
where~$\#w$ is the length of the word~$w$.

Now, $p_w := \mathbf{1}_{X_w}^\circ$ is a projection in~$L^\infty(X)$,
and~$\omega(p_w)=2^{-\#w}$
for every~$w\in\{1,2\}^*$.
Moreover, $p_w = p_{w1}+p_{w2}$,
and so
\begin{alignat*}{3}
p_w\otimes p_w 
\ &=\  
p_{w1}\otimes p_{w1} \,+\,
p_{w1}\otimes p_{w2} \,+\,
p_{w2}\otimes p_{w1} \,+\,
p_{w2}\otimes p_{w2}\\
\ &\geq\ 
p_{w1}\otimes p_{w1} \,+\,
p_{w2}\otimes p_{w2}.
\end{alignat*}
Thus, if we define 
$q_N\ :=\ \sum_{w\in \{1,2\}^N}\,p_w\otimes p_w$
for every natural number~$N$,
where~$\{1,2\}^N$ is the set of words over~$\{1,2\}$ of length~$N$,
then we get a descending sequence $q_1\geq q_2\geq q_3\geq \dotsb$
of projections in~$L^\infty(X)\otimes L^\infty(X)$.
Let~$q$ be the infimum of $q_1\geq q_2 \geq \dotsb$ 
in the set of self-adjoint elements of~$L^\infty(X)\otimes
L^\infty(X)$.
Do we have~$q=0$ ?

On the one hand,
we claim that $\delta(q)=1$, and so~$q\neq 0$.
Indeed,
$\delta(p_w\otimes p_w)=p_w\cdot p_w = p_w$
for all~$w\in \{1,2\}^N$.
Thus $\delta(q_N) = \sum_{w\in \{1,2\}^N}  \delta(p_w\otimes p_w)
= \sum_{w\in\{1,2\}^N} p_w=1$ for all~$N\in \mathbb{N}$.
Hence $\delta(q)=\bigwedge_n \delta(q_N) = 1$,
because~$\delta$ is normal.
On the other hand,
we claim that $(\omega\otimes \omega)(q)=0$,
and so~$q=0$ since~$\omega\otimes \omega$ is 
faithful and $q\geq 0$.
Indeed,
$(\omega\otimes\omega)(q_N)=
\sum_{w\in\{1,2\}^N} \omega(p_w)\cdot\omega(p_w)
= \sum_{w\in\{1,2\}^N} 2^{-N}\cdot 2^{-N} = 2^{-N}$
for all~$N\in \mathbb{N}$,
	and so $(\omega\otimes\omega)(q)
=\bigwedge_N (\omega\otimes\omega)(q_N) = \bigwedge_N 2^{-N}=0$.
Thus, $q=0$ and $q\neq 0$, which is impossible.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}{1300}%
\begin{point}{10}%
This takes care of the continuous case.
To deal with the discrete case we first need some
simple observations.
\end{point}
\begin{point}{20}[lem:atomic-measure-space]{Lemma}%
Let~$A$ be an atomic measure space.
Then~$L^\infty(A)\cong \mathbb{C}$.
\begin{point}{30}{Proof}
Let~$f\in \mathcal{L}^\infty(A)$ be given.
It suffices to show that
there is~$z\in \mathbb{C}$
such that
$f(x)=z$ for almost all~$x\in A$.
Moreover, we only need to consider the case
that~$f$ takes its values in~$\mathbb{R}$
(because we may split~$f$ in its real and imaginary parts,
and in turn split these in positive and negative parts).

Let~$S$ be some measurable subset of~$A$.
Note that either~$\mu(S)=0$ or~$\mu(A\backslash S)=0$.
Indeed, if not~$\mu(S)=0$,
then~$\mu(S)>0$,
and so~$\mu(S)=\mu(A)$
(by atomicity of~$A$),
which entails that~$\mu(A\backslash S)=0$.

In particular,
for every real number~$t\in\R$
one of the sets
\begin{equation*}
\{\,x\in A\colon\, t\leq f(x) \,\}
\qquad
\{\,x\in A\colon\, f(x)<t \,\}
\end{equation*}
must be negligible.  Whence
either~$t\leq f^\circ$ or~$f^\circ\leq t$.
It follows that
the two closed sets $L:=\{t\in\R\colon t\leq f^\circ\}$
and $U:=\{t\in \R\colon f^\circ\leq t\}$
cover~$\R$.
Since clearly~$-\|f\| \in L$
and~$\|f\|\in  U$,
the sets~$L$ and~$U$
can't be disjoint,
because they would partition~$\R$ into two clopen non-empty sets.
For an element~$t\in L\cap U$
in the intersection
we have~$ t\leq f^\circ \leq t$,
	and so~$t=f^\circ$. Hence~$L^\infty(X)\cong \C$. \qed
\end{point}
\end{point}
\begin{point}{40}[lem:measure-space-partition]{Exercise}%
Let~$X$ be a measure space with~$\mu(X)<\infty$.
Show that~$L^\infty(X)\cong \bigoplus_{A\in\mathcal{A}} L^\infty(A)$
for every countable partition~$\mathcal{A}$
of~$X$
consisting of measurable subsets.
\end{point}
\begin{point}{50}[cor:discrete-ell-x]{Corollary}%
For every discrete 
measure space~$X$ with~$\mu(X)<\infty$
there is a  set~$Y$ with $L^\infty(X)\cong \linf(Y)$.
\end{point}
\end{parsec}
\begin{parsec}{1310}%
\begin{point}{10}%
We are now ready to prove
the main result of this section.
\end{point}
\begin{point}{20}[duplicable-proof]{Proof of~\ref{duplicable}}%
We have already seen that $\linf(X)$
can be  equipped with a commutative monoid
structure in~$\W{miu}$
for any set~$X$,
and is thus duplicable.
Conversely,
let~$\delta\colon \mathscr{A}\otimes\mathscr{A}\to\mathscr{A}$
be a duplicator with unit~$u$ on a von Neumann algebra~$\mathscr{A}$.
By~\sref{lem:unit-duplicator}, we know that~$u=1$,
and by~\sref{lem:uniqueness-duplicator},
we know that~$\mathscr{A}$
is commutative 
and~$\delta(a\otimes b)=a\cdot b$
for all~$a,b\in \mathscr{A}$.
Thus, the only thing that remains to be shown
is that~$\mathscr{A}$ is miu-isomorphic to $\linf(Y)$
for some set~$Y$.
By~\sref{cvn}
$\scrA\cong \bigoplus_i L^\infty(X_i)$
for some finite complete measure spaces~$X_i$.
So to prove that~$\mathscr{A}\cong \ell^\infty(Y)$
for some set~$Y$ it 
suffices
to find
 a set~$Y_i$
with $L^\infty(X_i)\cong \ell^\infty(Y_i)$
for each~$i$,
because then 
$\textstyle \mathscr{A}\ \cong \ 
\bigoplus_{i\in I} \ell^\infty(Y_i)\ \cong\ 
\ell^\infty\bigl(\,\bigcup_{i\in I} Y_i\,\bigr)$.

Let~$i\in I$ be given.
Since~$\mathscr{A}\cong L^\infty(X_i)\,\oplus\,\bigoplus_{j\neq i} 
L^\infty(X_j)$ is duplicable,
$L^\infty(X_i)$ is duplicable
by~\sref{cor:duplicable-product}.
By~\sref{lem:measure-space-continuous-discrete}
there is a measurable subset~$D$ of~$X_i$ such that~$D$
is discrete, and $C:=X\backslash D$ is continuous.
We have~$L^\infty(X_i)\cong L^\infty(D)\oplus L^\infty(C)$
by~\sref{lem:measure-space-partition},
and
so $L^\infty(D)$ and~$L^\infty(C)$
are duplicable
(again by~\sref{cor:duplicable-product}).
By~\sref{lem:continuous-finite-measure-space-not-duplicable},
$L^\infty(C)$
can only be duplicable if~$\mu(C)=0$,
and so~$L^\infty(C)\cong \{0\}$.
On the other hand,
since~$D$ is discrete,
we have~$L^\infty(D)\cong \ell^\infty(Y)$
for some set~$Y$
(by~\sref{cor:discrete-ell-x}).
All in all, we have $L^\infty(X_i)\cong \ell^\infty(Y)$.\qed
\end{point}
\end{parsec}
\subsection{Monoids}
\label{sec:monoids-in-vna}
\begin{parsec}{1320}%
\begin{point}{10}%
We further justify our choice,
$\sem{!A} = \linf(\nsp(\sem{A}))$,
by proving that $\linf(\nsp(\mathscr{A}))$
is the free (commutative) monoid on~$\mathscr{A}$ in~$\W{miu}$.
As a corollary, we also obtain that $\linf(\W{cpsu}(\mathscr{A},\mathbb{C}))$
is the free (commutative) monoid on~$\mathscr{A}$
in~$\W{cpsu}$.
\end{point}
\begin{point}{20}%
Let us first recall some terminology.
Given a symmetric monoidal
	category (\Define{SMC})%
\index{symmetric monoidal category (SMC)}
$\Cat{C}$, 
	a \Define{monoid} \index{monoid!in an SMC}
	in $\Cat{C}$ is an object $A$ from~$\Cat{C}$ endowed
with
a \Define{multiplication} map
$m\colon A\otimes A\to A$
and a \Define{unit} map $u\colon I\to A$
satisfying the associativity and the unit law,
i.e.~making the following diagrams commute.
\[
\xymatrix@R-.5pc{
(A\otimes A)\otimes A
\ar[d]_{\alpha}
\ar[rr]^-{m\otimes \id}
&&
A\otimes A
\ar[d]^{m}
\\
A\otimes (A\otimes A)
\ar[r]_-{\id\otimes m}
&
A\otimes A
\ar[r]_-{m}
&
A
}
\qquad
\xymatrix@R-.5pc{
I\otimes A
\ar[dr]_{\lambda}
\ar[r]^-{u\otimes \id}
&
A\otimes A
\ar[d]^{m}
&
\ar[l]_-{\id\otimes u}
A\otimes I
\ar[dl]^{\rho}
\\
&
A
&
}
\]
Here $\alpha,\lambda,\rho$ respectively
denote the associativity isomorphism, and
the left and the right unit isomorphism.
A monoid $A$ is \Define{commutative} if
$m\circ \gamma=m$,
where $\gamma\colon A\otimes A\to A\otimes A$ is the symmetry isomorphism.
A \Define{monoid morphism} between monoids $A_1$
and $A_2$ is an arrow $f\colon A_1\to A_2$
that satisfies $m_{A_2}\circ (f\otimes f)=f \circ m_{A_1}$
and $u_{A_2}=f \circ u_{A_1}$.
We denote the category of monoids
and monoid morphisms in $\Cat{C}$
by $\Define{\Mon(\Cat{C})}$.
The full subcategory of commutative
monoids is denoted by~$\Define{\CMon(\Cat{C})}$.
Recall that~$\W{miu}$ and~$\W{cpsu}$
are symmetric monoidal categories
with~$\C$ as tensor unit (see~\sref{vn-smc}),
and so we may speak about monoids
in~$\W{miu}$ and~$\W{cpsu}$.
\end{point}
\begin{point}{30}[prop:dup-vna-is-monoid]{Exercise}%
Let~$\scrA$ be a von Neumann algebra.
\begin{enumerate}
\item
Show that any monoid structure on~$\scrA$
in~$\W{cpsu}$
is a duplicator on~$\scrA$.
\item
Deduce
from this and~\sref{duplicable}
that there is a monoid structure
on~$\scrA$ in~$\W{miu}$ or in~$\W{cpsu}$
iff~$\scrA$ is duplicable
iff~$\scrA\cong \ell^\infty(X)$ for some set~$X$;
and that,
in that case
the multiplication $m\colon \scrA\otimes\scrA\to\scrA$
of the monoid
is commutative
and uniquely being fixed by~$m(a\otimes b)=a\cdot b$.
\item
Show that the monoid morphisms
in~$\W{miu}$ and in~$\W{cpsu}$
are precisely
the nmiu-maps.
\item
Conclude that
$\CMon(\W{miu})
=\Mon(\W{miu})
=\CMon(\W{cpsu})
=\Mon(\W{cpsu})$.
\item
Show  that $\Mon(\W{miu})\cong\dW{miu}\simeq\op{\Cat{Set}}$,
where $\Define{\dW{miu}}$ denotes the full subcategory
of~$\W{miu}$
consisting of duplicable von Neumann algebras.

(Hint: $\linf\colon \Cat{Set}\to \op{(\W{miu})}$ is full and faithful
by~\sref{cor:linf-ff}.)
\end{enumerate}
\spacingfix%
\end{point}%
\begin{point}{40}[thm:free-monoid-in-vNAMIU]{Theorem}%
\index{free monoid!in~$\W{miu}$}
Let~$\mathscr{A}$
be a von Neumann algebra,
and let~$\eta\colon \mathscr{A}\to\linf(\nsp(\mathscr{A}))$
be the nmiu-map
given by~$\eta(a)(\varphi)= \varphi(a)$.
Then $\linf(\nsp(\mathscr{A}))$
is the free (commutative) monoid
on~$\mathscr{A}$
in~$\W{miu}$ via~$\eta$.
\begin{point}{50}{Proof}%
Let~$\mathscr{B}$
be a monoid 
on~$\W{miu}$,
and let~$f\colon \mathscr{A}\to\mathscr{B}$
be an nmiu-map.
We must show that
there is a unique
monoid morphism
$g\colon \linf(\nsp(\mathscr{A}))
\rightarrow \mathscr{B}$
such that~$g\circ \eta = f$.
Since the monoid structure on~$\scrB$
is a duplicator on~$\scrB$
we may assume,
by~\sref{duplicable},
that~$\mathscr{B}=\linf(Y)$
for some set~$Y$.
Since~$\nsp\colon \op{(\W{miu})}\to \Cat{Set}$
is left adjoint
to~$\linf\colon \Cat{Set} \to \op{(\W{miu})}$
with unit~$\eta$ (see~\sref{first-adjunction}),
there is a unique map $h\colon Y\to \nsp(\mathscr{A})$
with $\linf(h)\circ \eta = f$.
Since~$\linf$ is full and faithful
by~\sref{cor:linf-ff},
the only thing that remains to be shown is that~$\linf(h)$
is a monoid morphism.
Indeed it is,
since the monoid multiplication
on~$\linf(\nsp(\mathscr{A}))$
and~$\linf(Y)$
is given by ordinary multiplication,
which is preserved by~$\linf(h)$ being an miu-map.\qed
\end{point}
\end{point}
\begin{point}{60}{Corollary}
Let~$\mathscr{A}$
be a von Neumann algebra.
Then $\linf(\W{cpsu}(\mathscr{A},\C))$
is the free (commutative) monoid
on~$\mathscr{A}$ in~$\W{cpsu}$.%
\index{free monoid!in~$\W{cpsu}$}
\begin{point}{70}{Proof}
By~\sref{thm:free-monoid-in-vNAMIU}
$\linf\circ\nsp$ is a left adjoint to
the forgetful functor $\Mon(\W{miu})\to\W{miu}$.
Note that
by~\sref{prop:dup-vna-is-monoid},
the forgetful functor $\Mon(\W{cpsu})\to\W{cpsu}$
factors through $\W{miu}$ as:
\[
\xymatrix{
\Mon(\W{cpsu})
\ar@{=}[r]
&
\Mon(\W{miu})
\ar[r]^-{\bot}&
\ar@/_3ex/[l]_{\linf\circ\nsp}
\W{miu}
\ar@{->}[r]^-{\bot}&
\ar@/_3ex/[l]_{\mathcal{F}}
\W{cpsu}
}
\]
where~$\mathcal{F}$ is from~\sref{second-adjunction}.
Thus the free monoid on $\scrA$ in $\W{cpsu}$ is given by:
\[
(\linf\circ\nsp\circ\mathcal{F})(\scrA)
\ =\ 
\linf(\W{miu}(\mathcal{F}\scrA,\C))
\ \cong\ 
\linf(\W{cpsu}(\scrA,\C))
\]
as was claimed.\qed
\end{point}
\end{point}
\end{parsec}
% vim: ft=tex.latex
